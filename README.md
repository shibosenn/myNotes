
# ğŸ“‘ ç›®å½•

* [â• C/C++](#cc)
* [ğŸ’» æ“ä½œç³»ç»Ÿ](#os)
* [â˜ï¸ è®¡ç®—æœºç½‘ç»œ](#computer-network)
* [ğŸ’¾ æ•°æ®åº“](#database)
* [ğŸ”§ å®ç”¨å·¥å…·](#usefultools)
* [ã€½ï¸ æ•°æ®ç»“æ„](#data-structure)
* [â“ ç®—æ³•](#algorithm)
* [ğŸ“ è®¾è®¡æ¨¡å¼](#design-pattern)
* [âš™ï¸ é“¾æ¥è£…è½½åº“](#link-loading-library)
* [ğŸ“š ä¹¦ç±](#books)
* [ğŸ”± C/C++ é¡¹ç›®](#cc-project)
* [ğŸ“ é¢è¯•é¢˜ç›®ç»éªŒ](#interview-questions-experience)
* [ğŸ“† æ‹›è˜æ—¶é—´å²—ä½](#recruitment-time-post)
* [ğŸ‘ å†…æ¨](#recommend)

<a id="cc"></a>

# â• C/C++

## `const`

### ä½œç”¨

1. ä¿®é¥°å˜é‡ï¼Œè¯´æ˜è¯¥å˜é‡`ä¸å¯æ”¹å˜`ï¼›
2. ä¿®é¥°æŒ‡é’ˆï¼Œåˆ†ä¸ºæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼ˆpointer to constï¼‰å’Œè‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ˆå¸¸é‡æŒ‡é’ˆï¼Œconst pointerï¼‰ï¼›
3. ä¿®é¥°å¼•ç”¨ï¼ŒæŒ‡å‘å¸¸é‡çš„å¼•ç”¨ï¼ˆreference to constï¼‰ï¼Œç”¨äºå½¢å‚ç±»å‹ï¼Œå³é¿å…äº†æ‹·è´ï¼Œåˆé¿å…äº†å‡½æ•°å¯¹å€¼çš„ä¿®æ”¹ï¼›
4. ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œè¯´æ˜è¯¥æˆå‘˜å‡½æ•°å†…ä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡ã€‚

#### const çš„æŒ‡é’ˆä¸å¼•ç”¨

* æŒ‡é’ˆ
  * æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼ˆpointer to constï¼‰ `const*`
  * è‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ˆå¸¸é‡æŒ‡é’ˆï¼Œconst pointerï¼‰`*const`
* å¼•ç”¨
  * æŒ‡å‘å¸¸é‡çš„å¼•ç”¨ï¼ˆreference to constï¼‰
  * æ²¡æœ‰ const referenceï¼Œå› ä¸ºå¼•ç”¨åªæ˜¯å¯¹è±¡çš„åˆ«åï¼Œå¼•ç”¨ä¸æ˜¯å¯¹è±¡ï¼Œä¸èƒ½ç”¨ const ä¿®é¥°

```cpp
// ç±»
class A
{
private:
    const int a;                // å¸¸å¯¹è±¡æˆå‘˜ï¼Œå¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨æˆ–è€…ç±»å†…åˆå§‹åŒ–

public:
    // æ„é€ å‡½æ•°
    A() : a(0) { };
    A(int x) : a(x) { };        // åˆå§‹åŒ–åˆ—è¡¨

    // constå¯ç”¨äºå¯¹é‡è½½å‡½æ•°çš„åŒºåˆ†
    int getValue();             // æ™®é€šæˆå‘˜å‡½æ•°
    int getValue() const;       // å¸¸æˆå‘˜å‡½æ•°ï¼Œä¸å¾—ä¿®æ”¹ç±»ä¸­çš„ä»»ä½•æ•°æ®æˆå‘˜çš„å€¼
};

void function()
{
    // å¯¹è±¡
    A b;                        // æ™®é€šå¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨å…¨éƒ¨æˆå‘˜å‡½æ•°
    const A a;                  // å¸¸å¯¹è±¡ï¼Œåªèƒ½è°ƒç”¨å¸¸æˆå‘˜å‡½æ•°
    const A *p = &a;            // æŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘å¸¸å¯¹è±¡
    const A &q = a;             // æŒ‡å‘å¸¸å¯¹è±¡çš„å¼•ç”¨

    // æŒ‡é’ˆ
    char greeting[] = "Hello";
    char* p1 = greeting;                // æŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘å­—ç¬¦æ•°ç»„å˜é‡
    const char* p2 = greeting;          // æŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘å­—ç¬¦æ•°ç»„å¸¸é‡ï¼ˆconst åé¢æ˜¯ charï¼Œè¯´æ˜æŒ‡å‘çš„å­—ç¬¦ï¼ˆcharï¼‰ä¸å¯æ”¹å˜ï¼‰
    char* const p3 = greeting;          // è‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ŒæŒ‡å‘å­—ç¬¦æ•°ç»„å˜é‡ï¼ˆconst åé¢æ˜¯ p3ï¼Œè¯´æ˜ p3 æŒ‡é’ˆè‡ªèº«ä¸å¯æ”¹å˜ï¼‰
    const char* const p4 = greeting;    // è‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ŒæŒ‡å‘å­—ç¬¦æ•°ç»„å¸¸é‡
}

// å‡½æ•°
void function1(const int Var);           // ä¼ é€’è¿‡æ¥çš„å‚æ•°åœ¨å‡½æ•°å†…ä¸å¯å˜
void function2(const char* Var);         // å‚æ•°æŒ‡é’ˆæ‰€æŒ‡å†…å®¹ä¸ºå¸¸é‡
void function3(char* const Var);         // å‚æ•°æŒ‡é’ˆä¸ºå¸¸é‡
void function4(const int& Var);          // å¼•ç”¨å‚æ•°åœ¨å‡½æ•°å†…ä¸ºå¸¸é‡

// å‡½æ•°è¿”å›å€¼
const int function5();      // è¿”å›ä¸€ä¸ªå¸¸æ•°
const int* function6();     // è¿”å›ä¸€ä¸ªæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆå˜é‡ï¼Œä½¿ç”¨ï¼šconst int *p = function6();
int* const function7();     // è¿”å›ä¸€ä¸ªæŒ‡å‘å˜é‡çš„å¸¸æŒ‡é’ˆï¼Œä½¿ç”¨ï¼šint* const p = function7();

```

#### #defineå’Œ const çš„æ¯”è¾ƒ

|#define|const å¸¸é‡|
:--:|:--:
å®å®šä¹‰ï¼Œç›¸å½“äºå­—ç¬¦æ›¿æ¢|å¸¸é‡å£°æ˜
é¢„å¤„ç†å™¨å¤„ç†|ç¼–è¯‘å™¨å¤„ç†
æ— ç±»å‹å®‰å…¨æ£€æŸ¥|æœ‰ç±»å‹å®‰å…¨æ£€æŸ¥
ä¸åˆ†é…å†…å­˜|è¦åˆ†é…å†…å­˜
å­˜å‚¨åœ¨ä»£ç æ®µ|å­˜å‚¨åœ¨æ•°æ®æ®µ
å¯é€šè¿‡ `#undef` å–æ¶ˆ|ä¸å¯å–æ¶ˆ

## `mutable`

>ç”¨äºä¿®é¥°ç±»ä¸­çš„æˆå‘˜å˜é‡ï¼Œè¡¨ç¤ºè¿™ä¸ªæˆå‘˜å˜é‡å¯ä»¥è¢«ä¿®æ”¹ï¼Œå³ä½¿æ˜¯åœ¨ä¸€ä¸ª`const`æˆå‘˜å‡½æ•°ä¸­ã€‚

ä½†æ˜¯ï¼Œ**mutableå…³é”®å­—ä¸èƒ½ç”¨äºä¿®é¥°staticç±»å‹å˜é‡**ï¼Œå› ä¸ºé™æ€å˜é‡çš„å€¼æ˜¯å­˜å‚¨åœ¨ç±»çš„é™æ€å­˜å‚¨åŒºä¸­çš„ï¼Œä¸æ˜¯å­˜å‚¨åœ¨å¯¹è±¡ä¸­çš„ã€‚é™æ€å˜é‡ä¸ç±»çš„ä»»ä½•å¯¹è±¡éƒ½æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰â€è¢«consté™åˆ¶çš„ä¿®æ”¹â€è¿™ä¸ªé—®é¢˜ã€‚

```c++
//å¤šç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œåœ¨è¢«constä¿®é¥°çš„æˆå‘˜å‡½æ•°ä¸­ï¼Œä¹Ÿå¯ä»¥å¯¹é”è¿›è¡Œä¿®æ”¹
class LockableClass {
public:
    void doSomething() const {
        std::lock_guard<std::mutex> lock(m_mutex);
        // do something while holding the lock
        // ...
    }
private:
    mutable std::mutex m_mutex;
};
```

## å¼•ç”¨

### å·¦å€¼å¼•ç”¨

å¸¸è§„å¼•ç”¨ï¼Œä¸€èˆ¬è¡¨ç¤ºå¯¹è±¡çš„èº«ä»½ã€‚

### å³å€¼å¼•ç”¨

å³å€¼å¼•ç”¨å°±æ˜¯å¿…é¡»ç»‘å®šåˆ°å³å€¼ï¼ˆä¸€ä¸ªä¸´æ—¶å¯¹è±¡ã€å°†è¦é”€æ¯çš„å¯¹è±¡ï¼‰çš„å¼•ç”¨ã€‚

å³å€¼å¼•ç”¨å¯å®ç°è½¬ç§»è¯­ä¹‰å’Œå®Œç¾è½¬å‘ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æœ‰ä¸¤ä¸ªæ–¹é¢ï¼š

* æ¶ˆé™¤ä¸¤ä¸ªå¯¹è±¡äº¤äº’æ—¶ä¸å¿…è¦çš„å¯¹è±¡æ‹·è´ï¼ŒèŠ‚çœè¿ç®—å­˜å‚¨èµ„æºï¼Œæé«˜æ•ˆç‡ã€‚
* èƒ½å¤Ÿæ›´ç®€æ´æ˜ç¡®åœ°å®šä¹‰æ³›å‹å‡½æ•°ã€‚
  
#### ç§»åŠ¨è¯­ä¹‰

`std::move` çš„åº•å±‚å®ç°éå¸¸ç®€å•ï¼Œå®ƒå°±æ˜¯å°†å¯¹è±¡çš„åœ°å€è¿”å›ï¼Œä¸ä¼šè¿›è¡Œä»»ä½•å®é™…çš„å¤åˆ¶æˆ–ç§»åŠ¨æ“ä½œã€‚ç”±äºè¿”å›çš„æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶ç»‘å®šåˆ°å³å€¼å¯¹è±¡ã€ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼å‡½æ•°ä¸­ï¼Œå®ç°å¯¹è±¡çš„ç§»åŠ¨æ“ä½œã€‚

```c++
template <typename T>
typename remove_reference<T>::type&& move(T&& arg) noexcept {
    return static_cast<typename remove_reference<T>::type&&>(arg);
}
```

```c++
//remove_referenceçš„STLå®ç°
template <typename T>
struct remove_reference {
    using type = T;
};

template <typename T>
struct remove_reference<T&> {
    using type = T;
};

template <typename T>
struct remove_reference<T&&> {
    using type = T;
};
```

```c++
std::string s1 = "Hello";
//1. åˆ›å»ºä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸² â€œHelloâ€ çš„æŒ‡é’ˆï¼ˆC é£æ ¼å­—ç¬¦ä¸²ï¼‰ã€‚
//2. ä½¿ç”¨å­—ç¬¦ä¸²æŒ‡é’ˆåˆ›å»º std::string å¯¹è±¡ s1ï¼Œå°†å­—ç¬¦ä¸²æ•°æ®å¤åˆ¶åˆ° s1 çš„å†…éƒ¨å­˜å‚¨åŒºåŸŸä¸­ã€‚
//3. é‡Šæ”¾å­—ç¬¦ä¸²æŒ‡é’ˆã€‚
std::string s2 = std::move(s1);
// 1. è°ƒç”¨ std::move(s1) å°† s1 è½¬æ¢ä¸ºå³å€¼ï¼ˆstd::string&& ç±»å‹ï¼‰ã€‚
// 2. è°ƒç”¨ std::string ç±»çš„ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ std::string å¯¹è±¡ s2ï¼Œå¹¶å°†å³å€¼å¼•ç”¨ä¸­çš„å†…éƒ¨æ•°æ®æŒ‡é’ˆ move åˆ° s2 ä¸­ã€‚æ­¤æ—¶ï¼Œs1 çš„å†…éƒ¨æ•°æ®æŒ‡é’ˆå·²ç»æˆä¸ºäº†ç©ºæŒ‡é’ˆã€‚
// 3. s1 å¯¹è±¡è¢«é”€æ¯ï¼Œå…¶å†…éƒ¨å­˜å‚¨åŒºåŸŸè¢«é‡Šæ”¾ã€‚

//ç®€å•çš„ç§»åŠ¨æ„é€ å‡½æ•°ç¤ºä¾‹
string::string(string&& other) noexcept
 : _M_data(other._M_data),
   _M_size(other._M_size)
{
    // å°†å³å€¼å¼•ç”¨å¯¹è±¡çš„æŒ‡é’ˆè®¾ä¸ºç©º
    other._M_data = nullptr;
    other._M_size = 0;
}

```

#### å®Œç¾è½¬å‘

`forward`ä½¿ç”¨ç¤ºä¾‹

```c++
#include <iostream>
#include <utility>

void foo(int& x) {
    std::cout << "lvalue: " << x << std::endl;
}

void foo(int&& x) {
    std::cout << "rvalue: " << x << std::endl;
}

template <typename T>
void bar(T&& x) {
    foo(std::forward<T>(x));
}

int main() {
    int a = 1;
    bar(a);        // lvalue: 1
    bar(2);        // rvalue: 2
    bar(std::move(a));  // rvalue: 1
    return 0;
}
```

`forward`å®ç°åŸç†

```c++
#include <iostream>
#include <type_traits>

template <typename T>
T&& my_forward(typename std::remove_reference<T>::type& arg) noexcept {
    return static_cast<T&&>(arg);
}

template <typename T>
T&& my_forward(typename std::remove_reference<T>::type&& arg) noexcept {
    static_assert(!std::is_lvalue_reference<T>::value, "lvalue cannot be forwarded as rvalue");

    return static_cast<T&&>(arg);
}

void func(int&& value) {
    std::cout << "rvalue: " << value << std::endl;
}

void func(int& value) {
    std::cout << "lvalue: " << value << std::endl;
}

template <typename T>
void wrapper(T&& arg) {
    func(my_forward<T>(arg));
}

int main() {
    int value = 42;

    wrapper(value);    // lvalue: 42
    wrapper(std::move(value));    // rvalue: 42

    return 0;
}
```

#### å¼•ç”¨æŠ˜å 

* `X& &`ã€`X& &&`ã€`X&& &` å¯æŠ˜å æˆ `X&`
* `X&& &&` å¯æŠ˜å æˆ `X&&`

## å‡½æ•°æŒ‡é’ˆ

* æ¦‚å¿µï¼šæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå…¥å£åœ°å€ï¼Œè¯¥å…¥å£åœ°å€å°±æ˜¯å‡½æ•°æŒ‡é’ˆçš„æŒ‡å‘

* åº”ç”¨åœºæ™¯ï¼šå›è°ƒï¼ˆåˆ«äººçš„åº“é‡Œé¢è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼Œå°±å«åšCallBackï¼‰

```c++
void qsort(void *base,     //åŸå§‹æ•°ç»„
           size_t nmemb,   //æ•°æ®æ•°é‡
           size_t size,    //å•ä¸ªæ•°æ®ç©ºé—´
           int (*compar)(const void *, const void *)
           );

int cmp_int(const void *_a, const void * _b) {
    int *a = (int*)_a;
    int *b = (int*)_b;
    return *a - *b;
}
```

## `this` æŒ‡é’ˆ

1. `this` æŒ‡é’ˆæ˜¯ä¸€ä¸ªéšå«äºæ¯ä¸€ä¸ªéé™æ€æˆå‘˜å‡½æ•°ä¸­çš„ç‰¹æ®ŠæŒ‡é’ˆã€‚å®ƒæŒ‡å‘è°ƒç”¨è¯¥æˆå‘˜å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚
2. å½“å¯¹ä¸€ä¸ªå¯¹è±¡è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œç¼–è¯‘ç¨‹åºå…ˆå°†å¯¹è±¡çš„åœ°å€èµ‹ç»™ `this` æŒ‡é’ˆï¼Œç„¶åè°ƒç”¨æˆå‘˜å‡½æ•°ï¼Œæ¯æ¬¡æˆå‘˜å‡½æ•°å­˜å–æ•°æ®æˆå‘˜æ—¶ï¼Œéƒ½éšå¼ä½¿ç”¨ `this` æŒ‡é’ˆã€‚
3. å½“ä¸€ä¸ªæˆå‘˜å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè‡ªåŠ¨å‘å®ƒä¼ é€’ä¸€ä¸ªéšå«çš„å‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªæˆå‘˜å‡½æ•°æ‰€åœ¨çš„å¯¹è±¡çš„æŒ‡é’ˆã€‚
4. `this` æŒ‡é’ˆè¢«éšå«åœ°å£°æ˜ä¸º: `ClassName *const this`ï¼Œè¿™æ„å‘³ç€ä¸èƒ½ç»™ `this` æŒ‡é’ˆèµ‹å€¼ï¼›åœ¨ `ClassName` ç±»çš„ `const` æˆå‘˜å‡½æ•°ä¸­ï¼Œ`this` æŒ‡é’ˆçš„ç±»å‹ä¸ºï¼š`const ClassName* const`ï¼Œè¿™è¯´æ˜ä¸èƒ½å¯¹ `this` æŒ‡é’ˆæ‰€æŒ‡å‘çš„è¿™ç§å¯¹è±¡æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼ˆå³ä¸èƒ½å¯¹è¿™ç§å¯¹è±¡çš„æ•°æ®æˆå‘˜è¿›è¡Œèµ‹å€¼æ“ä½œï¼‰ï¼›
5. `this` å¹¶ä¸æ˜¯ä¸€ä¸ªå¸¸è§„å˜é‡ï¼Œè€Œæ˜¯ä¸ªå³å€¼ï¼Œæ‰€ä¸èƒ½å–å¾— `this` çš„åœ°å€ï¼ˆä¸èƒ½ `&this`ï¼‰ã€‚
6. `this`åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œç»‘å®š

```c++
//å®ç°é“¾å¼å¼•ç”¨
class MyClass {
public:
    MyClass& setX(int x) {
        this->x = x;  // ä½¿ç”¨ this æŒ‡é’ˆå®ç°é“¾å¼è°ƒç”¨
        return *this;
    }
    MyClass& setY(int y) {
        this->y = y;  // ä½¿ç”¨ this æŒ‡é’ˆå®ç°é“¾å¼è°ƒç”¨
        return *this;
    }
private:
    int x;
    int y;
};

int main() {
    MyClass obj;
    obj.setX(1).setY(2);  // é“¾å¼è°ƒç”¨
    return 0;
}
```

## `static`

1. ä¿®é¥°æ™®é€šå˜é‡ï¼Œä¿®æ”¹å˜é‡çš„å­˜å‚¨åŒºåŸŸå’Œç”Ÿå‘½å‘¨æœŸï¼Œä½¿å˜é‡å­˜å‚¨åœ¨é™æ€åŒºï¼Œåœ¨ main å‡½æ•°è¿è¡Œå‰å°±åˆ†é…äº†ç©ºé—´ï¼Œå¦‚æœæœ‰åˆå§‹å€¼å°±ç”¨åˆå§‹å€¼åˆå§‹åŒ–å®ƒï¼Œå¦‚æœæ²¡æœ‰åˆå§‹å€¼ç³»ç»Ÿç”¨é»˜è®¤å€¼åˆå§‹åŒ–å®ƒã€‚
2. ä¿®é¥°æ™®é€šå‡½æ•°ï¼Œè¡¨æ˜å‡½æ•°çš„ä½œç”¨èŒƒå›´ï¼Œä»…åœ¨å®šä¹‰è¯¥å‡½æ•°çš„æ–‡ä»¶å†…æ‰èƒ½ä½¿ç”¨ã€‚åœ¨å¤šäººå¼€å‘é¡¹ç›®æ—¶ï¼Œä¸ºäº†é˜²æ­¢ä¸ä»–äººå‘½åç©ºé—´é‡Œçš„å‡½æ•°é‡åï¼Œå¯ä»¥å°†å‡½æ•°å®šä½ä¸º staticã€‚
3. ä¿®é¥°æˆå‘˜å˜é‡ï¼Œä¿®é¥°æˆå‘˜å˜é‡ä½¿æ‰€æœ‰çš„å¯¹è±¡åªä¿å­˜ä¸€ä¸ªè¯¥å˜é‡ï¼Œè€Œä¸”ä¸éœ€è¦ç”Ÿæˆå¯¹è±¡å°±å¯ä»¥è®¿é—®è¯¥æˆå‘˜ã€‚
4. ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œä¿®é¥°æˆå‘˜å‡½æ•°ä½¿å¾—ä¸éœ€è¦ç”Ÿæˆå¯¹è±¡å°±å¯ä»¥è®¿é—®è¯¥å‡½æ•°ï¼Œä½†æ˜¯åœ¨ static å‡½æ•°å†…ä¸èƒ½è®¿é—®éé™æ€æˆå‘˜ã€‚

### åœ¨æˆå‘˜å‡½æ•°å†…éƒ¨å£°æ˜é™æ€å˜é‡

åœ¨æˆå‘˜å‡½æ•°å†…éƒ¨å£°æ˜çš„é™æ€å˜é‡æ˜¯è¯¥å‡½æ•°çš„å±€éƒ¨é™æ€å˜é‡ã€‚è¿™ç§å±€éƒ¨é™æ€å˜é‡åªä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ—¶åˆå§‹åŒ–ï¼Œå¹¶ä¸”åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­ä»…å­˜åœ¨ä¸€ä¸ªå®ä¾‹ã€‚

```c++
class MyClass {
public:
    void myFunction() {
        static int myStaticVar = 0;
        cout << "myStaticVar = " << ++myStaticVar << endl;
    }
};

int main() {
    MyClass obj1, obj2;
    obj1.myFunction(); // è¾“å‡ºï¼šmyStaticVar = 1
    obj1.myFunction(); // è¾“å‡ºï¼šmyStaticVar = 2
    obj2.myFunction(); // è¾“å‡ºï¼šmyStaticVar = 3
    obj2.myFunction(); // è¾“å‡ºï¼šmyStaticVar = 4
}
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå±€éƒ¨é™æ€å˜é‡å¿…é¡»åˆå§‹åŒ–ä¸ºå­—é¢å€¼å¸¸é‡æˆ–è€…ä½¿ç”¨å¸¸é‡è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š

```c++
void myFunction() {
    static int myStaticVar = 5; // æ­£ç¡®ï¼Œåˆå§‹åŒ–ä¸ºå­—é¢å€¼å¸¸é‡
    static int anotherStaticVar = myStaticVar + 2; // é”™è¯¯ï¼Œä¸èƒ½ä½¿ç”¨éå¸¸é‡è¡¨è¾¾å¼åˆå§‹åŒ–
}
```

## `inline`

* ç›¸å½“äºæŠŠå†…è”å‡½æ•°é‡Œé¢çš„å†…å®¹å†™åœ¨è°ƒç”¨å†…è”å‡½æ•°å¤„ï¼›
* ç›¸å½“äºä¸ç”¨æ‰§è¡Œè¿›å…¥å‡½æ•°çš„æ­¥éª¤ï¼Œç›´æ¥æ‰§è¡Œå‡½æ•°ä½“ï¼›
* ç›¸å½“äºå®ï¼Œå´æ¯”å®å¤šäº†ç±»å‹æ£€æŸ¥ï¼ŒçœŸæ­£å…·æœ‰å‡½æ•°ç‰¹æ€§ï¼›
* ç¼–è¯‘å™¨ä¸€èˆ¬ä¸å†…è”åŒ…å«å¾ªç¯ã€é€’å½’ã€switch ç­‰å¤æ‚æ“ä½œçš„å†…è”å‡½æ•°ï¼›
* åœ¨ç±»å£°æ˜ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œé™¤äº†è™šå‡½æ•°çš„å…¶ä»–å‡½æ•°éƒ½ä¼šè‡ªåŠ¨éšå¼åœ°å½“æˆå†…è”å‡½æ•°ã€‚

```cpp
// å£°æ˜1ï¼ˆåŠ  inlineï¼Œå»ºè®®ä½¿ç”¨ï¼‰
inline int functionName(int first, int second,...);

// å£°æ˜2ï¼ˆä¸åŠ  inlineï¼‰
int functionName(int first, int second,...);

// å®šä¹‰
inline int functionName(int first, int second,...) {/****/};

// ç±»å†…å®šä¹‰ï¼Œéšå¼å†…è”
class A {
    int doA() { return 0; }         // éšå¼å†…è”
}

// ç±»å¤–å®šä¹‰ï¼Œéœ€è¦æ˜¾å¼å†…è”
class A {
    int doA();
}
inline int A::doA() { return 0; }   // éœ€è¦æ˜¾å¼å†…è”
```

### ç¼–è¯‘å™¨å¯¹å…§è”å‡½æ•°çš„å¤„ç†æ­¥éª¤

1. å°† inline å‡½æ•°ä½“å¤åˆ¶åˆ° inline å‡½æ•°è°ƒç”¨ç‚¹å¤„ï¼›
2. ä¸ºæ‰€ç”¨ inline å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡åˆ†é…å†…å­˜ç©ºé—´ï¼›
3. å°† inline å‡½æ•°çš„çš„è¾“å…¥å‚æ•°å’Œè¿”å›å€¼æ˜ å°„åˆ°è°ƒç”¨æ–¹æ³•çš„å±€éƒ¨å˜é‡ç©ºé—´ä¸­ï¼›
4. å¦‚æœ inline å‡½æ•°æœ‰å¤šä¸ªè¿”å›ç‚¹ï¼Œå°†å…¶è½¬å˜ä¸º inline å‡½æ•°ä»£ç å—æœ«å°¾çš„åˆ†æ”¯ï¼ˆä½¿ç”¨ GOTOï¼‰ã€‚

### å…§è”å‡½æ•°ä¼˜ç¼ºç‚¹

ä¼˜ç‚¹

1. å†…è”å‡½æ•°åŒå®å‡½æ•°ä¸€æ ·å°†åœ¨è¢«è°ƒç”¨å¤„è¿›è¡Œä»£ç å±•å¼€ï¼Œçœå»äº†å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ï¼Œä»è€Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚
2. å†…è”å‡½æ•°ç›¸æ¯”å®å‡½æ•°æ¥è¯´ï¼Œåœ¨ä»£ç å±•å¼€æ—¶ï¼Œä¼šåšå®‰å…¨æ£€æŸ¥æˆ–è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆåŒæ™®é€šå‡½æ•°ï¼‰ï¼Œè€Œå®å®šä¹‰åˆ™ä¸ä¼šã€‚
3. åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼Œå› æ­¤å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚
4. å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ã€‚

ç¼ºç‚¹

1. ä»£ç è†¨èƒ€ã€‚å†…è”æ˜¯ä»¥ä»£ç è†¨èƒ€ï¼ˆå¤åˆ¶ï¼‰ä¸ºä»£ä»·ï¼Œæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„æ—¶é—´ï¼Œç›¸æ¯”äºå‡½æ•°è°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œé‚£ä¹ˆæ•ˆç‡çš„æ”¶è·ä¼šå¾ˆå°‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œå°†ä½¿ç¨‹åºçš„æ€»ä»£ç é‡å¢å¤§ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚
2. inline å‡½æ•°æ— æ³•éšç€å‡½æ•°åº“å‡çº§è€Œå‡çº§ã€‚inlineå‡½æ•°çš„æ”¹å˜éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œä¸åƒ non-inline å¯ä»¥ç›´æ¥é“¾æ¥ã€‚
3. æ˜¯å¦å†…è”ï¼Œç¨‹åºå‘˜ä¸å¯æ§ã€‚å†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œæ˜¯å¦å¯¹å‡½æ•°å†…è”ï¼Œå†³å®šæƒåœ¨äºç¼–è¯‘å™¨ã€‚

### è™šå‡½æ•°ï¼ˆvirtualï¼‰å¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼ˆinlineï¼‰å—ï¼Ÿ

* è™šå‡½æ•°å¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼Œå†…è”æ˜¯å¯ä»¥ä¿®é¥°è™šå‡½æ•°çš„ï¼Œä½†æ˜¯å½“è™šå‡½æ•°è¡¨ç°å¤šæ€æ€§çš„æ—¶å€™ä¸èƒ½å†…è”ã€‚
* å†…è”æ˜¯åœ¨ç¼–è¯‘æœŸå»ºè®®ç¼–è¯‘å™¨å†…è”ï¼Œè€Œè™šå‡½æ•°çš„å¤šæ€æ€§åœ¨è¿è¡ŒæœŸï¼Œç¼–è¯‘å™¨æ— æ³•çŸ¥é“è¿è¡ŒæœŸè°ƒç”¨å“ªä¸ªä»£ç ï¼Œå› æ­¤è™šå‡½æ•°è¡¨ç°ä¸ºå¤šæ€æ€§æ—¶ï¼ˆè¿è¡ŒæœŸï¼‰ä¸å¯ä»¥å†…è”ã€‚
* `inline virtual` å”¯ä¸€å¯ä»¥å†…è”çš„æ—¶å€™æ˜¯ï¼šç¼–è¯‘å™¨çŸ¥é“æ‰€è°ƒç”¨çš„å¯¹è±¡æ˜¯å“ªä¸ªç±»ï¼ˆå¦‚ `Base::who()`ï¼‰ï¼Œè¿™åªæœ‰åœ¨ç¼–è¯‘å™¨å…·æœ‰å®é™…å¯¹è±¡è€Œä¸æ˜¯å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨æ—¶æ‰ä¼šå‘ç”Ÿã€‚

## `volatile`

```cpp
volatile int i = 10; 
```

ç”¨æ¥å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å˜é‡çš„å€¼å¯èƒ½ä¼šåœ¨ç¨‹åºçš„æ‰§è¡ŒæœŸé—´è¢«æ„å¤–æ”¹å˜ï¼Œå› æ­¤éœ€è¦é‡æ–°è¯»å–è¯¥å˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç¼“å­˜ä¸­çš„æ—§å€¼ã€‚å…¶ä¸»è¦ä½œç”¨æ˜¯é˜²æ­¢ç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Œä¿è¯ç¨‹åºçš„æ­£ç¡®æ€§ã€‚

å…·ä½“æ¥è¯´ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢«å£°æ˜ä¸º volatile æ—¶ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆä»£ç æ—¶ä¼šå‡å®šè¯¥å¯¹è±¡çš„å€¼å¯èƒ½ä¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´å‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤æ¯æ¬¡è®¿é—®è¯¥å¯¹è±¡æ—¶å¿…é¡»ä»å†…å­˜ä¸­è¯»å–æœ€æ–°çš„å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¹‹å‰ç¼“å­˜çš„å€¼ã€‚åŒæ ·åœ°ï¼Œå¦‚æœç¨‹åºè¦å†™å…¥ä¸€ä¸ª volatile å˜é‡çš„å€¼ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šä½¿ç”¨ç¼“å­˜çš„æ—§å€¼ï¼Œè€Œæ˜¯ç›´æ¥å†™å…¥å†…å­˜ï¼Œä»¥ä¿è¯è¯¥å€¼çš„å¯é æ€§å’Œæ­£ç¡®æ€§ã€‚

ä½¿ç”¨ volatile å…³é”®å­—çš„æƒ…å†µåŒ…æ‹¬ï¼š

* å¹¶å‘ç¼–ç¨‹ï¼šå¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹è®¿é—®åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œéœ€è¦ä½¿ç”¨ volatile ä¿è¯å˜é‡å€¼çš„æ­£ç¡®æ€§ã€‚
* ä¸­æ–­å¤„ç†ï¼šä¸­æ–­å¤„ç†ç¨‹åºä¸­ä½¿ç”¨çš„å˜é‡éœ€è¦ä½¿ç”¨ volatileï¼Œä»¥ç¡®ä¿å®ƒä»¬çš„å€¼èƒ½å¤ŸåŠæ—¶æ›´æ–°ã€‚
* å†…å­˜æ˜ å°„çš„ç¡¬ä»¶å¯„å­˜å™¨ï¼šéœ€è¦ä½¿ç”¨ volatile å…³é”®å­—æ¥é˜²æ­¢ç¼–è¯‘å™¨å¯¹å¯„å­˜å™¨çš„ä¼˜åŒ–ï¼Œç¡®ä¿æ¯æ¬¡è¯»å†™éƒ½èƒ½ç›´æ¥ä¸ç¡¬ä»¶è¿›è¡Œäº¤äº’ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œvolatile å¹¶ä¸èƒ½ä¿è¯å¹¶å‘ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œå®ƒä»…ä»…æé†’ç¼–è¯‘å™¨è¯¥å˜é‡å¯èƒ½ä¼šåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ”¹å˜ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ä»éœ€è¦ä½¿ç”¨äº’æ–¥é‡ã€åŸå­æ“ä½œç­‰å¹¶å‘ç¼–ç¨‹æŠ€æœ¯æ¥ä¿è¯ç¨‹åºçš„æ­£ç¡®æ€§ã€‚

* volatile å…³é”®å­—æ˜¯ä¸€ç§ç±»å‹ä¿®é¥°ç¬¦ï¼Œç”¨å®ƒå£°æ˜çš„ç±»å‹å˜é‡è¡¨ç¤ºå¯ä»¥è¢«æŸäº›ç¼–è¯‘å™¨æœªçŸ¥çš„å› ç´ ï¼ˆæ“ä½œç³»ç»Ÿã€ç¡¬ä»¶ã€å…¶å®ƒçº¿ç¨‹ç­‰ï¼‰æ›´æ”¹ã€‚æ‰€ä»¥ä½¿ç”¨ volatile å‘Šè¯‰ç¼–è¯‘å™¨ä¸åº”å¯¹è¿™æ ·çš„å¯¹è±¡è¿›è¡Œä¼˜åŒ–ã€‚
* volatile å…³é”®å­—å£°æ˜çš„å˜é‡ï¼Œæ¯æ¬¡è®¿é—®æ—¶éƒ½å¿…é¡»ä»å†…å­˜ä¸­å–å‡ºå€¼ï¼ˆæ²¡æœ‰è¢« volatile ä¿®é¥°çš„å˜é‡ï¼Œå¯èƒ½ç”±äºç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Œä» CPU å¯„å­˜å™¨ä¸­å–å€¼ï¼‰
* const å¯ä»¥æ˜¯ volatile ï¼ˆå¦‚åªè¯»çš„çŠ¶æ€å¯„å­˜å™¨ï¼‰
* æŒ‡é’ˆå¯ä»¥æ˜¯ volatile

## `assert`

æ˜¯å®ï¼Œè€Œéå‡½æ•°ã€‚å¯ä»¥é€šè¿‡å®šä¹‰ `NDEBUG` æ¥å…³é—­ assertï¼Œä½†æ˜¯éœ€è¦åœ¨`include <assert.h>` ä¹‹å‰ã€‚

assertçš„å†…éƒ¨å®ç°

```cpp
#ifdef NDEBUG
    #define assert(condition) ((void)0)
#else
    #define assert(condition) ((condition) ? (void)0 : \
            __assert(__FILE__, __LINE__, #condition))
#endif

void __assert(const char *file, unsigned int line, const char *expr) {
    // è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶ç»ˆæ­¢ç¨‹åºè¿è¡Œ
    fprintf(stderr, "Assertion failed: %s, file %s, line %u\n", expr, file, line);
    abort();
}
```

> #æ˜¯ä¸€ä¸ªé¢„å¤„ç†å™¨è¿ç®—ç¬¦ï¼Œå®ƒä¼šæŠŠå®å‚æ•°è½¬æ¢æˆå­—ç¬¦ä¸²å­—é¢é‡ã€‚åœ¨ # åé¢çš„å®å‚æ•°ä¼šè¢«è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨å®çš„å±•å¼€ä¸­ã€‚

assert ä½¿ç”¨

```cpp
#define NDEBUG          // åŠ ä¸Šè¿™è¡Œï¼Œåˆ™ assert ä¸å¯ç”¨
#include <assert.h>

assert( p != NULL );    // assert ä¸å¯ç”¨
```

## `constexpr`

* å¯¹äºä¸€ä¸ªå˜é‡æˆ–è€…æ˜¯å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å®šä¹‰ä¸º constexpr ç±»å‹ï¼Œè¿™æ ·å°±èƒ½å¤Ÿåœ¨ç¼–è¯‘æœŸç¡®å®šè¯¥å˜é‡æˆ–è€…æ˜¯å¯¹è±¡çš„å€¼ï¼Œè¿™æ ·å¯ä»¥æé«˜ä»£ç çš„æ•ˆç‡ã€‚

* å¯¹äºä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å£°æ˜ä¸º constexpr å‡½æ•°ï¼Œè¿™æ ·å°±è¡¨ç¤ºè¯¥å‡½æ•°å¯ä»¥åœ¨ç¼–è¯‘æœŸæ‰§è¡Œï¼Œå¯ä»¥ç”¨äºè®¡ç®—ç¼–è¯‘æœŸé—´çš„å¸¸é‡è¡¨è¾¾å¼ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨ç¼–è¯‘æœŸå°±æ£€æŸ¥æ˜¯å¦æ»¡è¶³æŸäº›æ¡ä»¶ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ª constexpr å‡½æ•°ä¸­åªèƒ½æœ‰ä¸€æ¡ return è¯­å¥ï¼Œå‡½æ•°ä½“å†…åªèƒ½æœ‰ä¸€è¡Œè¯­å¥ï¼Œè€Œä¸”è¿™ä¸ªè¯­å¥åº”è¯¥æ˜¯ return è¯­å¥ã€‚å¦å¤–ï¼Œconstexpr å‡½æ•°ä¸­çš„æ‰€æœ‰å½¢å‚å’Œå±€éƒ¨å˜é‡å¿…é¡»ä¸º constexprã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå°† constexpr å…³é”®å­—åº”ç”¨åœ¨ä¸åˆé€‚çš„åœ°æ–¹ï¼Œå¯èƒ½ä¼šé™ä½ä»£ç çš„æ€§èƒ½ã€‚

```c++

#include <iostream>

constexpr int square(int x) { // å£°æ˜ä¸º constexpr å‡½æ•°
    return x * x;
}

int main() {
    constexpr int N = square(5); // å£°æ˜ä¸º constexpr å˜é‡
    std::cout << N << std::endl; // è¾“å‡º 25
    return 0;
}

```

## `pragma pack(n)`

è®¾å®šç»“æ„ä½“ã€è”åˆä»¥åŠç±»æˆå‘˜å˜é‡ä»¥ n å­—èŠ‚æ–¹å¼å¯¹é½

```cpp
#pragma pack(push)  // ä¿å­˜å¯¹é½çŠ¶æ€
#pragma pack(4)     // è®¾å®šä¸º 4 å­—èŠ‚å¯¹é½

struct test
{
    char m1;
    double m4;
    int m3;
};

#pragma pack(pop)   // æ¢å¤å¯¹é½çŠ¶æ€
```

## ä½åŸŸ

```cpp
//åœ¨ C æˆ– C++ ä¸­ï¼Œä½åŸŸæä¾›äº†ä¸€ç§ä¼˜åŒ–å†…å­˜ä½¿ç”¨çš„æ–¹å¼ã€‚å®ƒå…è®¸åœ¨ç»“æ„ä½“ä¸­ä»…ç”¨ä¸€å®šæ•°é‡çš„æ¯”ç‰¹ä½æ¥å­˜å‚¨å­—æ®µï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ•´ä¸ªå­—èŠ‚æˆ–æ›´å¤šç©ºé—´æ¥å­˜å‚¨ä¸€ä¸ªå°å€¼ã€‚

//ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„æ¥å­˜å‚¨é¢œè‰²çš„ä¸‰ä¸ªæˆåˆ†ï¼šçº¢è‰²ã€ç»¿è‰²å’Œè“è‰²ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç»“æ„ä½“æ¥è¡¨ç¤ºå®ƒï¼š

struct Color {
    unsigned char red;
    unsigned char green;
    unsigned char blue;
};

//è¿™å°†å ç”¨ 3 ä¸ªå­—èŠ‚çš„å†…å­˜ï¼Œå› ä¸ºæ¯ä¸ªæˆåˆ†ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚ã€‚ä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä½åŸŸï¼Œå¯ä»¥åªä½¿ç”¨ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼š

struct Color {
    unsigned int red : 4;
    unsigned int green : 4;
    unsigned int blue : 4;
};

//åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæˆåˆ†åªå ç”¨äº† 4 ä½ï¼ˆåŠä¸ªå­—èŠ‚ï¼‰ï¼Œæ€»å…±åªéœ€è¦ 2 ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å‡å°‘ä¸€åŠçš„å†…å­˜å¼€é”€ã€‚
```

ç±»å¯ä»¥å°†å…¶ï¼ˆéé™æ€ï¼‰æ•°æ®æˆå‘˜å®šä¹‰ä¸ºä½åŸŸï¼ˆbit-fieldï¼‰ï¼Œåœ¨ä¸€ä¸ªä½åŸŸä¸­å«æœ‰ä¸€å®šæ•°é‡çš„äºŒè¿›åˆ¶ä½ã€‚å½“ä¸€ä¸ªç¨‹åºéœ€è¦å‘å…¶ä»–ç¨‹åºæˆ–ç¡¬ä»¶è®¾å¤‡ä¼ é€’äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ°ä½åŸŸã€‚

* ä½åŸŸåœ¨å†…å­˜ä¸­çš„å¸ƒå±€æ˜¯ä¸æœºå™¨æœ‰å…³çš„
* ä½åŸŸçš„ç±»å‹å¿…é¡»æ˜¯æ•´å‹æˆ–æšä¸¾ç±»å‹ï¼Œå¸¦ç¬¦å·ç±»å‹ä¸­çš„ä½åŸŸçš„è¡Œä¸ºå°†å› å…·ä½“å®ç°è€Œå®š
* å–åœ°å€è¿ç®—ç¬¦ï¼ˆ&ï¼‰ä¸èƒ½ä½œç”¨äºä½åŸŸï¼Œä»»ä½•æŒ‡é’ˆéƒ½æ— æ³•æŒ‡å‘ç±»çš„ä½åŸŸ

## `extern "C"`

* è¢« `extern "C"` ä¿®é¥°çš„å˜é‡å’Œå‡½æ•°æ˜¯æŒ‰ç…§ C è¯­è¨€æ–¹å¼ç¼–è¯‘å’Œé“¾æ¥çš„

* `extern "C"` çš„ä½œç”¨æ˜¯è®© C++ ç¼–è¯‘å™¨å°† `extern "C"` å£°æ˜çš„ä»£ç å½“ä½œ C è¯­è¨€ä»£ç å¤„ç†ï¼Œå¯ä»¥é¿å… C++ å› ç¬¦å·ä¿®é¥°å¯¼è‡´ä»£ç ä¸èƒ½å’ŒCè¯­è¨€åº“ä¸­çš„ç¬¦å·è¿›è¡Œé“¾æ¥çš„é—®é¢˜ã€‚

```cpp
#ifdef __cplusplus
extern "C" {
#endif

// C å‡½æ•°å®šä¹‰
void c_function(int arg) {
    printf("%d\n"` arg);
}

#ifdef __cplusplus
}
#endif

// C++ ä»£ç ä¸­è°ƒç”¨ C å‡½æ•°
int main() {
    c_function(42);
    return 0;
}
```

## å®è§£é‡Š

`#`

```c++
//è½¬åŒ–ä¸ºå­—ç¬¦ä¸²
#include <stdio.h>
#define LOGS(x)       printf("%s--%d\n",#x,x);
int main()
{
     int a=10;
     LOGS(a); //a--10
     return 0;
}
```

`##`

```c++
//è¿æ¥å­—ç¬¦ä¸²
#include <stdio.h>
#define LOG(x)    out_##x()
void out_1(void)
{
     printf("This is out_1 \n");
}
void out_2(void)
{
     printf("This is out_2 \n");
}
int main()
{
     LOG(1) ;   //This is out_1
     return 0;
}
```

`__VA_ARGS__`

```c++
//æ ·å¯å˜å‚
#include <stdio.h>
#define LOGV(...)       printf(__VA_ARGS__);

int main()
{
    int a=10,b=11;
    LOGV("a=%d--b=%d\r\n",a,b);   //a=10--b=11
    return 0;
}
```

`##__VA_ARGS__`

## `function`

`std::function` æ˜¯ C++11 ä¸­çš„æ ‡å‡†åº“å‡½æ•°å¯¹è±¡åŒ…è£…å™¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥å­˜å‚¨å’Œè°ƒç”¨ä»»ä½•å¯è°ƒç”¨å¯¹è±¡

```c++
#include <iostream>
#include <functional>

void print_message(const std::string& message) {
    std::cout << "Message: " << message << std::endl;
}

class MessageSender {
public:
    void send_message(const std::string& message) const {
        std::cout << "Sent: " << message << std::endl;
    }
};

int main() {
    // 1. æ™®é€šå‡½æ•°
    std::function<void(const std::string&)> func1 = print_message;
    func1("Hello, world!"); // è¾“å‡º "Message: Hello, world!"

    // 2. æˆå‘˜å‡½æ•°
    MessageSender sender;
    std::function<void(MessageSender&, const std::string&)> func2 = &MessageSender::send_message;
    func2(sender, "Hello, world!"); // è¾“å‡º "Sent: Hello, world!"

    // 3. Lambda è¡¨è¾¾å¼
    auto lambda = [](const std::string& message) -> void { 
        std::cout << "Lambda message: " << message << std::endl; 
    };
    std::function<void(const std::string&)> func3 = lambda;
    func3("Hello, world!"); // è¾“å‡º "Lambda message: Hello, world!"

    return 0;
}
```

## `union`

è”åˆï¼ˆunionï¼‰æ˜¯ä¸€ç§èŠ‚çœç©ºé—´çš„ç‰¹æ®Šçš„ç±»ï¼Œä¸€ä¸ª union å¯ä»¥æœ‰å¤šä¸ªæ•°æ®æˆå‘˜ï¼Œä½†æ˜¯åœ¨ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªæ•°æ®æˆå‘˜å¯ä»¥æœ‰å€¼ã€‚å½“æŸä¸ªæˆå‘˜è¢«èµ‹å€¼åå…¶ä»–æˆå‘˜å˜ä¸ºæœªå®šä¹‰çŠ¶æ€ã€‚è”åˆæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š

* é»˜è®¤è®¿é—®æ§åˆ¶ç¬¦ä¸º public
* å¯ä»¥å«æœ‰æ„é€ å‡½æ•°ã€ææ„å‡½æ•°
* ä¸èƒ½å«æœ‰å¼•ç”¨ç±»å‹çš„æˆå‘˜
* ä¸èƒ½ç»§æ‰¿è‡ªå…¶ä»–ç±»ï¼Œä¸èƒ½ä½œä¸ºåŸºç±»
* ä¸èƒ½å«æœ‰è™šå‡½æ•°
* åŒ¿å union åœ¨å®šä¹‰æ‰€åœ¨ä½œç”¨åŸŸå¯ç›´æ¥è®¿é—® union æˆå‘˜
* åŒ¿å union ä¸èƒ½åŒ…å« protected æˆå‘˜æˆ– private æˆå‘˜
* å…¨å±€åŒ¿åè”åˆå¿…é¡»æ˜¯é™æ€ï¼ˆstaticï¼‰çš„

```cpp
#include<iostream>

union UnionTest {
    UnionTest() : i(10) {};
    int i;
    double d;
};

static union {
    int i;
    double d;
};

int main() {
    UnionTest u;

    union {
        int i;
        double d;
    };

    std::cout << u.i << std::endl;  // è¾“å‡º UnionTest è”åˆçš„ 10

    ::i = 20;
    std::cout << ::i << std::endl;  // è¾“å‡ºå…¨å±€é™æ€åŒ¿åè”åˆçš„ 20

    i = 30;
    std::cout << i << std::endl;    // è¾“å‡ºå±€éƒ¨åŒ¿åè”åˆçš„ 30

    return 0;
}
```

## `explicit`

* explicit ä¿®é¥°æ„é€ å‡½æ•°æ—¶ï¼Œå¯ä»¥é˜²æ­¢éšå¼è½¬æ¢å’Œå¤åˆ¶åˆå§‹åŒ–
* explicit ä¿®é¥°è½¬æ¢å‡½æ•°æ—¶ï¼Œå¯ä»¥é˜²æ­¢éšå¼è½¬æ¢ï¼Œä½† [æŒ‰è¯­å¢ƒè½¬æ¢](https://zh.cppreference.com/w/cpp/language/implicit_conversion) é™¤å¤–

```cpp
struct A
{
    A(int) { }
    operator bool() const { return true; }
};

struct B
{
    explicit B(int) {}
    explicit operator bool() const { return true; }
};

void doA(A a) {}

void doB(B b) {}

int main()
{
    A a1(1);        // OKï¼šç›´æ¥åˆå§‹åŒ–
    A a2 = 1;       // OKï¼šå¤åˆ¶åˆå§‹åŒ–
    A a3{ 1 };      // OKï¼šç›´æ¥åˆ—è¡¨åˆå§‹åŒ–
    A a4 = { 1 };       // OKï¼šå¤åˆ¶åˆ—è¡¨åˆå§‹åŒ–
    A a5 = (A)1;        // OKï¼šå…è®¸ static_cast çš„æ˜¾å¼è½¬æ¢ 
    doA(1);         // OKï¼šå…è®¸ä» int åˆ° A çš„éšå¼è½¬æ¢
    if (a1);        // OKï¼šä½¿ç”¨è½¬æ¢å‡½æ•° A::operator bool() çš„ä» A åˆ° bool çš„éšå¼è½¬æ¢
    bool a6(a1);        // OKï¼šä½¿ç”¨è½¬æ¢å‡½æ•° A::operator bool() çš„ä» A åˆ° bool çš„éšå¼è½¬æ¢
    bool a7 = a1;       // OKï¼šä½¿ç”¨è½¬æ¢å‡½æ•° A::operator bool() çš„ä» A åˆ° bool çš„éšå¼è½¬æ¢
    bool a8 = static_cast<bool>(a1);  // OK ï¼šstatic_cast è¿›è¡Œç›´æ¥åˆå§‹åŒ–

    B b1(1);        // OKï¼šç›´æ¥åˆå§‹åŒ–
    B b2 = 1;       // é”™è¯¯ï¼šè¢« explicit ä¿®é¥°æ„é€ å‡½æ•°çš„å¯¹è±¡ä¸å¯ä»¥å¤åˆ¶åˆå§‹åŒ–
    B b3{ 1 };      // OKï¼šç›´æ¥åˆ—è¡¨åˆå§‹åŒ–
    B b4 = { 1 };       // é”™è¯¯ï¼šè¢« explicit ä¿®é¥°æ„é€ å‡½æ•°çš„å¯¹è±¡ä¸å¯ä»¥å¤åˆ¶åˆ—è¡¨åˆå§‹åŒ–
    B b5 = (B)1;        // OKï¼šå…è®¸ static_cast çš„æ˜¾å¼è½¬æ¢
    doB(1);         // é”™è¯¯ï¼šè¢« explicit ä¿®é¥°æ„é€ å‡½æ•°çš„å¯¹è±¡ä¸å¯ä»¥ä» int åˆ° B çš„éšå¼è½¬æ¢
    if (b1);        // OKï¼šè¢« explicit ä¿®é¥°è½¬æ¢å‡½æ•° B::operator bool() çš„å¯¹è±¡å¯ä»¥ä» B åˆ° bool çš„æŒ‰è¯­å¢ƒè½¬æ¢
    bool b6(b1);        // OKï¼šè¢« explicit ä¿®é¥°è½¬æ¢å‡½æ•° B::operator bool() çš„å¯¹è±¡å¯ä»¥ä» B åˆ° bool çš„æŒ‰è¯­å¢ƒè½¬æ¢
    bool b7 = b1;       // é”™è¯¯ï¼šè¢« explicit ä¿®é¥°è½¬æ¢å‡½æ•° B::operator bool() çš„å¯¹è±¡ä¸å¯ä»¥éšå¼è½¬æ¢
    bool b8 = static_cast<bool>(b1);  // OKï¼šstatic_cast è¿›è¡Œç›´æ¥åˆå§‹åŒ–

    return 0;
}
```

## `friend` å‹å…ƒç±»å’Œå‹å…ƒå‡½æ•°

* èƒ½è®¿é—®ç§æœ‰æˆå‘˜  
* ç ´åå°è£…æ€§
* å‹å…ƒå…³ç³»ä¸å¯ä¼ é€’
* å‹å…ƒå…³ç³»çš„å•å‘æ€§
* å‹å…ƒå£°æ˜çš„å½¢å¼åŠæ•°é‡ä¸å—é™åˆ¶

## `enum`

### é™å®šä½œç”¨åŸŸçš„æšä¸¾ç±»å‹

```cpp
enum class open_modes { input, output, append };

enum class Size : long long { S = 100, M = 200, L = 300 };
enum class Status : char { OK = '0', Failed = '1' };
enum class State { On = 1, Off = 0, Unknown = -1 };

Size s = Size::M;
Status status = Status::OK;
State state = State::On;
```

### ä¸é™å®šä½œç”¨åŸŸçš„æšä¸¾ç±»å‹

```cpp
enum color { red, yellow, green };
enum { floatPrec = 6, doublePrec = 10 };
```

## `decltype`

decltype å…³é”®å­—ç”¨äºæ£€æŸ¥å®ä½“çš„å£°æ˜ç±»å‹æˆ–è¡¨è¾¾å¼çš„ç±»å‹åŠå€¼åˆ†ç±»ã€‚è¯­æ³•ï¼š

```cpp
decltype ( expression )
```

```cpp
// å°¾ç½®è¿”å›å…è®¸æˆ‘ä»¬åœ¨å‚æ•°åˆ—è¡¨ä¹‹åå£°æ˜è¿”å›ç±»å‹
template <typename It>
auto fcn(It beg, It end) -> decltype(*beg)
{
    // å¤„ç†åºåˆ—
    return *beg;    // è¿”å›åºåˆ—ä¸­ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨
}
// ä¸ºäº†ä½¿ç”¨æ¨¡æ¿å‚æ•°æˆå‘˜ï¼Œå¿…é¡»ç”¨ typename
template <typename It>
auto fcn2(It beg, It end) -> typename remove_reference<decltype(*beg)>::type
{
    // å¤„ç†åºåˆ—
    return *beg;    // è¿”å›åºåˆ—ä¸­ä¸€ä¸ªå…ƒç´ çš„æ‹·è´
}
```

## æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨

å¥½å¤„

* æ›´é«˜æ•ˆï¼šå°‘äº†ä¸€æ¬¡è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°çš„è¿‡ç¨‹ã€‚
* æœ‰äº›åœºåˆå¿…é¡»è¦ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼š
  1. å¸¸é‡æˆå‘˜ï¼Œå› ä¸ºå¸¸é‡åªèƒ½åˆå§‹åŒ–ä¸èƒ½èµ‹å€¼ï¼Œæ‰€ä»¥å¿…é¡»æ”¾åœ¨åˆå§‹åŒ–åˆ—è¡¨é‡Œé¢
  2. å¼•ç”¨ç±»å‹ï¼Œå¼•ç”¨å¿…é¡»åœ¨å®šä¹‰çš„æ—¶å€™åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸èƒ½é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥ä¹Ÿè¦å†™åœ¨åˆå§‹åŒ–åˆ—è¡¨é‡Œé¢
  3. æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°çš„ç±»ç±»å‹ï¼Œå› ä¸ºä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å¯ä»¥ä¸å¿…è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–

### initializer_list åˆ—è¡¨åˆå§‹åŒ–

ç”¨èŠ±æ‹¬å·åˆå§‹åŒ–å™¨åˆ—è¡¨åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­å¯¹åº”æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ª `std::initializer_list` å‚æ•°.

```cpp
#include <iostream>
#include <vector>
#include <initializer_list>
 
template <class T>
struct S {
    std::vector<T> v;
    S(std::initializer_list<T> l) : v(l) {
         std::cout << "constructed with a " << l.size() << "-element list\n";
    }
    void append(std::initializer_list<T> l) {
        v.insert(v.end(), l.begin(), l.end());
    }
    std::pair<const T*, std::size_t> c_arr() const {
        return {&v[0], v.size()};  // åœ¨ return è¯­å¥ä¸­å¤åˆ¶åˆ—è¡¨åˆå§‹åŒ–
                                   // è¿™ä¸ä½¿ç”¨ std::initializer_list
    }
};
 
template <typename T>
void templated_fn(T) {}
 
int main()
{
    S<int> s = {1, 2, 3, 4, 5}; // å¤åˆ¶åˆå§‹åŒ–
    s.append({6, 7, 8});      // å‡½æ•°è°ƒç”¨ä¸­çš„åˆ—è¡¨åˆå§‹åŒ–
 
    std::cout << "The vector size is now " << s.c_arr().second << " ints:\n";
 
    for (auto n : s.v)
        std::cout << n << ' ';
    std::cout << '\n';
 
    std::cout << "Range-for over brace-init-list: \n";
 
    for (int x : {-1, -2, -3}) // auto çš„è§„åˆ™ä»¤æ­¤å¸¦èŒƒå›´ for å·¥ä½œ
        std::cout << x << ' ';
    std::cout << '\n';
 
    auto al = {10, 11, 12};   // auto çš„ç‰¹æ®Šè§„åˆ™
 
    std::cout << "The list bound to auto has size() = " << al.size() << '\n';
 

    templated_fn<std::initializer_list<int>>({1, 2, 3}); // OK
    templated_fn<std::vector<int>>({1, 2, 3});           // ä¹Ÿ OK
}
```

## struct å’Œ class

1. struct æ›´é€‚åˆçœ‹æˆæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„çš„å®ç°ä½“ï¼Œclass æ›´é€‚åˆçœ‹æˆæ˜¯ä¸€ä¸ªå¯¹è±¡çš„å®ç°ä½“ã€‚
2. structçš„é»˜è®¤è®¿é—®æ§åˆ¶æƒé™æ˜¯publicï¼Œè€Œclassçš„é»˜è®¤è®¿é—®æ§åˆ¶æƒé™æ˜¯privateçš„
3. åœ¨ç»§æ‰¿å…³ç³»ä¸­ï¼Œstructé»˜è®¤å…±æœ‰ç»§æ‰¿ï¼Œclassé»˜è®¤ç§æœ‰ç»§æ‰¿
4. classå…³é”®å­—å¯ä»¥ç”¨æ¥å®šä¹‰æ¨¡ç‰ˆå‚æ•°

### c++å’Œcä¸­ç»“æ„ä½“çš„æ¯”è¾ƒ

| |c|c++|
--|--|--
|æˆå‘˜å‡½æ•°|ä¸èƒ½|å¯ä»¥
|é™æ€æˆå‘˜|ä¸èƒ½|å¯ä»¥
|è®¿é—®æ§åˆ¶|é»˜è®¤publicï¼Œä¸èƒ½ä¿®æ”¹|public / private / protected
|ç»§æ‰¿å…³ç³»|ä¸å¯ä»¥ç»§æ‰¿|å¯ä»¥ä»ç±»æˆ–è€…å…¶ä»–ç»“æ„ä½“ç»§æ‰¿
|åˆå§‹åŒ–|ä¸èƒ½ç›´æ¥åˆå§‹åŒ–æ•°æ®æˆå‘˜|å¯ä»¥

## C++ä»ä»£ç åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„è¿‡ç¨‹

>åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼šé¢„ç¼–è¯‘ã€ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ (è£…è½½ã€è¿è¡Œ)

1. é¢„ç¼–è¯‘
   1. å°†æ‰€æœ‰#defineåˆ é™¤ï¼Œå±•å¼€æ‰€æœ‰çš„å®å®šä¹‰
   2. å¤„ç†æ‰€æœ‰çš„æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œ#ifï¼Œ#ifnef
   3. å¤„ç†#includeé¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œ
   4. è¿‡æ»¤æ‰€æœ‰æ³¨é‡Š
   5. æ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯†
2. ç¼–è¯‘
   1. è¯æ³•åˆ†æ
   2. è¯­æ³•åˆ†æ
   3. è¯­ä¹‰åˆ†æ
   4. ä»£ç ä¼˜åŒ–
   5. ç”Ÿæˆæ±‡ç¼–ä»£ç 
3. æ±‡ç¼–
   1. å°†æ±‡ç¼–ä»£ç è½¬å˜ä¸ºå¯æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤
4. é“¾æ¥ï¼šå°†ä¸åŒçš„æºæ–‡ä»¶äº§ç”Ÿçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥ï¼Œå½¢æˆå¯æ‰§è¡Œç¨‹åº

### é™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥

* é™æ€é“¾æ¥ï¼Œæ˜¯åœ¨é“¾æ¥çš„æ—¶å€™å°±å·²ç»æŠŠè¦è°ƒç”¨çš„å‡½æ•°æˆ–è€…è¿‡ç¨‹é“¾æ¥åˆ°äº†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå°±ç®—ä½ åœ¨å»æŠŠé™æ€åº“åˆ é™¤ä¹Ÿä¸ä¼šå½±å“å¯æ‰§è¡Œç¨‹åºçš„æ‰§è¡Œï¼›ç”Ÿæˆçš„é™æ€é“¾æ¥åº“ï¼ŒLinuxä¸‹ä»¥.aä¸ºåç¼€ã€‚

* åŠ¨æ€é“¾æ¥ï¼Œæ˜¯åœ¨é“¾æ¥çš„æ—¶å€™æ²¡æœ‰æŠŠè°ƒç”¨çš„å‡½æ•°ä»£ç é“¾æ¥è¿›å»ï¼Œè€Œæ˜¯åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå†å»æ‰¾è¦é“¾æ¥çš„å‡½æ•°ï¼Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ²¡æœ‰å‡½æ•°ä»£ç ï¼ŒåªåŒ…å«å‡½æ•°çš„é‡å®šä½ä¿¡æ¯ï¼Œæ‰€ä»¥å½“ä½ åˆ é™¤åŠ¨æ€åº“æ—¶ï¼Œå¯æ‰§è¡Œç¨‹åºå°±ä¸èƒ½è¿è¡Œã€‚ç”Ÿæˆçš„åŠ¨æ€é“¾æ¥åº“ï¼ŒLinuxä¸‹ä»¥.soä¸ºåç¼€ã€‚

## ç¨‹åºåˆ†åŒº

>å †åŒºã€æ ˆåŒºã€bssã€textã€data

```c++
char str1[] = "abcd";
char str2[] = "abcd";

const char str3[] = "abcd";
const char str4[] = "abcd";

const char *str5 = "abcd";
const char *str6 = "abcd";

char *str7 = "abcd";
char *str8 = "abcd";


cout << ( str1 == str2 ) << endl;
cout << ( str3 == str4 ) << endl;
//å­˜å‚¨åœ¨æ ˆåŒº
cout << ( str5 == str6 ) << endl;
cout << ( str7 == str8 ) << endl;
//å­˜å‚¨åœ¨é™æ€åŒº
```

|ç±»å‹|ä½œç”¨åŸŸ|ç”Ÿå‘½å‘¨æœŸ|å­˜å‚¨ä½ç½®|
|--|--|--|--|
auto|{  }|å½“å‰å‡½æ•°|æ ˆ
staticå±€éƒ¨|{  }|æ•´ä¸ªç¨‹åº|åˆå§‹åŒ–åœ¨dataï¼Œæœªåˆå§‹åŒ–åœ¨BSS
staticå…¨å±€|å½“å‰æ–‡ä»¶|æ•´ä¸ªç¨‹åº|åˆå§‹åŒ–åœ¨dataï¼Œæœªåˆå§‹åŒ–åœ¨BSS
staticå‡½æ•°|å½“å‰æ–‡ä»¶|æ•´ä¸ªç¨‹åº|ä»£ç åŒº
externå˜é‡|å½“å‰æ–‡ä»¶|æ•´ä¸ªç¨‹åº|åˆå§‹åŒ–åœ¨dataï¼Œæœªåˆå§‹åŒ–åœ¨BSS
externå‡½æ•°|å½“å‰æ–‡ä»¶|æ•´ä¸ªç¨‹åº|ä»£ç åŒº
register|{  }|å½“å‰å‡½æ•°|è¿è¡Œæ—¶å­˜å‚¨åœ¨å¯„å­˜å™¨
å­—ç¬¦ä¸²å¸¸é‡|å½“å‰æ–‡ä»¶|æ•´ä¸ªç¨‹åº|data

## é¢å‘å¯¹è±¡

é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼ˆObject-oriented programmingï¼ŒOOPï¼‰æ˜¯ç§å…·æœ‰å¯¹è±¡æ¦‚å¿µçš„ç¨‹åºç¼–ç¨‹å…¸èŒƒï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§ç¨‹åºå¼€å‘çš„æŠ½è±¡æ–¹é’ˆã€‚

![é¢å‘å¯¹è±¡ç‰¹å¾](https://gitee.com/huihut/interview/raw/master/images/é¢å‘å¯¹è±¡åŸºæœ¬ç‰¹å¾.png)

é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾ â€”â€” å°è£…ã€ç»§æ‰¿ã€å¤šæ€

### å°è£…

æŠŠå®¢è§‚äº‹ç‰©å°è£…æˆæŠ½è±¡çš„ç±»ï¼Œå¹¶ä¸”ç±»å¯ä»¥æŠŠè‡ªå·±çš„æ•°æ®å’Œæ–¹æ³•åªè®©å¯ä¿¡çš„ç±»æˆ–è€…å¯¹è±¡æ“ä½œï¼Œå¯¹ä¸å¯ä¿¡çš„è¿›è¡Œä¿¡æ¯éšè—ã€‚å…³é”®å­—ï¼špublic, protected, privateã€‚ä¸å†™é»˜è®¤ä¸º privateã€‚

* `public` æˆå‘˜ï¼šå¯ä»¥è¢«ä»»æ„å®ä½“è®¿é—®
* `protected` æˆå‘˜ï¼šåªå…è®¸è¢«å­ç±»åŠæœ¬ç±»çš„æˆå‘˜å‡½æ•°è®¿é—®
* `private` æˆå‘˜ï¼šåªå…è®¸è¢«æœ¬ç±»çš„æˆå‘˜å‡½æ•°ã€å‹å…ƒç±»æˆ–å‹å…ƒå‡½æ•°è®¿é—®

### ç»§æ‰¿

* åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰â€”â€”&gt; æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰

### å¤šæ€

* å¤šæ€ï¼Œå³å¤šç§çŠ¶æ€ï¼ˆå½¢æ€ï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šæ€å®šä¹‰ä¸ºæ¶ˆæ¯ä»¥å¤šç§å½¢å¼æ˜¾ç¤ºçš„èƒ½åŠ›ã€‚
* å¤šæ€æ˜¯ä»¥å°è£…å’Œç»§æ‰¿ä¸ºåŸºç¡€çš„ã€‚
* C++ å¤šæ€åˆ†ç±»åŠå®ç°ï¼š
    1. é‡è½½å¤šæ€ï¼ˆAd-hoc Polymorphismï¼Œç¼–è¯‘æœŸï¼‰ï¼šå‡½æ•°é‡è½½ã€è¿ç®—ç¬¦é‡è½½
    2. å­ç±»å‹å¤šæ€ï¼ˆSubtype Polymorphismï¼Œè¿è¡ŒæœŸï¼‰ï¼šè™šå‡½æ•°
    3. å‚æ•°å¤šæ€æ€§ï¼ˆParametric Polymorphismï¼Œç¼–è¯‘æœŸï¼‰ï¼šç±»æ¨¡æ¿ã€å‡½æ•°æ¨¡æ¿
    4. å¼ºåˆ¶å¤šæ€ï¼ˆCoercion Polymorphismï¼Œç¼–è¯‘æœŸ/è¿è¡ŒæœŸï¼‰ï¼šåŸºæœ¬ç±»å‹è½¬æ¢ã€è‡ªå®šä¹‰ç±»å‹è½¬æ¢

> [The Four Polymorphisms in C++](https://catonmat.net/cpp-polymorphism)

#### é™æ€å¤šæ€ï¼ˆç¼–è¯‘æœŸ/æ—©ç»‘å®šï¼‰

å‡½æ•°é‡è½½

```cpp
class A
{
public:
    void do(int a);
    void do(int a, int b);
};
```

æ“ä½œç¬¦é‡è½½

> ç±»å‹å¼ºè½¬è¿ç®—ç¬¦ `operator target_type() const;`

```c++
#include <iostream>

class MyInt {
public:
    // æ„é€ å‡½æ•°
    MyInt(int value) : m_value(value) {}

    // ç±»å‹è½¬æ¢è¿ç®—ç¬¦
    operator int() const {
        return m_value;
    }

private:
    int m_value;
};

int main() {
    MyInt myInt(123);
    int x = myInt;  // ç›¸å½“äº int x = myInt.operator int();
    std::cout << "x = " << x << std::endl;

    return 0;
}
```

#### åŠ¨æ€å¤šæ€ï¼ˆè¿è¡ŒæœŸæœŸ/æ™šç»‘å®šï¼‰

* è™šå‡½æ•°ï¼šç”¨ virtual ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œä½¿å…¶æˆä¸ºè™šå‡½æ•°
* åŠ¨æ€ç»‘å®šï¼šå½“ä½¿ç”¨åŸºç±»çš„å¼•ç”¨æˆ–æŒ‡é’ˆè°ƒç”¨ä¸€ä¸ªè™šå‡½æ•°æ—¶å°†å‘ç”ŸåŠ¨æ€ç»‘å®š

**æ³¨æ„ï¼š**

* å¯ä»¥å°†æ´¾ç”Ÿç±»çš„å¯¹è±¡èµ‹å€¼ç»™åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œåä¹‹ä¸å¯
* æ™®é€šå‡½æ•°ï¼ˆéç±»æˆå‘˜å‡½æ•°ï¼‰ä¸èƒ½æ˜¯è™šå‡½æ•°
* é™æ€å‡½æ•°ï¼ˆstaticï¼‰ä¸èƒ½æ˜¯è™šå‡½æ•°
* æ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°ï¼ˆå› ä¸ºåœ¨è°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œè™šè¡¨æŒ‡é’ˆå¹¶æ²¡æœ‰åœ¨å¯¹è±¡çš„å†…å­˜ç©ºé—´ä¸­ï¼Œå¿…é¡»è¦æ„é€ å‡½æ•°è°ƒç”¨å®Œæˆåæ‰ä¼šå½¢æˆè™šè¡¨æŒ‡é’ˆï¼‰
* å†…è”å‡½æ•°ä¸èƒ½æ˜¯è¡¨ç°å¤šæ€æ€§æ—¶çš„è™šå‡½æ•°ï¼Œè§£é‡Šè§ï¼š[è™šå‡½æ•°ï¼ˆvirtualï¼‰å¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼ˆinlineï¼‰å—ï¼Ÿ](https://github.com/huihut/interview#%E8%99%9A%E5%87%BD%E6%95%B0virtual%E5%8F%AF%E4%BB%A5%E6%98%AF%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0inline%E5%90%97)

### C å®ç° C++ ç±»

C å®ç° C++ çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼ˆå°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼‰

* å°è£…ï¼šä½¿ç”¨å‡½æ•°æŒ‡é’ˆæŠŠå±æ€§ä¸æ–¹æ³•å°è£…åˆ°ç»“æ„ä½“ä¸­
* ç»§æ‰¿ï¼šç»“æ„ä½“åµŒå¥—
* å¤šæ€ï¼šçˆ¶ç±»ä¸å­ç±»æ–¹æ³•çš„å‡½æ•°æŒ‡é’ˆä¸åŒ

> [Cè¯­è¨€å®ç°é¢å‘å¯¹è±¡](https://zhuanlan.zhihu.com/p/566782733)

### è™šææ„å‡½æ•°

è™šææ„å‡½æ•°æ˜¯ä¸€ä¸ªåœ¨åŸºç±»ä¸­å£°æ˜ä¸ºè™šå‡½æ•°çš„ææ„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯å½“ä½¿ç”¨åŸºç±»çš„æŒ‡é’ˆåˆ é™¤æ´¾ç”Ÿç±»çš„å¯¹è±¡æ—¶ï¼Œèƒ½å¤Ÿæ­£ç¡®åœ°è°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼æˆ–è€…èµ„æºæ²¡æœ‰è¢«æ­£ç¡®é‡Šæ”¾çš„é—®é¢˜ã€‚

é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰è™šææ„å‡½æ•°ï¼Œåœ¨ä½¿ç”¨åŸºç±»æŒ‡é’ˆåˆ é™¤æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œåªä¼šè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œè€Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œå¯¼è‡´æ´¾ç”Ÿç±»çš„èµ„æºæ²¡æœ‰è¢«é‡Šæ”¾ã€‚è¿™å°±æ˜¯è™šææ„å‡½æ•°å­˜åœ¨çš„æ„ä¹‰ã€‚

```cpp
class Shape
{
public:
    Shape();                    // æ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°
    virtual double calcArea();
    virtual ~Shape();           // è™šææ„å‡½æ•°
};
class Circle : public Shape     // åœ†å½¢ç±»
{
public:
    virtual double calcArea();
    ...
};
int main()
{
    Shape * shape1 = new Circle(4.0);
    shape1->calcArea();    
    delete shape1;  // å› ä¸ºShapeæœ‰è™šææ„å‡½æ•°ï¼Œæ‰€ä»¥deleteé‡Šæ”¾å†…å­˜æ—¶ï¼Œå…ˆè°ƒç”¨å­ç±»ææ„å‡½æ•°ï¼Œå†è°ƒç”¨åŸºç±»ææ„å‡½æ•°ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚
    shape1 = NULL;
    return 0ï¼›
}
```

### çº¯è™šå‡½æ•°

çº¯è™šå‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„è™šå‡½æ•°ï¼Œåœ¨åŸºç±»ä¸­ä¸èƒ½å¯¹è™šå‡½æ•°ç»™å‡ºæœ‰æ„ä¹‰çš„å®ç°ï¼Œè€ŒæŠŠå®ƒå£°æ˜ä¸ºçº¯è™šå‡½æ•°ï¼Œå®ƒçš„å®ç°ç•™ç»™è¯¥åŸºç±»çš„æ´¾ç”Ÿç±»å»åšã€‚

```cpp
virtual int A() = 0;
```

#### è™šå‡½æ•°ã€çº¯è™šå‡½æ•°

* ç±»é‡Œå¦‚æœå£°æ˜äº†è™šå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å®ç°çš„ï¼Œå“ªæ€•æ˜¯ç©ºå®ç°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½è®©è¿™ä¸ªå‡½æ•°åœ¨å®ƒçš„å­ç±»é‡Œé¢å¯ä»¥è¢«è¦†ç›–ï¼ˆoverrideï¼‰ï¼Œè¿™æ ·çš„è¯ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥ä½¿ç”¨åæœŸç»‘å®šæ¥è¾¾åˆ°å¤šæ€äº†ã€‚çº¯è™šå‡½æ•°åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ˜¯ä¸ªå‡½æ•°çš„å£°æ˜è€Œå·²ï¼Œå®ƒè¦ç•™åˆ°å­ç±»é‡Œå»å®ç°ã€‚
* è™šå‡½æ•°åœ¨å­ç±»é‡Œé¢å¯ä»¥ä¸é‡å†™ï¼›ä½†çº¯è™šå‡½æ•°å¿…é¡»åœ¨å­ç±»å®ç°æ‰å¯ä»¥å®ä¾‹åŒ–å­ç±»ã€‚
* è™šå‡½æ•°çš„ç±»ç”¨äº â€œå®ä½œç»§æ‰¿â€ï¼Œç»§æ‰¿æ¥å£çš„åŒæ—¶ä¹Ÿç»§æ‰¿äº†çˆ¶ç±»çš„å®ç°ã€‚çº¯è™šå‡½æ•°å…³æ³¨çš„æ˜¯æ¥å£çš„ç»Ÿä¸€æ€§ï¼Œå®ç°ç”±å­ç±»å®Œæˆã€‚
* å¸¦çº¯è™šå‡½æ•°çš„ç±»å«æŠ½è±¡ç±»ï¼Œè¿™ç§ç±»ä¸èƒ½ç›´æ¥ç”Ÿæˆå¯¹è±¡ï¼Œè€Œåªæœ‰è¢«ç»§æ‰¿ï¼Œå¹¶é‡å†™å…¶è™šå‡½æ•°åï¼Œæ‰èƒ½ä½¿ç”¨ã€‚æŠ½è±¡ç±»è¢«ç»§æ‰¿åï¼Œå­ç±»å¯ä»¥ç»§ç»­æ˜¯æŠ½è±¡ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šç±»ã€‚
* è™šåŸºç±»æ˜¯è™šç»§æ‰¿ä¸­çš„åŸºç±»ï¼Œå…·ä½“è§ä¸‹æ–‡è™šç»§æ‰¿ã€‚

> [CSDN . C++ ä¸­çš„è™šå‡½æ•°ã€çº¯è™šå‡½æ•°åŒºåˆ«å’Œè”ç³»](https://blog.csdn.net/u012260238/article/details/53610462)

#### è™šå‡½æ•°æŒ‡é’ˆã€è™šå‡½æ•°è¡¨

* è™šå‡½æ•°æŒ‡é’ˆï¼šåœ¨å«æœ‰è™šå‡½æ•°ç±»çš„å¯¹è±¡ä¸­ï¼ŒæŒ‡å‘è™šå‡½æ•°è¡¨ï¼Œåœ¨è¿è¡Œæ—¶ç¡®å®šã€‚
* è™šå‡½æ•°è¡¨ï¼šåœ¨ç¨‹åºåªè¯»æ•°æ®æ®µï¼ˆ`.rodata section`ï¼Œè§ï¼š[ç›®æ ‡æ–‡ä»¶å­˜å‚¨ç»“æ„](#%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84)ï¼‰ï¼Œå­˜æ”¾è™šå‡½æ•°æŒ‡é’ˆï¼Œå¦‚æœæ´¾ç”Ÿç±»å®ç°äº†åŸºç±»çš„æŸä¸ªè™šå‡½æ•°ï¼Œåˆ™åœ¨è™šè¡¨ä¸­è¦†ç›–åŸæœ¬åŸºç±»çš„é‚£ä¸ªè™šå‡½æ•°æŒ‡é’ˆï¼Œåœ¨ç¼–è¯‘æ—¶æ ¹æ®ç±»çš„å£°æ˜åˆ›å»ºã€‚

> [C++ä¸­çš„è™šå‡½æ•°(è¡¨)å®ç°æœºåˆ¶ä»¥åŠç”¨Cè¯­è¨€å¯¹å…¶è¿›è¡Œçš„æ¨¡æ‹Ÿå®ç°](https://blog.twofei.com/496/)

### è™šç»§æ‰¿

è™šç»§æ‰¿ç”¨äºè§£å†³å¤šç»§æ‰¿æ¡ä»¶ä¸‹çš„è±å½¢ç»§æ‰¿é—®é¢˜ï¼ˆæµªè´¹å­˜å‚¨ç©ºé—´ã€å­˜åœ¨äºŒä¹‰æ€§ï¼‰ã€‚

åº•å±‚å®ç°åŸç†ä¸ç¼–è¯‘å™¨ç›¸å…³ï¼Œä¸€èˆ¬é€šè¿‡**è™šåŸºç±»æŒ‡é’ˆ**å’Œ**è™šåŸºç±»è¡¨**å®ç°ï¼Œæ¯ä¸ªè™šç»§æ‰¿çš„å­ç±»éƒ½æœ‰ä¸€ä¸ªè™šåŸºç±»æŒ‡é’ˆï¼ˆå ç”¨ä¸€ä¸ªæŒ‡é’ˆçš„å­˜å‚¨ç©ºé—´ï¼Œ4å­—èŠ‚ï¼‰å’Œè™šåŸºç±»è¡¨ï¼ˆä¸å ç”¨ç±»å¯¹è±¡çš„å­˜å‚¨ç©ºé—´ï¼‰ï¼ˆéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œè™šåŸºç±»ä¾æ—§ä¼šåœ¨å­ç±»é‡Œé¢å­˜åœ¨æ‹·è´ï¼Œåªæ˜¯ä»…ä»…æœ€å¤šå­˜åœ¨ä¸€ä»½è€Œå·²ï¼Œå¹¶ä¸æ˜¯ä¸åœ¨å­ç±»é‡Œé¢äº†ï¼‰ï¼›å½“è™šç»§æ‰¿çš„å­ç±»è¢«å½“åšçˆ¶ç±»ç»§æ‰¿æ—¶ï¼Œè™šåŸºç±»æŒ‡é’ˆä¹Ÿä¼šè¢«ç»§æ‰¿ã€‚

å®é™…ä¸Šï¼Œvbptr æŒ‡çš„æ˜¯è™šåŸºç±»è¡¨æŒ‡é’ˆï¼ˆvirtual base table pointerï¼‰ï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘äº†ä¸€ä¸ªè™šåŸºç±»è¡¨ï¼ˆvirtual tableï¼‰ï¼Œè™šè¡¨ä¸­è®°å½•äº†è™šåŸºç±»ä¸æœ¬ç±»çš„åç§»åœ°å€ï¼›é€šè¿‡åç§»åœ°å€ï¼Œè¿™æ ·å°±æ‰¾åˆ°äº†è™šåŸºç±»æˆå‘˜ï¼Œè€Œè™šç»§æ‰¿ä¹Ÿä¸ç”¨åƒæ™®é€šå¤šç»§æ‰¿é‚£æ ·ç»´æŒç€å…¬å…±åŸºç±»ï¼ˆè™šåŸºç±»ï¼‰çš„ä¸¤ä»½åŒæ ·çš„æ‹·è´ï¼ŒèŠ‚çœäº†å­˜å‚¨ç©ºé—´ã€‚

#### è™šç»§æ‰¿ã€è™šå‡½æ•°

* ç›¸åŒä¹‹å¤„ï¼šéƒ½åˆ©ç”¨äº†è™šæŒ‡é’ˆï¼ˆå‡å ç”¨ç±»çš„å­˜å‚¨ç©ºé—´ï¼‰å’Œè™šè¡¨ï¼ˆå‡ä¸å ç”¨ç±»çš„å­˜å‚¨ç©ºé—´ï¼‰
* ä¸åŒä¹‹å¤„ï¼š
  * è™šç»§æ‰¿
    * è™šåŸºç±»ä¾æ—§å­˜åœ¨ç»§æ‰¿ç±»ä¸­ï¼Œåªå ç”¨å­˜å‚¨ç©ºé—´
    * è™šåŸºç±»è¡¨å­˜å‚¨çš„æ˜¯è™šåŸºç±»ç›¸å¯¹ç›´æ¥ç»§æ‰¿ç±»çš„åç§»
  * è™šå‡½æ•°
    * è™šå‡½æ•°ä¸å ç”¨å­˜å‚¨ç©ºé—´
    * è™šå‡½æ•°è¡¨å­˜å‚¨çš„æ˜¯è™šå‡½æ•°åœ°å€

#### æ¨¡æ¿ç±»ã€æˆå‘˜æ¨¡æ¿ã€è™šå‡½æ•°

* æ¨¡æ¿ç±»ä¸­å¯ä»¥ä½¿ç”¨è™šå‡½æ•°
* ä¸€ä¸ªç±»ï¼ˆæ— è®ºæ˜¯æ™®é€šç±»è¿˜æ˜¯ç±»æ¨¡æ¿ï¼‰çš„æˆå‘˜æ¨¡æ¿ï¼ˆæœ¬èº«æ˜¯æ¨¡æ¿çš„æˆå‘˜å‡½æ•°ï¼‰ä¸èƒ½æ˜¯è™šå‡½æ•°

#### æŠ½è±¡ç±»ã€æ¥å£ç±»ã€èšåˆç±»

* æŠ½è±¡ç±»ï¼šå«æœ‰çº¯è™šå‡½æ•°çš„ç±»
* æ¥å£ç±»ï¼šä»…å«æœ‰çº¯è™šå‡½æ•°çš„æŠ½è±¡ç±»
* èšåˆç±»ï¼šç”¨æˆ·å¯ä»¥ç›´æ¥è®¿é—®å…¶æˆå‘˜ï¼Œå¹¶ä¸”å…·æœ‰ç‰¹æ®Šçš„åˆå§‹åŒ–è¯­æ³•å½¢å¼ã€‚æ»¡è¶³å¦‚ä¸‹ç‰¹ç‚¹ï¼š
  * æ‰€æœ‰æˆå‘˜éƒ½æ˜¯ public
  * æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°
  * æ²¡æœ‰ç±»å†…åˆå§‹åŒ–
  * æ²¡æœ‰åŸºç±»ï¼Œä¹Ÿæ²¡æœ‰ virtual å‡½æ•°

## å†…å­˜åˆ†é…å’Œç®¡ç†

### mallocã€callocã€reallocã€alloca

* mallocï¼šç”³è¯·æŒ‡å®šå­—èŠ‚æ•°çš„å†…å­˜ã€‚ç”³è¯·åˆ°çš„å†…å­˜ä¸­çš„åˆå§‹å€¼ä¸ç¡®å®šã€‚
* callocï¼šä¸ºæŒ‡å®šé•¿åº¦çš„å¯¹è±¡ï¼Œåˆ†é…èƒ½å®¹çº³å…¶æŒ‡å®šä¸ªæ•°çš„å†…å­˜ã€‚ç”³è¯·åˆ°çš„å†…å­˜çš„æ¯ä¸€ä½éƒ½åˆå§‹åŒ–ä¸º 0ã€‚

    ```c++
    void* calloc(size_t nmemb, size_t size); //å‡½æ•°åŸå‹
    ```

* reallocï¼šæ›´æ”¹ä»¥å‰åˆ†é…çš„å†…å­˜é•¿åº¦ï¼ˆå¢åŠ æˆ–å‡å°‘ï¼‰ã€‚å½“å¢åŠ é•¿åº¦æ—¶ï¼Œå¯èƒ½éœ€å°†ä»¥å‰åˆ†é…åŒºçš„å†…å®¹ç§»åˆ°å¦ä¸€ä¸ªè¶³å¤Ÿå¤§çš„åŒºåŸŸï¼Œè€Œæ–°å¢åŒºåŸŸå†…çš„åˆå§‹å€¼åˆ™ä¸ç¡®å®šã€‚

    ```c++
    void* realloc(void* ptr, size_t size);
    ```

* allocaï¼šåœ¨æ ˆä¸Šç”³è¯·å†…å­˜ã€‚ç¨‹åºåœ¨å‡ºæ ˆçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œalloca ä¸å…·å¯ç§»æ¤æ€§, è€Œä¸”åœ¨æ²¡æœ‰ä¼ ç»Ÿå †æ ˆçš„æœºå™¨ä¸Šå¾ˆéš¾å®ç°ã€‚alloca ä¸å®œä½¿ç”¨åœ¨å¿…é¡»å¹¿æ³›ç§»æ¤çš„ç¨‹åºä¸­ã€‚C99 ä¸­æ”¯æŒå˜é•¿æ•°ç»„ (VLA)ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£ allocaã€‚

### mallocã€free

ç”¨äºåˆ†é…ã€é‡Šæ”¾å†…å­˜

mallocã€free ä½¿ç”¨

ç”³è¯·å†…å­˜ï¼Œç¡®è®¤æ˜¯å¦ç”³è¯·æˆåŠŸ

```cpp
char *str = (char*) malloc(100);
assert(str != nullptr);
```

é‡Šæ”¾å†…å­˜åæŒ‡é’ˆç½®ç©º

```cpp
free(p); 
p = nullptr;
```

### newã€delete

1. new / new[]ï¼šå®Œæˆä¸¤ä»¶äº‹ï¼Œå…ˆåº•å±‚è°ƒç”¨ malloc åˆ†é…äº†å†…å­˜ï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°ï¼ˆåˆ›å»ºå¯¹è±¡ï¼‰ã€‚
2. delete/delete[]ï¼šä¹Ÿå®Œæˆä¸¤ä»¶äº‹ï¼Œå…ˆè°ƒç”¨ææ„å‡½æ•°ï¼ˆæ¸…ç†èµ„æºï¼‰ï¼Œç„¶ååº•å±‚è°ƒç”¨ free é‡Šæ”¾ç©ºé—´ã€‚
3. new åœ¨ç”³è¯·å†…å­˜æ—¶ä¼šè‡ªåŠ¨è®¡ç®—æ‰€éœ€å­—èŠ‚æ•°ï¼Œè€Œ malloc åˆ™éœ€æˆ‘ä»¬è‡ªå·±è¾“å…¥ç”³è¯·å†…å­˜ç©ºé—´çš„å­—èŠ‚æ•°ã€‚

newã€delete ä½¿ç”¨

ç”³è¯·å†…å­˜ï¼Œç¡®è®¤æ˜¯å¦ç”³è¯·æˆåŠŸ

```cpp
int main()
{
    T* t = new T();     // å…ˆå†…å­˜åˆ†é… ï¼Œå†æ„é€ å‡½æ•°
    delete t;           // å…ˆææ„å‡½æ•°ï¼Œå†å†…å­˜é‡Šæ”¾
    return 0;
}
```

### placement new

`placement new`å…è®¸æˆ‘ä»¬å‘ new ä¼ é€’é¢å¤–çš„åœ°å€å‚æ•°ï¼Œä»è€Œåœ¨é¢„å…ˆæŒ‡å®šçš„å†…å­˜åŒºåŸŸåˆ›å»ºå¯¹è±¡ã€‚

```cpp
new (place_address) type
new (place_address) type (initializers)
new (place_address) type [size]
new (place_address) type [size] { braced initializer list }
```

* `place_address` æ˜¯ä¸ªæŒ‡é’ˆ
* `initializers` æä¾›ä¸€ä¸ªï¼ˆå¯èƒ½ä¸ºç©ºçš„ï¼‰ä»¥é€—å·åˆ†éš”çš„åˆå§‹å€¼åˆ—è¡¨

### new & malloçš„åŒºåˆ«

1. newæ˜¯æ“ä½œç¬¦ï¼Œè€Œmallocæ˜¯å‡½æ•°ã€‚
2. newåœ¨è°ƒç”¨çš„æ—¶å€™å…ˆåˆ†é…å†…å­˜ï¼Œåœ¨è°ƒç”¨æ„é€ å‡½æ•°ï¼Œé‡Šæ”¾çš„æ—¶å€™è°ƒç”¨ææ„å‡½æ•°ï¼›è€Œmallocæ²¡æœ‰æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ã€‚
3. mallocéœ€è¦ç»™å®šç”³è¯·å†…å­˜çš„å¤§å°ï¼Œè¿”å›çš„æŒ‡é’ˆéœ€è¦å¼ºè½¬ï¼›newä¼šè°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¸ç”¨æŒ‡å®šå†…å­˜çš„å¤§å°ï¼Œè¿”å›æŒ‡é’ˆä¸ç”¨å¼ºè½¬ã€‚
4. newå¯ä»¥è¢«é‡è½½ï¼›mallocä¸è¡Œ
5. newåˆ†é…å†…å­˜æ›´ç›´æ¥å’Œå®‰å…¨ã€‚
6. newå‘ç”Ÿé”™è¯¯æŠ›å‡ºå¼‚å¸¸ï¼Œmallocè¿”å›null

### mallocåº•å±‚å®ç°

### newåº•å±‚å®ç°

### å†…å­˜æ³„æ¼

> ç®€å•æ¥è¯´å°±æ˜¯ç”³è¯·äº†ä¸€å—å†…å­˜ç©ºé—´ï¼Œä½¿ç”¨å®Œæ¯•åæ²¡æœ‰é‡Šæ”¾æ‰

* newå’Œmallocç”³è¯·èµ„æºåæ²¡æœ‰ä½¿ç”¨deleteå’Œfree
* å­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œçˆ¶ç±»ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°

### delete this åˆæ³•å—ï¼Ÿ

> [Is it legal (and moral) for a member function to say delete this?](https://isocpp.org/wiki/faq/freestore-mgmt#delete-this)

åˆæ³•ï¼Œä½†ï¼š

1. å¿…é¡»ä¿è¯ this å¯¹è±¡æ˜¯é€šè¿‡ `new`ï¼ˆä¸æ˜¯ `new[]`ã€ä¸æ˜¯ placement newã€ä¸æ˜¯æ ˆä¸Šã€ä¸æ˜¯å…¨å±€ã€ä¸æ˜¯å…¶ä»–å¯¹è±¡æˆå‘˜ï¼‰åˆ†é…çš„
2. å¿…é¡»ä¿è¯è°ƒç”¨ `delete this` çš„æˆå‘˜å‡½æ•°æ˜¯æœ€åä¸€ä¸ªè°ƒç”¨ this çš„æˆå‘˜å‡½æ•°
3. å¿…é¡»ä¿è¯æˆå‘˜å‡½æ•°çš„ `delete this` åé¢æ²¡æœ‰è°ƒç”¨ this äº†
4. å¿…é¡»ä¿è¯ `delete this` åæ²¡æœ‰äººä½¿ç”¨äº†

### å¦‚ä½•å®šä¹‰ä¸€ä¸ªåªèƒ½åœ¨å †ä¸Šï¼ˆæ ˆä¸Šï¼‰ç”Ÿæˆå¯¹è±¡çš„ç±»ï¼Ÿ

> [å¦‚ä½•å®šä¹‰ä¸€ä¸ªåªèƒ½åœ¨å †ä¸Šï¼ˆæ ˆä¸Šï¼‰ç”Ÿæˆå¯¹è±¡çš„ç±»?](https://www.nowcoder.com/questionTerminal/0a584aa13f804f3ea72b442a065a7618)

#### åªèƒ½åœ¨å †ä¸Š

æ–¹æ³•ï¼šå°†ææ„å‡½æ•°è®¾ç½®ä¸ºç§æœ‰

åŸå› ï¼šC++ æ˜¯é™æ€ç»‘å®šè¯­è¨€ï¼Œç¼–è¯‘å™¨ç®¡ç†æ ˆä¸Šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç¼–è¯‘å™¨åœ¨ä¸ºç±»å¯¹è±¡åˆ†é…æ ˆç©ºé—´æ—¶ï¼Œä¼šå…ˆæ£€æŸ¥ç±»çš„ææ„å‡½æ•°çš„è®¿é—®æ€§ã€‚è‹¥ææ„å‡½æ•°ä¸å¯è®¿é—®ï¼Œåˆ™ä¸èƒ½åœ¨æ ˆä¸Šåˆ›å»ºå¯¹è±¡ã€‚

#### åªèƒ½åœ¨æ ˆä¸Š

æ–¹æ³•ï¼šå°† new å’Œ delete é‡è½½ä¸ºç§æœ‰

åŸå› ï¼šåœ¨å †ä¸Šç”Ÿæˆå¯¹è±¡ï¼Œä½¿ç”¨ new å…³é”®è¯æ“ä½œï¼Œå…¶è¿‡ç¨‹åˆ†ä¸ºä¸¤é˜¶æ®µï¼šç¬¬ä¸€é˜¶æ®µï¼Œä½¿ç”¨ new åœ¨å †ä¸Šå¯»æ‰¾å¯ç”¨å†…å­˜ï¼Œåˆ†é…ç»™å¯¹è±¡ï¼›ç¬¬äºŒé˜¶æ®µï¼Œè°ƒç”¨æ„é€ å‡½æ•°ç”Ÿæˆå¯¹è±¡ã€‚å°† new æ“ä½œè®¾ç½®ä¸ºç§æœ‰ï¼Œé‚£ä¹ˆç¬¬ä¸€é˜¶æ®µå°±æ— æ³•å®Œæˆï¼Œå°±ä¸èƒ½å¤Ÿåœ¨å †ä¸Šç”Ÿæˆå¯¹è±¡ã€‚

## æ™ºèƒ½æŒ‡é’ˆ

### C++ 98

```cpp
std::auto_ptr<std::string> ps (new std::string(str))ï¼›
```

### C++ 11

* shared_ptr
  
    shared_ptr å®ç°å…±äº«å¼æ‹¥æœ‰æ¦‚å¿µã€‚å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆæŒ‡å‘ç›¸åŒå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å’Œå…¶ç›¸å…³èµ„æºä¼šåœ¨ â€œæœ€åä¸€ä¸ª reference è¢«é”€æ¯â€ æ—¶è¢«é‡Šæ”¾ã€‚ä¸ºäº†åœ¨ç»“æ„è¾ƒå¤æ‚çš„æƒ…æ™¯ä¸­æ‰§è¡Œä¸Šè¿°å·¥ä½œï¼Œæ ‡å‡†åº“æä¾› weak_ptrã€bad_weak_ptr å’Œ enable_shared_from_this ç­‰è¾…åŠ©ç±»ã€‚
    >[shared_ptrå®ç°](/STL/code/shared_ptr.cpp)
* unique_ptr
  
    unique_ptr å®ç°ç‹¬å å¼æ‹¥æœ‰æˆ–ä¸¥æ ¼æ‹¥æœ‰æ¦‚å¿µï¼Œä¿è¯åŒä¸€æ—¶é—´å†…åªæœ‰ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆå¯ä»¥æŒ‡å‘è¯¥å¯¹è±¡ã€‚ä½ å¯ä»¥ç§»äº¤æ‹¥æœ‰æƒã€‚å®ƒå¯¹äºé¿å…å†…å­˜æ³„æ¼ ( å¦‚ new åå¿˜è®° delete ) ç‰¹åˆ«æœ‰ç”¨ã€‚
    >[unique_ptrå®ç°](/STL/code/unqiue_ptr.cpp)
* weak_ptr

    weak_ptr å…è®¸ä½ å…±äº«ä½†ä¸æ‹¥æœ‰æŸå¯¹è±¡ï¼Œä¸€æ—¦æœ€æœ«ä¸€ä¸ªæ‹¥æœ‰è¯¥å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆå¤±å»äº†æ‰€æœ‰æƒï¼Œä»»ä½• weak_ptr éƒ½ä¼šè‡ªåŠ¨æˆç©ºï¼ˆemptyï¼‰ã€‚å› æ­¤ï¼Œåœ¨ default å’Œ copy æ„é€ å‡½æ•°ä¹‹å¤–ï¼Œweak_ptr åªæä¾› â€œæ¥å—ä¸€ä¸ª shared_ptrâ€ çš„æ„é€ å‡½æ•°ã€‚

  * å¯æ‰“ç ´ç¯çŠ¶å¼•ç”¨ï¼ˆcycles of referencesï¼Œä¸¤ä¸ªå…¶å®å·²ç»æ²¡æœ‰è¢«ä½¿ç”¨çš„å¯¹è±¡å½¼æ­¤äº’æŒ‡ï¼Œä½¿ä¹‹çœ‹ä¼¼è¿˜åœ¨ â€œè¢«ä½¿ç”¨â€ çš„çŠ¶æ€ï¼‰çš„é—®é¢˜

## å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦

> [MSDN . å¼ºåˆ¶è½¬æ¢è¿ç®—ç¬¦](https://msdn.microsoft.com/zh-CN/library/5f6c9f8h.aspx)

### static_cast

* ç”¨äºéå¤šæ€ç±»å‹çš„è½¬æ¢
* ä¸æ‰§è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼ˆè½¬æ¢å®‰å…¨æ€§ä¸å¦‚ dynamic_castï¼‰
* é€šå¸¸ç”¨äºè½¬æ¢æ•°å€¼æ•°æ®ç±»å‹ï¼ˆå¦‚ float -> intï¼‰
* å¯ä»¥åœ¨æ•´ä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­ç§»åŠ¨æŒ‡é’ˆï¼Œå­ç±»è½¬åŒ–ä¸ºçˆ¶ç±»å®‰å…¨ï¼ˆå‘ä¸Šè½¬æ¢ï¼‰ï¼Œçˆ¶ç±»è½¬åŒ–ä¸ºå­ç±»ä¸å®‰å…¨ï¼ˆå› ä¸ºå­ç±»å¯èƒ½æœ‰ä¸åœ¨çˆ¶ç±»çš„å­—æ®µæˆ–æ–¹æ³•ï¼‰

```c++
// å°† double è½¬æ¢ä¸º int
double d = 3.14;
int i = static_cast<int>(d);

// å°† char* è½¬æ¢ä¸º void*
char str[] = "Hello world!";
void* p = static_cast<void*>(&str[0]);

// å°† int* è½¬æ¢ä¸º char*
int arr[] = { 1, 2, 3 };
char* pch = static_cast<char*>(static_cast<void*>(&arr[0]));
```

> å‘ä¸Šè½¬æ¢æ˜¯ä¸€ç§éšå¼è½¬æ¢ã€‚

### dynamic_cast

* ç”¨äºå¤šæ€ç±»å‹çš„è½¬æ¢
* æ‰§è¡Œè¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥
* åªé€‚ç”¨äºæŒ‡é’ˆæˆ–å¼•ç”¨
* å¯¹ä¸æ˜ç¡®çš„æŒ‡é’ˆçš„è½¬æ¢å°†å¤±è´¥ï¼ˆè¿”å› nullptrï¼‰ï¼Œä½†ä¸å¼•å‘å¼‚å¸¸
* å¯ä»¥åœ¨æ•´ä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­ç§»åŠ¨æŒ‡é’ˆï¼ŒåŒ…æ‹¬å‘ä¸Šè½¬æ¢ã€å‘ä¸‹è½¬æ¢

```c++
// å°†åŸºç±»æŒ‡é’ˆè½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆ
class Animal {
public:
    virtual void speak() {}
};
class Dog : public Animal {
public:
    void speak() { cout << "Woof!" << endl; }
};
class Cat : public Animal {
public:
    void speak() { cout << "Meow!" << endl; }
};

Animal* ptr = new Dog;
Dog* dog = dynamic_cast<Dog*>(ptr); // å°† Animal* è½¬æ¢ä¸º Dog*

// å°†åŸºç±»å¼•ç”¨è½¬æ¢ä¸ºæ´¾ç”Ÿç±»å¼•ç”¨
Animal& obj = *ptr;
Dog& d = dynamic_cast<Dog&>(obj);

// å°†åŸºç±»æŒ‡é’ˆè½¬æ¢ä¸ºæ— å…³ç±»æŒ‡é’ˆ
class Shape {
public:
    virtual void draw() {}
};
class Circle : public Shape {
public:
    void draw() { cout << "Draw a circle" << endl; }
};

Shape* sptr = new Circle;
int* iptr = dynamic_cast<int*>(sptr); // è¿”å›ç©ºæŒ‡é’ˆ
```

### const_cast

* ç”¨äºåˆ é™¤ constã€volatile å’Œ __unaligned ç‰¹æ€§ï¼ˆå¦‚å°† const int ç±»å‹è½¬æ¢ä¸º int ç±»å‹ ï¼‰

```c++
// å°† const int* è½¬æ¢ä¸º int*
const int val = 123;
const int* p = &val;
int* ptr = const_cast<int*>(p);

// å°† const char* è½¬æ¢ä¸º char*
const char str[] = "Hello world!";
const char* pstr = str;
char* ch = const_cast<char*>(pstr);
*ch = 'h'; // ä¿®æ”¹å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦
cout << str << endl; // è¾“å‡º "hello world!"
```

### reinterpret_cast

* ç”¨äºä½çš„ç®€å•é‡æ–°è§£é‡Š
* æ»¥ç”¨ reinterpret_cast è¿ç®—ç¬¦å¯èƒ½å¾ˆå®¹æ˜“å¸¦æ¥é£é™©ã€‚ é™¤éæ‰€éœ€è½¬æ¢æœ¬èº«æ˜¯ä½çº§åˆ«çš„ï¼Œå¦åˆ™åº”ä½¿ç”¨å…¶ä»–å¼ºåˆ¶è½¬æ¢è¿ç®—ç¬¦ä¹‹ä¸€ã€‚
* å…è®¸å°†ä»»ä½•æŒ‡é’ˆè½¬æ¢ä¸ºä»»ä½•å…¶ä»–æŒ‡é’ˆç±»å‹ï¼ˆå¦‚ `char*` åˆ° `int*` æˆ– `One_class*` åˆ° `Unrelated_class*` ä¹‹ç±»çš„è½¬æ¢ï¼Œä½†å…¶æœ¬èº«å¹¶ä¸å®‰å…¨ï¼‰
* ä¹Ÿå…è®¸å°†ä»»ä½•æ•´æ•°ç±»å‹è½¬æ¢ä¸ºä»»ä½•æŒ‡é’ˆç±»å‹ä»¥åŠåå‘è½¬æ¢ã€‚
* reinterpret_cast è¿ç®—ç¬¦ä¸èƒ½ä¸¢æ‰ constã€volatile æˆ– __unaligned ç‰¹æ€§ã€‚
* reinterpret_cast çš„ä¸€ä¸ªå®é™…ç”¨é€”æ˜¯åœ¨å“ˆå¸Œå‡½æ•°ä¸­ï¼Œå³ï¼Œé€šè¿‡è®©ä¸¤ä¸ªä¸åŒçš„å€¼å‡ ä¹ä¸ä»¥ç›¸åŒçš„ç´¢å¼•ç»“å°¾çš„æ–¹å¼å°†å€¼æ˜ å°„åˆ°ç´¢å¼•ã€‚

### bad_cast

* ç”±äºå¼ºåˆ¶è½¬æ¢ä¸ºå¼•ç”¨ç±»å‹å¤±è´¥ï¼Œdynamic_cast è¿ç®—ç¬¦å¼•å‘ bad_cast å¼‚å¸¸ã€‚

```cpp
try {  
    Circle& ref_circle = dynamic_cast<Circle&>(ref_shape);   
}  
catch (bad_cast b) {  
    cout << "Caught: " << b.what();  
} 
```

## è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ (RTTI)

### typeid

* typeid è¿ç®—ç¬¦å…è®¸åœ¨è¿è¡Œæ—¶ç¡®å®šå¯¹è±¡çš„ç±»å‹
* typeid è¿”å›ä¸€ä¸ª typeinfo å¯¹è±¡çš„å¼•ç”¨
* å¦‚æœæƒ³é€šè¿‡åŸºç±»çš„æŒ‡é’ˆè·å¾—æ´¾ç”Ÿç±»çš„æ•°æ®ç±»å‹ï¼ŒåŸºç±»å¿…é¡»å¸¦æœ‰è™šå‡½æ•°
* åªèƒ½è·å–å¯¹è±¡çš„å®é™…ç±»å‹

### type_info

* type_info ç±»æè¿°ç¼–è¯‘å™¨åœ¨ç¨‹åºä¸­ç”Ÿæˆçš„ç±»å‹ä¿¡æ¯ã€‚ æ­¤ç±»çš„å¯¹è±¡å¯ä»¥æœ‰æ•ˆå­˜å‚¨æŒ‡å‘ç±»å‹çš„åç§°çš„æŒ‡é’ˆã€‚ type_info ç±»è¿˜å¯å­˜å‚¨é€‚åˆæ¯”è¾ƒä¸¤ä¸ªç±»å‹æ˜¯å¦ç›¸ç­‰æˆ–æ¯”è¾ƒå…¶æ’åˆ—é¡ºåºçš„ç¼–ç å€¼ã€‚ ç±»å‹çš„ç¼–ç è§„åˆ™å’Œæ’åˆ—é¡ºåºæ˜¯æœªæŒ‡å®šçš„ï¼Œå¹¶ä¸”å¯èƒ½å› ç¨‹åºè€Œå¼‚ã€‚
* å¤´æ–‡ä»¶ï¼š`typeinfo`

typeidã€type_info ä½¿ç”¨

```cpp
#include <iostream>
using namespace std;

class Flyable                       // èƒ½é£çš„
{
public:
    virtual void takeoff() = 0;     // èµ·é£
    virtual void land() = 0;        // é™è½
};
class Bird : public Flyable         // é¸Ÿ
{
public:
    void foraging() {...}           // è§…é£Ÿ
    virtual void takeoff() {...}
    virtual void land() {...}
    virtual ~Bird(){}
};
class Plane : public Flyable        // é£æœº
{
public:
    void carry() {...}              // è¿è¾“
    virtual void takeoff() {...}
    virtual void land() {...}
};

class type_info
{
public:
    const char* name() const;
    bool operator == (const type_info & rhs) const;
    bool operator != (const type_info & rhs) const;
    int before(const type_info & rhs) const;
    virtual ~type_info();
private:
    ...
};

void doSomething(Flyable *obj)                 // åšäº›äº‹æƒ…
{
    obj->takeoff();

    cout << typeid(*obj).name() << endl;        // è¾“å‡ºä¼ å…¥å¯¹è±¡ç±»å‹ï¼ˆ"class Bird" or "class Plane"ï¼‰

    if(typeid(*obj) == typeid(Bird))            // åˆ¤æ–­å¯¹è±¡ç±»å‹
    {
        Bird *bird = dynamic_cast<Bird *>(obj); // å¯¹è±¡è½¬åŒ–
        bird->foraging();
    }

    obj->land();
}

int main(){
    Bird *b = new Bird();
    doSomething(b);
    delete b;
    b = nullptr;
    return 0;
}
```

## æ¨¡ç‰ˆå…ƒç¼–ç¨‹

>æ¨¡æ¿å…ƒç¼–ç¨‹çš„åŸºæœ¬æ€æƒ³æ˜¯åˆ©ç”¨æ¨¡æ¿è¿›è¡Œé™æ€è®¡ç®—å’Œæ³›å‹ç¼–ç¨‹ï¼šåœ¨ç¼–è¯‘å™¨è¯»å–å’Œç¿»è¯‘æºä»£ç æ—¶ï¼Œæ‰€æœ‰æ¶‰åŠæ¨¡æ¿çš„è®¡ç®—éƒ½ä¼šè¢«å±•å¼€ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„å­—èŠ‚ç ï¼Œè€Œè¿™äº›è®¡ç®—çš„ç»“æœå¯ä»¥ç›´æ¥åµŒå…¥æœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºä¸­ã€‚

```c++
template<int N>
struct Fibonacci {
    static const int value = Fibonacci<N - 1>::value + Fibonacci<N - 2>::value;
};

template<>
struct Fibonacci<0> {
    static const int value = 0;
};

template<>
struct Fibonacci<1> {
    static const int value = 1;
};

int main() {
    std::cout << Fibonacci<10>::value << std::endl; // è¾“å‡º 55
    return 0;
}
```

```c++
template<typename T>
class Demo {
public:
    void print(T value) {
        std::cout << value << std::endl;
    }
};

// ä»…å¯¹æµ®ç‚¹æ•°ç±»å‹è¿›è¡Œå¤„ç†
template<typename T>
typename std::enable_if<std::is_floating_point<T>::value>::type
function(T x) {
    Demo<T> d;
    d.print(x * 10); // è¾“å‡ºæµ®ç‚¹æ•°ä¹˜ä»¥ 10 çš„å€¼
}

// ä»…å¯¹æ•´æ•°ç±»å‹è¿›è¡Œå¤„ç†
template<typename T>
typename std::enable_if<std::is_integral<T>::value>::type
function(T x) {
    Demo<T> d;
    d.print(x * 2); // è¾“å‡ºæ•´æ•°ä¹˜ä»¥ 2 çš„å€¼
}

int main() {
    function(1.23); // è¾“å‡º 12.3ï¼ˆæµ®ç‚¹æ•°ä¹˜ä»¥ 10 çš„å€¼ï¼‰
    function(4); // è¾“å‡º 8ï¼ˆæ•´æ•°ä¹˜ä»¥ 2 çš„å€¼ï¼‰
    return 0;
}
```

```c++
//enable_ifæºç 
template<bool B, typename T = void> 
struct enable_if {};

template<typename T>
struct enable_if<true, T> { using type = T; };

template<bool B, typename T = void>
using enable_if_t = typename enable_if<B, T>::type;
```

### SFINAEæŠ€æœ¯

SFINAE æ˜¯æŒ‡ `Substitutio Failure Is Not An Error`ï¼Œå³ â€œ æ›¿æ¢å¤±è´¥ä¸æ˜¯ä¸€ä¸ªé”™è¯¯ â€ çš„ç¼©å†™ã€‚å®ƒæ˜¯ C++ æ¨¡æ¿ç¼–ç¨‹ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œé’ˆå¯¹æ¨¡æ¿å‚æ•°åŒ¹é…è¿‡ç¨‹ä¸­å› ç±»å‹ä¸åŒ¹é…ã€å‡½æ•°ä¸å­˜åœ¨ç­‰å¯¼è‡´çš„é”™è¯¯ï¼Œä½¿ç”¨ SFINAE æŠ€æœ¯å¯ä»¥è®©ç¼–è¯‘å™¨è·³è¿‡è¿™äº›é”™è¯¯ï¼Œå¹¶ç»§ç»­å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„æ¨¡æ¿ã€‚

## Google C++ Style Guide

* è‹±æ–‡ï¼š[Google C++ Style Guide](https://google.github.io/styleguide/cppguide.html)
* ä¸­æ–‡ï¼š[C++ é£æ ¼æŒ‡å—](https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/contents/)

<a id="os"></a>

# ğŸ’» æ“ä½œç³»ç»Ÿ

[xv6ä¸­æ–‡æ–‡æ¡£](https://github.com/FrankZn/xv6-riscv-book-Chinese)

[xv6å®éªŒè¯¦è§£](https://blog.miigon.net/posts/s081-ending/#lab-%E6%8C%87%E5%BC%95)

[xv6è¯¾ç¨‹ç¿»è¯‘](https://mit-public-courses-cn-translatio.gitbook.io/mit6-s081/)

[Linux -0.12å†…æ ¸å‰–æ](https://github.com/yifengyou/linux-0.12)

## è¿›ç¨‹ä¸çº¿ç¨‹

å¯¹äºæœ‰çº¿ç¨‹ç³»ç»Ÿï¼š

* è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„ç‹¬ç«‹å•ä½
* çº¿ç¨‹æ˜¯èµ„æºè°ƒåº¦çš„ç‹¬ç«‹å•ä½

å¯¹äºæ— çº¿ç¨‹ç³»ç»Ÿï¼š

* è¿›ç¨‹æ˜¯èµ„æºè°ƒåº¦ã€åˆ†é…çš„ç‹¬ç«‹å•ä½

### è¿›ç¨‹è°ƒåº¦

### è¿›ç¨‹é€šä¿¡

* ç®¡é“ï¼ˆPIPEï¼‰
  * æœ‰åç®¡é“ï¼šä¸€ç§åŠåŒå·¥çš„é€šä¿¡æ–¹å¼ï¼Œå®ƒå…è®¸æ— äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡
    * ä¼˜ç‚¹ï¼šå¯ä»¥å®ç°ä»»æ„å…³ç³»çš„è¿›ç¨‹é—´çš„é€šä¿¡
    * ç¼ºç‚¹ï¼š
        1. é•¿æœŸå­˜äºç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ä¸å½“å®¹æ˜“å‡ºé”™
        2. ç¼“å†²åŒºæœ‰é™
  * æ— åç®¡é“ï¼šä¸€ç§åŠåŒå·¥çš„é€šä¿¡æ–¹å¼ï¼Œåªèƒ½åœ¨å…·æœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´ä½¿ç”¨ï¼ˆçˆ¶å­è¿›ç¨‹ï¼‰
    * ä¼˜ç‚¹ï¼šç®€å•æ–¹ä¾¿
    * ç¼ºç‚¹ï¼š
        1. å±€é™äºå•å‘é€šä¿¡
        2. åªèƒ½åˆ›å»ºåœ¨å®ƒçš„è¿›ç¨‹ä»¥åŠå…¶æœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´
        3. ç¼“å†²åŒºæœ‰é™

* ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ï¼šä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®
  * ä¼˜ç‚¹ï¼šå¯ä»¥åŒæ­¥è¿›ç¨‹
  * ç¼ºç‚¹ï¼šä¿¡å·é‡æœ‰é™
  
* ä¿¡å·ï¼ˆSignalï¼‰ï¼šä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿ
  
* æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼šæ˜¯æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå­˜æ”¾åœ¨å†…æ ¸ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†
  * ä¼˜ç‚¹ï¼šå¯ä»¥å®ç°ä»»æ„è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œå¹¶é€šè¿‡ç³»ç»Ÿè°ƒç”¨å‡½æ•°æ¥å®ç°æ¶ˆæ¯å‘é€å’Œæ¥æ”¶ä¹‹é—´çš„åŒæ­¥ï¼Œæ— éœ€è€ƒè™‘åŒæ­¥é—®é¢˜ï¼Œæ–¹ä¾¿
  * ç¼ºç‚¹ï¼šä¿¡æ¯çš„å¤åˆ¶éœ€è¦é¢å¤–æ¶ˆè€— CPU çš„æ—¶é—´ï¼Œä¸é€‚å®œäºä¿¡æ¯é‡å¤§æˆ–æ“ä½œé¢‘ç¹çš„åœºåˆ
  
* å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰ï¼šæ˜ å°„ä¸€æ®µèƒ½è¢«å…¶ä»–è¿›ç¨‹æ‰€è®¿é—®çš„å†…å­˜ï¼Œè¿™æ®µå…±äº«å†…å­˜ç”±ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºï¼Œä½†å¤šä¸ªè¿›ç¨‹éƒ½å¯ä»¥è®¿é—®
  * ä¼˜ç‚¹ï¼šæ— é¡»å¤åˆ¶ï¼Œå¿«æ·ï¼Œä¿¡æ¯é‡å¤§
  * ç¼ºç‚¹ï¼š
      1. é€šä¿¡æ˜¯é€šè¿‡å°†å…±äº«ç©ºé—´ç¼“å†²åŒºç›´æ¥é™„åŠ åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æ¥å®ç°çš„ï¼Œå› æ­¤è¿›ç¨‹é—´çš„è¯»å†™æ“ä½œçš„åŒæ­¥é—®é¢˜
      2. åˆ©ç”¨å†…å­˜ç¼“å†²åŒºç›´æ¥äº¤æ¢ä¿¡æ¯ï¼Œå†…å­˜çš„å®ä½“å­˜åœ¨äºè®¡ç®—æœºä¸­ï¼Œåªèƒ½åŒä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿä¸­çš„è¯¸å¤šè¿›ç¨‹å…±äº«ï¼Œä¸æ–¹ä¾¿ç½‘ç»œé€šä¿¡

* å¥—æ¥å­—ï¼ˆSocketï¼‰ï¼šå¯ç”¨äºä¸åŒè®¡ç®—æœºé—´çš„è¿›ç¨‹é€šä¿¡
  * ä¼˜ç‚¹ï¼š
      1. ä¼ è¾“æ•°æ®ä¸ºå­—èŠ‚çº§ï¼Œä¼ è¾“æ•°æ®å¯è‡ªå®šä¹‰ï¼Œæ•°æ®é‡å°æ•ˆç‡é«˜
      2. ä¼ è¾“æ•°æ®æ—¶é—´çŸ­ï¼Œæ€§èƒ½é«˜
      3. é€‚åˆäºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´ä¿¡æ¯å®æ—¶äº¤äº’
      4. å¯ä»¥åŠ å¯†,æ•°æ®å®‰å…¨æ€§å¼º
  * ç¼ºç‚¹ï¼šéœ€å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡Œè§£æï¼Œè½¬åŒ–æˆåº”ç”¨çº§çš„æ•°æ®ã€‚

### çº¿ç¨‹é€šä¿¡

* é”æœºåˆ¶ï¼š
  * äº’æ–¥é”/é‡ï¼ˆmutexï¼‰ï¼šæä¾›äº†ä»¥æ’ä»–æ–¹å¼é˜²æ­¢æ•°æ®ç»“æ„è¢«å¹¶å‘ä¿®æ”¹çš„æ–¹æ³•ã€‚
  * è¯»å†™é”ï¼ˆreader-writer lockï¼‰ï¼šå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å…±äº«æ•°æ®ï¼Œè€Œå¯¹å†™æ“ä½œæ˜¯äº’æ–¥çš„ã€‚
  * è‡ªæ—‹é”ï¼ˆspin lockï¼‰ä¸äº’æ–¥é”ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸ºäº†ä¿æŠ¤å…±äº«èµ„æºã€‚äº’æ–¥é”æ˜¯å½“èµ„æºè¢«å ç”¨ï¼Œç”³è¯·è€…è¿›å…¥ç¡çœ çŠ¶æ€ï¼›è€Œè‡ªæ—‹é”åˆ™å¾ªç¯æ£€æµ‹ä¿æŒè€…æ˜¯å¦å·²ç»é‡Šæ”¾é”ã€‚
  * æ¡ä»¶å˜é‡ï¼ˆconditionï¼‰ï¼šå¯ä»¥ä»¥åŸå­çš„æ–¹å¼é˜»å¡è¿›ç¨‹ï¼Œç›´åˆ°æŸä¸ªç‰¹å®šæ¡ä»¶ä¸ºçœŸä¸ºæ­¢ã€‚å¯¹æ¡ä»¶çš„æµ‹è¯•æ˜¯åœ¨äº’æ–¥é”çš„ä¿æŠ¤ä¸‹è¿›è¡Œçš„ã€‚æ¡ä»¶å˜é‡å§‹ç»ˆä¸äº’æ–¥é”ä¸€èµ·ä½¿ç”¨ã€‚
  * ä¿¡å·é‡æœºåˆ¶(Semaphore)
    * æ— åçº¿ç¨‹ä¿¡å·é‡
    * å‘½åçº¿ç¨‹ä¿¡å·é‡
* ä¿¡å·æœºåˆ¶(Signal)ï¼šç±»ä¼¼è¿›ç¨‹é—´çš„ä¿¡å·å¤„ç†
* å±éšœï¼ˆbarrierï¼‰ï¼šå±éšœå…è®¸æ¯ä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çš„åˆä½œçº¿ç¨‹éƒ½è¾¾åˆ°æŸä¸€ç‚¹ï¼Œç„¶åä»è¯¥ç‚¹ç»§ç»­æ‰§è¡Œã€‚

çº¿ç¨‹é—´çš„é€šä¿¡ç›®çš„ä¸»è¦æ˜¯ç”¨äºçº¿ç¨‹åŒæ­¥ï¼Œæ‰€ä»¥çº¿ç¨‹æ²¡æœ‰åƒè¿›ç¨‹é€šä¿¡ä¸­çš„ç”¨äºæ•°æ®äº¤æ¢çš„é€šä¿¡æœºåˆ¶  

> è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼ä»¥åŠä¼˜ç¼ºç‚¹æ¥æºäºï¼š[è¿›ç¨‹çº¿ç¨‹é¢è¯•é¢˜æ€»ç»“](http://blog.csdn.net/wujiafei_njgcxy/article/details/77098977)

### è¿›ç¨‹ä¹‹é—´ç§æœ‰å’Œå…±äº«çš„èµ„æº

* ç§æœ‰ï¼šåœ°å€ç©ºé—´ã€å †ã€å…¨å±€å˜é‡ã€æ ˆã€å¯„å­˜å™¨
* å…±äº«ï¼šä»£ç æ®µï¼Œå…¬å…±æ•°æ®ï¼Œè¿›ç¨‹ç›®å½•ï¼Œè¿›ç¨‹ ID

### çº¿ç¨‹ä¹‹é—´ç§æœ‰å’Œå…±äº«çš„èµ„æº

* ç§æœ‰ï¼šçº¿ç¨‹æ ˆï¼Œå¯„å­˜å™¨ï¼Œç¨‹åºè®¡æ•°å™¨
* å…±äº«ï¼šå †ï¼Œåœ°å€ç©ºé—´ï¼Œå…¨å±€å˜é‡ï¼Œé™æ€å˜é‡

### å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹é—´çš„å¯¹æ¯”ã€ä¼˜åŠ£ä¸é€‰æ‹©

#### å¯¹æ¯”

å¯¹æ¯”ç»´åº¦ | å¤šè¿›ç¨‹ | å¤šçº¿ç¨‹
---|---|---
æ•°æ®å…±äº«ã€åŒæ­¥|æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨ IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•|å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼Œä½†ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› å¯¼è‡´åŒæ­¥å¤æ‚|
å†…å­˜ã€CPU|å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPU åˆ©ç”¨ç‡ä½|å ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPU åˆ©ç”¨ç‡é«˜|
åˆ›å»ºé”€æ¯ã€åˆ‡æ¢|åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢|åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿«|
ç¼–ç¨‹ã€è°ƒè¯•|ç¼–ç¨‹ç®€å•ï¼Œè°ƒè¯•ç®€å•|ç¼–ç¨‹å¤æ‚ï¼Œè°ƒè¯•å¤æ‚|
å¯é æ€§|è¿›ç¨‹é—´ä¸ä¼šäº’ç›¸å½±å“|ä¸€ä¸ªçº¿ç¨‹æŒ‚æ‰å°†å¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŒ‚æ‰|
åˆ†å¸ƒå¼|é€‚åº”äºå¤šæ ¸ã€å¤šæœºåˆ†å¸ƒå¼ï¼›å¦‚æœä¸€å°æœºå™¨ä¸å¤Ÿï¼Œæ‰©å±•åˆ°å¤šå°æœºå™¨æ¯”è¾ƒç®€å•|é€‚åº”äºå¤šæ ¸åˆ†å¸ƒå¼|

#### ä¼˜åŠ£

ä¼˜åŠ£|å¤šè¿›ç¨‹|å¤šçº¿ç¨‹
---|---|---
ä¼˜ç‚¹|ç¼–ç¨‹ã€è°ƒè¯•ç®€å•ï¼Œå¯é æ€§è¾ƒé«˜|åˆ›å»ºã€é”€æ¯ã€åˆ‡æ¢é€Ÿåº¦å¿«ï¼Œå†…å­˜ã€èµ„æºå ç”¨å°
ç¼ºç‚¹|åˆ›å»ºã€é”€æ¯ã€åˆ‡æ¢é€Ÿåº¦æ…¢ï¼Œå†…å­˜ã€èµ„æºå ç”¨å¤§|ç¼–ç¨‹ã€è°ƒè¯•å¤æ‚ï¼Œå¯é æ€§è¾ƒå·®

#### é€‰æ‹©

* éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„ä¼˜å…ˆç”¨çº¿ç¨‹
* éœ€è¦è¿›è¡Œå¤§é‡è®¡ç®—çš„ä¼˜å…ˆä½¿ç”¨çº¿ç¨‹
* å¼ºç›¸å…³çš„å¤„ç†ç”¨çº¿ç¨‹ï¼Œå¼±ç›¸å…³çš„å¤„ç†ç”¨è¿›ç¨‹
* å¯èƒ½è¦æ‰©å±•åˆ°å¤šæœºåˆ†å¸ƒçš„ç”¨è¿›ç¨‹ï¼Œå¤šæ ¸åˆ†å¸ƒçš„ç”¨çº¿ç¨‹
* éƒ½æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œç”¨ä½ æœ€ç†Ÿæ‚‰ã€æœ€æ‹¿æ‰‹çš„æ–¹å¼

> å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹é—´çš„å¯¹æ¯”ã€ä¼˜åŠ£ä¸é€‰æ‹©æ¥è‡ªï¼š[å¤šçº¿ç¨‹è¿˜æ˜¯å¤šè¿›ç¨‹çš„é€‰æ‹©åŠåŒºåˆ«](https://blog.csdn.net/lishenglong666/article/details/8557215)

## Linux å†…æ ¸çš„åŒæ­¥æ–¹å¼

### åŸå› 

åœ¨ç°ä»£æ“ä½œç³»ç»Ÿé‡Œï¼ŒåŒä¸€æ—¶é—´å¯èƒ½æœ‰å¤šä¸ªå†…æ ¸æ‰§è¡Œæµåœ¨æ‰§è¡Œï¼Œå› æ­¤å†…æ ¸å…¶å®åƒå¤šè¿›ç¨‹å¤šçº¿ç¨‹ç¼–ç¨‹ä¸€æ ·ä¹Ÿéœ€è¦ä¸€äº›åŒæ­¥æœºåˆ¶æ¥åŒæ­¥å„æ‰§è¡Œå•å…ƒå¯¹å…±äº«æ•°æ®çš„è®¿é—®ã€‚å°¤å…¶æ˜¯åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸Šï¼Œæ›´éœ€è¦ä¸€äº›åŒæ­¥æœºåˆ¶æ¥åŒæ­¥ä¸åŒå¤„ç†å™¨ä¸Šçš„æ‰§è¡Œå•å…ƒå¯¹å…±äº«çš„æ•°æ®çš„è®¿é—®ã€‚

### åŒæ­¥æ–¹å¼

* åŸå­æ“ä½œ
* ä¿¡å·é‡ï¼ˆsemaphoreï¼‰
* è¯»å†™ä¿¡å·é‡ï¼ˆrw_semaphoreï¼‰
* è‡ªæ—‹é”ï¼ˆspinlockï¼‰
* å¤§å†…æ ¸é”ï¼ˆBKLï¼ŒBig Kernel Lockï¼‰
* è¯»å†™é”ï¼ˆrwlockï¼‰
* å¤§è¯»è€…é”ï¼ˆbrlock-Big Reader Lockï¼‰
* è¯»-æ‹·è´ä¿®æ”¹(RCUï¼ŒRead-Copy Update)
* é¡ºåºé”ï¼ˆseqlockï¼‰

> æ¥è‡ªï¼š[Linux å†…æ ¸çš„åŒæ­¥æœºåˆ¶ï¼Œç¬¬ 1 éƒ¨åˆ†](https://www.ibm.com/developerworks/cn/linux/l-synch/part1/)ã€[Linux å†…æ ¸çš„åŒæ­¥æœºåˆ¶ï¼Œç¬¬ 2 éƒ¨åˆ†](https://www.ibm.com/developerworks/cn/linux/l-synch/part2/)

## æ­»é”

### æ­»é”åŸå› 

* ç³»ç»Ÿèµ„æºä¸è¶³
* èµ„æºåˆ†é…ä¸å½“
* è¿›ç¨‹è¿è¡Œæ¨è¿›é¡ºåºä¸åˆé€‚

### äº§ç”Ÿæ¡ä»¶

* äº’æ–¥
* è¯·æ±‚å’Œä¿æŒ
* ä¸å‰¥å¤º
* ç¯è·¯

### é¢„é˜²

* æ‰“ç ´äº’æ–¥æ¡ä»¶ï¼šæ”¹é€ ç‹¬å æ€§èµ„æºä¸ºè™šæ‹Ÿèµ„æºï¼Œå¤§éƒ¨åˆ†èµ„æºå·²æ— æ³•æ”¹é€ ã€‚
* æ‰“ç ´ä¸å¯æŠ¢å æ¡ä»¶ï¼šå½“ä¸€è¿›ç¨‹å æœ‰ä¸€ç‹¬å æ€§èµ„æºååˆç”³è¯·ä¸€ç‹¬å æ€§èµ„æºè€Œæ— æ³•æ»¡è¶³ï¼Œåˆ™é€€å‡ºåŸå æœ‰çš„èµ„æºã€‚
* æ‰“ç ´å æœ‰ä¸”ç”³è¯·æ¡ä»¶ï¼šé‡‡ç”¨èµ„æºé¢„å…ˆåˆ†é…ç­–ç•¥ï¼Œå³è¿›ç¨‹è¿è¡Œå‰ç”³è¯·å…¨éƒ¨èµ„æºï¼Œæ»¡è¶³åˆ™è¿è¡Œï¼Œä¸ç„¶å°±ç­‰å¾…ï¼Œè¿™æ ·å°±ä¸ä¼šå æœ‰ä¸”ç”³è¯·ã€‚
* æ‰“ç ´å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå®ç°èµ„æºæœ‰åºåˆ†é…ç­–ç•¥ï¼Œå¯¹æ‰€æœ‰è®¾å¤‡å®ç°åˆ†ç±»ç¼–å·ï¼Œæ‰€æœ‰è¿›ç¨‹åªèƒ½é‡‡ç”¨æŒ‰åºå·é€’å¢çš„å½¢å¼ç”³è¯·èµ„æºã€‚
* æœ‰åºèµ„æºåˆ†é…æ³•
* é“¶è¡Œå®¶ç®—æ³•

## æ–‡ä»¶ç³»ç»Ÿ

* Windowsï¼šFCB è¡¨ + FAT + ä½å›¾
* Unixï¼šinode + æ··åˆç´¢å¼• + æˆç»„é“¾æ¥

## å†…å­˜ç®¡ç†

### é¡µé¢ç½®æ¢ç®—æ³•

åœ¨åœ°å€æ˜ å°„è¿‡ç¨‹ä¸­ï¼Œè‹¥åœ¨é¡µé¢ä¸­å‘ç°æ‰€è¦è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜ä¸­ï¼Œåˆ™äº§ç”Ÿç¼ºé¡µä¸­æ–­ã€‚å½“å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿå†…å­˜ä¸­æ²¡æœ‰ç©ºé—²é¡µé¢ï¼Œåˆ™æ“ä½œç³»ç»Ÿå¿…é¡»åœ¨å†…å­˜é€‰æ‹©ä¸€ä¸ªé¡µé¢å°†å…¶ç§»å‡ºå†…å­˜ï¼Œä»¥ä¾¿ä¸ºå³å°†è°ƒå…¥çš„é¡µé¢è®©å‡ºç©ºé—´ã€‚è€Œç”¨æ¥é€‰æ‹©æ·˜æ±°å“ªä¸€é¡µçš„è§„åˆ™å«åšé¡µé¢ç½®æ¢ç®—æ³•ã€‚

### ç½®æ¢åˆ†ç±»

* å…¨å±€ç½®æ¢ï¼šåœ¨æ•´ä¸ªå†…å­˜ç©ºé—´ç½®æ¢
* å±€éƒ¨ç½®æ¢ï¼šåœ¨æœ¬è¿›ç¨‹ä¸­è¿›è¡Œç½®æ¢

### ç®—æ³•

å…¨å±€ï¼š

* å·¥ä½œé›†ç®—æ³•
* ç¼ºé¡µç‡ç½®æ¢ç®—æ³•

å±€éƒ¨ï¼š

* æœ€ä½³ç½®æ¢ç®—æ³•ï¼ˆOPTï¼‰
* å…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³•ï¼ˆFIFOï¼‰
* [æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ï¼ˆLRUï¼‰ç®—æ³•](/os/LRU.cpp)
* [æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLFUï¼‰ç®—æ³•](/os/LFU.cpp)
* æ—¶é’Ÿï¼ˆClockï¼‰ç½®æ¢ç®—æ³•

<a id="computer-network"></a>

# â˜ï¸ è®¡ç®—æœºç½‘ç»œ

> æœ¬èŠ‚éƒ¨åˆ†çŸ¥è¯†ç‚¹æ¥è‡ªã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ 7 ç‰ˆï¼‰ã€‹

è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ï¼š

![è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„](https://gitee.com/huihut/interview/raw/master/images/è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„.png)

## å„å±‚ä½œç”¨åŠåè®®

åˆ†å±‚ | ä½œç”¨ | åè®®
---|---|---
ç‰©ç†å±‚ | é€šè¿‡åª’ä»‹ä¼ è¾“æ¯”ç‰¹ï¼Œç¡®å®šæœºæ¢°åŠç”µæ°”è§„èŒƒï¼ˆæ¯”ç‰¹ Bitï¼‰ | RJ45ã€CLOCKã€IEEE802.3ï¼ˆä¸­ç»§å™¨ï¼Œé›†çº¿å™¨ï¼‰
æ•°æ®é“¾è·¯å±‚|å°†æ¯”ç‰¹ç»„è£…æˆå¸§å’Œç‚¹åˆ°ç‚¹çš„ä¼ é€’ï¼ˆå¸§ Frameï¼‰| PPPã€FRã€HDLCã€VLANã€MACï¼ˆç½‘æ¡¥ï¼Œäº¤æ¢æœºï¼‰
ç½‘ç»œå±‚|è´Ÿè´£æ•°æ®åŒ…ä»æºåˆ°å®¿çš„ä¼ é€’å’Œç½‘é™…äº’è¿ï¼ˆåŒ… Packetï¼‰|IPã€ICMPã€ARPã€RARPã€OSPFã€IPXã€RIPã€IGRPï¼ˆè·¯ç”±å™¨ï¼‰
è¿è¾“å±‚|æä¾›ç«¯åˆ°ç«¯çš„å¯é æŠ¥æ–‡ä¼ é€’å’Œé”™è¯¯æ¢å¤ï¼ˆ æ®µSegmentï¼‰|TCPã€UDPã€SPX
ä¼šè¯å±‚|å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢ä¼šè¯ï¼ˆä¼šè¯åè®®æ•°æ®å•å…ƒ SPDUï¼‰|NFSã€SQLã€NETBIOSã€RPC
è¡¨ç¤ºå±‚|å¯¹æ•°æ®è¿›è¡Œç¿»è¯‘ã€åŠ å¯†å’Œå‹ç¼©ï¼ˆè¡¨ç¤ºåè®®æ•°æ®å•å…ƒ PPDUï¼‰|JPEGã€MPEGã€ASII
åº”ç”¨å±‚|å…è®¸è®¿é—®OSIç¯å¢ƒçš„æ‰‹æ®µï¼ˆåº”ç”¨åè®®æ•°æ®å•å…ƒ APDUï¼‰|FTPã€DNSã€Telnetã€SMTPã€HTTPã€WWWã€NFS

### ç‰©ç†å±‚

* ä¼ è¾“æ•°æ®çš„å•ä½ï¼šæ¯”ç‰¹
* æ•°æ®ä¼ è¾“ç³»ç»Ÿï¼šæºç³»ç»Ÿï¼ˆæºç‚¹ã€å‘é€å™¨ï¼‰ --> ä¼ è¾“ç³»ç»Ÿ --> ç›®çš„ç³»ç»Ÿï¼ˆæ¥æ”¶å™¨ã€ç»ˆç‚¹ï¼‰

é€šé“ï¼š

* å•å‘é€šé“ï¼ˆå•å·¥é€šé“ï¼‰ï¼šåªæœ‰ä¸€ä¸ªæ–¹å‘é€šä¿¡ï¼Œæ²¡æœ‰åæ–¹å‘äº¤äº’ï¼Œå¦‚å¹¿æ’­
* åŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥é€šä¿¡ï¼‰ï¼šé€šä¿¡åŒæ–¹éƒ½å¯å‘æ¶ˆæ¯ï¼Œä½†ä¸èƒ½åŒæ—¶å‘é€æˆ–æ¥æ”¶
* åŒå‘åŒæ—¶é€šä¿¡ï¼ˆå…¨åŒå·¥é€šä¿¡ï¼‰ï¼šé€šä¿¡åŒæ–¹å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶ä¿¡æ¯

é€šé“å¤ç”¨æŠ€æœ¯ï¼š

* é¢‘åˆ†å¤ç”¨ï¼ˆFDMï¼ŒFrequency Division Multiplexingï¼‰ï¼šä¸åŒç”¨æˆ·åœ¨ä¸åŒé¢‘å¸¦ï¼Œæ‰€ç”¨ç”¨æˆ·åœ¨åŒæ ·æ—¶é—´å ç”¨ä¸åŒå¸¦å®½èµ„æº
* æ—¶åˆ†å¤ç”¨ï¼ˆTDMï¼ŒTime Division Multiplexingï¼‰ï¼šä¸åŒç”¨æˆ·åœ¨åŒä¸€æ—¶é—´æ®µçš„ä¸åŒæ—¶é—´ç‰‡ï¼Œæ‰€æœ‰ç”¨æˆ·åœ¨ä¸åŒæ—¶é—´å ç”¨åŒæ ·çš„é¢‘å¸¦å®½åº¦
* æ³¢åˆ†å¤ç”¨ï¼ˆWDMï¼ŒWavelength Division Multiplexingï¼‰ï¼šå…‰çš„é¢‘åˆ†å¤ç”¨
* ç åˆ†å¤ç”¨ï¼ˆCDMï¼ŒCode Division Multiplexingï¼‰ï¼šä¸åŒç”¨æˆ·ä½¿ç”¨ä¸åŒçš„ç ï¼Œå¯ä»¥åœ¨åŒæ ·æ—¶é—´ä½¿ç”¨åŒæ ·é¢‘å¸¦é€šä¿¡

### æ•°æ®é“¾è·¯å±‚

ä¸»è¦ä¿¡é“ï¼š

* ç‚¹å¯¹ç‚¹ä¿¡é“
* å¹¿æ’­ä¿¡é“

#### ç‚¹å¯¹ç‚¹ä¿¡é“

* æ•°æ®å•å…ƒï¼šå¸§

ä¸‰ä¸ªåŸºæœ¬é—®é¢˜ï¼š

* å°è£…æˆå¸§ï¼šæŠŠç½‘ç»œå±‚çš„ IP æ•°æ®æŠ¥å°è£…æˆå¸§ï¼Œ`SOH - æ•°æ®éƒ¨åˆ† - EOT`
* é€æ˜ä¼ è¾“ï¼šä¸ç®¡æ•°æ®éƒ¨åˆ†ä»€ä¹ˆå­—ç¬¦ï¼Œéƒ½èƒ½ä¼ è¾“å‡ºå»ï¼›å¯ä»¥é€šè¿‡å­—èŠ‚å¡«å……æ–¹æ³•è§£å†³ï¼ˆå†²çªå­—ç¬¦å‰åŠ è½¬ä¹‰å­—ç¬¦ï¼‰
* å·®é”™æ£€æµ‹ï¼šé™ä½è¯¯ç ç‡ï¼ˆBERï¼ŒBit Error Rateï¼‰ï¼Œå¹¿æ³›ä½¿ç”¨å¾ªç¯å†—ä½™æ£€æµ‹ï¼ˆCRCï¼ŒCyclic Redundancy Checkï¼‰

ç‚¹å¯¹ç‚¹åè®®ï¼ˆPoint-to-Point Protocolï¼‰ï¼š

* ç‚¹å¯¹ç‚¹åè®®ï¼ˆPoint-to-Point Protocolï¼‰ï¼šç”¨æˆ·è®¡ç®—æœºå’Œ ISP é€šä¿¡æ—¶æ‰€ä½¿ç”¨çš„åè®®

#### å¹¿æ’­ä¿¡é“

å¹¿æ’­é€šä¿¡ï¼š

* ç¡¬ä»¶åœ°å€ï¼ˆç‰©ç†åœ°å€ã€MAC åœ°å€ï¼‰
* å•æ’­ï¼ˆunicastï¼‰å¸§ï¼ˆä¸€å¯¹ä¸€ï¼‰ï¼šæ”¶åˆ°çš„å¸§çš„ MAC åœ°å€ä¸æœ¬ç«™çš„ç¡¬ä»¶åœ°å€ç›¸åŒ
* å¹¿æ’­ï¼ˆbroadcastï¼‰å¸§ï¼ˆä¸€å¯¹å…¨ä½“ï¼‰ï¼šå‘é€ç»™æœ¬å±€åŸŸç½‘ä¸Šæ‰€æœ‰ç«™ç‚¹çš„å¸§
* å¤šæ’­ï¼ˆmulticastï¼‰å¸§ï¼ˆä¸€å¯¹å¤šï¼‰ï¼šå‘é€ç»™æœ¬å±€åŸŸç½‘ä¸Šä¸€éƒ¨åˆ†ç«™ç‚¹çš„å¸§

### ç½‘ç»œå±‚

* IPï¼ˆInternet Protocolï¼Œç½‘é™…åè®®ï¼‰æ˜¯ä¸ºè®¡ç®—æœºç½‘ç»œç›¸äº’è¿æ¥è¿›è¡Œé€šä¿¡è€Œè®¾è®¡çš„åè®®ã€‚
* ARPï¼ˆAddress Resolution Protocolï¼Œåœ°å€è§£æåè®®ï¼‰
* ICMPï¼ˆInternet Control Message Protocolï¼Œç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ï¼‰
* IGMPï¼ˆInternet Group Management Protocolï¼Œç½‘é™…ç»„ç®¡ç†åè®®ï¼‰

#### IP ç½‘é™…åè®®

IP åœ°å€åˆ†ç±»ï¼š

* `IP åœ°å€ ::= {<ç½‘ç»œå·>,<ä¸»æœºå·>}`

IP åœ°å€ç±»åˆ« | ç½‘ç»œå· | ç½‘ç»œèŒƒå›´ | ä¸»æœºå· | IP åœ°å€èŒƒå›´
---|---|---|---|---
A ç±» | 8bitï¼Œç¬¬ä¸€ä½å›ºå®šä¸º 0 | 0 â€”â€” 127 | 24bit | 1.0.0.0 â€”â€” 127.255.255.255
B ç±» | 16bitï¼Œå‰ä¸¤ä½å›ºå®šä¸º  10 | 128.0 â€”â€” 191.255 | 16bit | 128.0.0.0 â€”â€” 191.255.255.255
C  ç±» | 24bitï¼Œå‰ä¸‰ä½å›ºå®šä¸º  110 | 192.0.0 â€”â€” 223.255.255 | 8bit | 192.0.0.0 â€”â€” 223.255.255.255
D  ç±» | å‰å››ä½å›ºå®šä¸º 1110ï¼Œåé¢ä¸ºå¤šæ’­åœ°å€
E  ç±» | å‰äº”ä½å›ºå®šä¸º 11110ï¼Œåé¢ä¿ç•™ä¸ºä»Šåæ‰€ç”¨

IP æ•°æ®æŠ¥æ ¼å¼ï¼š

![IP æ•°æ®æŠ¥æ ¼å¼](https://gitee.com/huihut/interview/raw/master/images/IPæ•°æ®æŠ¥æ ¼å¼.png)

#### ICMP ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®

ICMP æŠ¥æ–‡æ ¼å¼ï¼š

![ICMP æŠ¥æ–‡æ ¼å¼](https://gitee.com/huihut/interview/raw/master/images/ICMPæŠ¥æ–‡æ ¼å¼.png)

åº”ç”¨ï¼š

* PINGï¼ˆPacket InterNet Groperï¼Œåˆ†ç»„ç½‘é—´æ¢æµ‹ï¼‰æµ‹è¯•ä¸¤ä¸ªä¸»æœºä¹‹é—´çš„è¿é€šæ€§
* TTLï¼ˆTime To Liveï¼Œç”Ÿå­˜æ—¶é—´ï¼‰è¯¥å­—æ®µæŒ‡å®š IP åŒ…è¢«è·¯ç”±å™¨ä¸¢å¼ƒä¹‹å‰å…è®¸é€šè¿‡çš„æœ€å¤§ç½‘æ®µæ•°é‡

#### å†…éƒ¨ç½‘å…³åè®®

* RIPï¼ˆRouting Information Protocolï¼Œè·¯ç”±ä¿¡æ¯åè®®ï¼‰
* OSPFï¼ˆOpen Sortest Path Firstï¼Œå¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼‰

#### å¤–éƒ¨ç½‘å…³åè®®

* BGPï¼ˆBorder Gateway Protocolï¼Œè¾¹ç•Œç½‘å…³åè®®ï¼‰

#### IPå¤šæ’­

* IGMPï¼ˆInternet Group Management Protocolï¼Œç½‘é™…ç»„ç®¡ç†åè®®ï¼‰
* å¤šæ’­è·¯ç”±é€‰æ‹©åè®®

#### VPN å’Œ NAT

* VPNï¼ˆVirtual Private Networkï¼Œè™šæ‹Ÿä¸“ç”¨ç½‘ï¼‰
* NATï¼ˆNetwork Address Translationï¼Œç½‘ç»œåœ°å€è½¬æ¢ï¼‰

#### è·¯ç”±è¡¨åŒ…å«ä»€ä¹ˆï¼Ÿ

1. ç½‘ç»œ IDï¼ˆNetwork ID, Network numberï¼‰ï¼šå°±æ˜¯ç›®æ ‡åœ°å€çš„ç½‘ç»œ IDã€‚
2. å­ç½‘æ©ç ï¼ˆsubnet maskï¼‰ï¼šç”¨æ¥åˆ¤æ–­ IP æ‰€å±ç½‘ç»œ
3. ä¸‹ä¸€è·³åœ°å€/æ¥å£ï¼ˆNext hop / interfaceï¼‰ï¼šå°±æ˜¯æ•°æ®åœ¨å‘é€åˆ°ç›®æ ‡åœ°å€çš„æ—…é€”ä¸­ä¸‹ä¸€ç«™çš„åœ°å€ã€‚å…¶ä¸­ interface æŒ‡å‘ next hopï¼ˆå³ä¸ºä¸‹ä¸€ä¸ª routeï¼‰ã€‚ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿï¼ˆAS, Autonomous systemï¼‰ä¸­çš„ route åº”è¯¥åŒ…å«åŒºåŸŸå†…æ‰€æœ‰çš„å­ç½‘ç»œï¼Œè€Œé»˜è®¤ç½‘å…³ï¼ˆNetwork id: `0.0.0.0`, Netmask: `0.0.0.0`ï¼‰æŒ‡å‘è‡ªæ²»ç³»ç»Ÿçš„å‡ºå£ã€‚

æ ¹æ®åº”ç”¨å’Œæ‰§è¡Œçš„ä¸åŒï¼Œè·¯ç”±è¡¨å¯èƒ½å«æœ‰å¦‚ä¸‹é™„åŠ ä¿¡æ¯ï¼š

1. èŠ±è´¹ï¼ˆCostï¼‰ï¼šå°±æ˜¯æ•°æ®å‘é€è¿‡ç¨‹ä¸­é€šè¿‡è·¯å¾„æ‰€éœ€è¦çš„èŠ±è´¹ã€‚
2. è·¯ç”±çš„æœåŠ¡è´¨é‡
3. è·¯ç”±ä¸­éœ€è¦è¿‡æ»¤çš„å‡º/å…¥è¿æ¥åˆ—è¡¨

### è¿è¾“å±‚

åè®®ï¼š

* TCPï¼ˆTransmission Control Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®ï¼‰
* UDPï¼ˆUser Datagram Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰

ç«¯å£ï¼š

åº”ç”¨ç¨‹åº | FTP | TELNET | SMTP | DNS | TFTP | HTTP | HTTPS | SNMP  
--- | --- | --- |--- |--- |--- |--- |--- |---
ç«¯å£å· | 21 | 23 | 25 | 53 | 69 | 80 | 443 | 161  

#### TCP

* TCPï¼ˆTransmission Control Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®ï¼‰æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œå…¶ä¼ è¾“çš„å•ä½æ˜¯æŠ¥æ–‡æ®µã€‚

ç‰¹å¾ï¼š

* é¢å‘è¿æ¥
* åªèƒ½ç‚¹å¯¹ç‚¹ï¼ˆä¸€å¯¹ä¸€ï¼‰é€šä¿¡
* å¯é äº¤äº’
* å…¨åŒå·¥é€šä¿¡
* é¢å‘å­—èŠ‚æµ

TCP å¦‚ä½•ä¿è¯å¯é ä¼ è¾“ï¼š

* ç¡®è®¤å’Œè¶…æ—¶é‡ä¼ 
* æ•°æ®åˆç†åˆ†ç‰‡å’Œæ’åº
* æµé‡æ§åˆ¶
* æ‹¥å¡æ§åˆ¶
* æ•°æ®æ ¡éªŒ

TCP æŠ¥æ–‡ç»“æ„

![TCP æŠ¥æ–‡](https://gitee.com/huihut/interview/raw/master/images/TCPæŠ¥æ–‡.png)

TCP é¦–éƒ¨

![TCP é¦–éƒ¨](https://gitee.com/huihut/interview/raw/master/images/TCPé¦–éƒ¨.png)

TCPï¼šçŠ¶æ€æ§åˆ¶ç ï¼ˆCodeï¼ŒControl Flagï¼‰ï¼Œå  6 æ¯”ç‰¹ï¼Œå«ä¹‰å¦‚ä¸‹ï¼š

* URGï¼šç´§æ€¥æ¯”ç‰¹ï¼ˆurgentï¼‰ï¼Œå½“ `URGï¼1` æ—¶ï¼Œè¡¨æ˜ç´§æ€¥æŒ‡é’ˆå­—æ®µæœ‰æ•ˆï¼Œä»£è¡¨è¯¥å°åŒ…ä¸ºç´§æ€¥å°åŒ…ã€‚å®ƒå‘Šè¯‰ç³»ç»Ÿæ­¤æŠ¥æ–‡æ®µä¸­æœ‰ç´§æ€¥æ•°æ®ï¼Œåº”å°½å¿«ä¼ é€(ç›¸å½“äºé«˜ä¼˜å…ˆçº§çš„æ•°æ®)ï¼Œ ä¸”ä¸Šå›¾ä¸­çš„ Urgent Pointer å­—æ®µä¹Ÿä¼šè¢«å¯ç”¨ã€‚
* ACKï¼šç¡®è®¤æ¯”ç‰¹ï¼ˆAcknowledgeï¼‰ã€‚åªæœ‰å½“ `ACKï¼1` æ—¶ç¡®è®¤å·å­—æ®µæ‰æœ‰æ•ˆï¼Œä»£è¡¨è¿™ä¸ªå°åŒ…ä¸ºç¡®è®¤å°åŒ…ã€‚å½“ `ACKï¼0` æ—¶ï¼Œç¡®è®¤å·æ— æ•ˆã€‚
* PSHï¼šï¼ˆPush functionï¼‰è‹¥ä¸º 1 æ—¶ï¼Œä»£è¡¨è¦æ±‚å¯¹æ–¹ç«‹å³ä¼ é€ç¼“å†²åŒºå†…çš„å…¶ä»–å¯¹åº”å°åŒ…ï¼Œè€Œæ— éœ€ç­‰ç¼“å†²æ»¡äº†æ‰é€ã€‚
* RSTï¼šå¤ä½æ¯”ç‰¹(Reset)ï¼Œå½“ `RSTï¼1` æ—¶ï¼Œè¡¨æ˜ TCP è¿æ¥ä¸­å‡ºç°ä¸¥é‡å·®é”™ï¼ˆå¦‚ç”±äºä¸»æœºå´©æºƒæˆ–å…¶ä»–åŸå› ï¼‰ï¼Œå¿…é¡»é‡Šæ”¾è¿æ¥ï¼Œç„¶åå†é‡æ–°å»ºç«‹è¿è¾“è¿æ¥ã€‚
* SYNï¼šåŒæ­¥æ¯”ç‰¹(Synchronous)ï¼ŒSYN ç½®ä¸º 1ï¼Œå°±è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥è¯·æ±‚æˆ–è¿æ¥æ¥å—æŠ¥æ–‡ï¼Œé€šå¸¸å¸¦æœ‰ SYN æ ‡å¿—çš„å°åŒ…è¡¨ç¤ºã€ä¸»åŠ¨ã€è¦è¿æ¥åˆ°å¯¹æ–¹çš„æ„æ€ã€‚
* FINï¼šç»ˆæ­¢æ¯”ç‰¹(Final)ï¼Œç”¨æ¥é‡Šæ”¾ä¸€ä¸ªè¿æ¥ã€‚å½“ `FINï¼1` æ—¶ï¼Œè¡¨æ˜æ­¤æŠ¥æ–‡æ®µçš„å‘é€ç«¯çš„æ•°æ®å·²å‘é€å®Œæ¯•ï¼Œå¹¶è¦æ±‚é‡Šæ”¾è¿è¾“è¿æ¥ã€‚

#### UDP

* UDPï¼ˆUser Datagram Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰æ˜¯ OSIï¼ˆOpen System Interconnection å¼€æ”¾å¼ç³»ç»Ÿäº’è”ï¼‰ å‚è€ƒæ¨¡å‹ä¸­ä¸€ç§æ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ï¼Œæä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¸å¯é ä¿¡æ¯ä¼ é€æœåŠ¡ï¼Œå…¶ä¼ è¾“çš„å•ä½æ˜¯ç”¨æˆ·æ•°æ®æŠ¥ã€‚

ç‰¹å¾ï¼š

* æ— è¿æ¥
* å°½æœ€å¤§åŠªåŠ›äº¤ä»˜
* é¢å‘æŠ¥æ–‡
* æ²¡æœ‰æ‹¥å¡æ§åˆ¶
* æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡
* é¦–éƒ¨å¼€é”€å°

UDP æŠ¥æ–‡ç»“æ„

![UDP æŠ¥æ–‡](https://gitee.com/huihut/interview/raw/master/images/UDPæŠ¥æ–‡.png)

UDP é¦–éƒ¨

![UDP é¦–éƒ¨](https://gitee.com/huihut/interview/raw/master/images/UDPé¦–éƒ¨.png)

> TCP/UDP å›¾ç‰‡æ¥æºäºï¼š<https://github.com/JerryC8080/understand-tcp-udp>

#### TCP ä¸ UDP çš„åŒºåˆ«

1. TCP é¢å‘è¿æ¥ï¼ŒUDP æ˜¯æ— è¿æ¥çš„ï¼›
2. TCP æä¾›å¯é çš„æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ TCP è¿æ¥ä¼ é€çš„æ•°æ®ï¼Œæ— å·®é”™ï¼Œä¸ä¸¢å¤±ï¼Œä¸é‡å¤ï¼Œä¸”æŒ‰åºåˆ°è¾¾ï¼›UDP å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œå³ä¸ä¿è¯å¯é äº¤ä»˜
3. TCP çš„é€»è¾‘é€šä¿¡ä¿¡é“æ˜¯å…¨åŒå·¥çš„å¯é ä¿¡é“ï¼›UDP åˆ™æ˜¯ä¸å¯é ä¿¡é“
4. æ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æ˜¯ç‚¹åˆ°ç‚¹çš„ï¼›UDP æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡
5. TCP é¢å‘å­—èŠ‚æµï¼ˆå¯èƒ½å‡ºç°é»åŒ…é—®é¢˜ï¼‰ï¼Œå®é™…ä¸Šæ˜¯ TCP æŠŠæ•°æ®çœ‹æˆä¸€è¿ä¸²æ— ç»“æ„çš„å­—èŠ‚æµï¼›UDP æ˜¯é¢å‘æŠ¥æ–‡çš„ï¼ˆä¸ä¼šå‡ºç°é»åŒ…é—®é¢˜ï¼‰
6. UDP æ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œå› æ­¤ç½‘ç»œå‡ºç°æ‹¥å¡ä¸ä¼šä½¿æºä¸»æœºçš„å‘é€é€Ÿç‡é™ä½ï¼ˆå¯¹å®æ—¶åº”ç”¨å¾ˆæœ‰ç”¨ï¼Œå¦‚ IP ç”µè¯ï¼Œå®æ—¶è§†é¢‘ä¼šè®®ç­‰ï¼‰
7. TCP é¦–éƒ¨å¼€é”€20å­—èŠ‚ï¼›UDP çš„é¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰ 8 ä¸ªå­—èŠ‚

#### TCP é»åŒ…é—®é¢˜

##### é»åŒ…åŸå› 

TCP æ˜¯ä¸€ä¸ªåŸºäºå­—èŠ‚æµçš„ä¼ è¾“æœåŠ¡ï¼ˆUDP åŸºäºæŠ¥æ–‡çš„ï¼‰ï¼Œâ€œæµâ€ æ„å‘³ç€ TCP æ‰€ä¼ è¾“çš„æ•°æ®æ˜¯æ²¡æœ‰è¾¹ç•Œçš„ã€‚æ‰€ä»¥å¯èƒ½ä¼šå‡ºç°ä¸¤ä¸ªæ•°æ®åŒ…é»åœ¨ä¸€èµ·çš„æƒ…å†µã€‚

##### è§£å†³

* å‘é€å®šé•¿åŒ…ã€‚å¦‚æœæ¯ä¸ªæ¶ˆæ¯çš„å¤§å°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆåœ¨æ¥æ”¶å¯¹ç­‰æ–¹åªè¦ç´¯è®¡æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°æ•°æ®ç­‰äºä¸€ä¸ªå®šé•¿çš„æ•°å€¼å°±å°†å®ƒä½œä¸ºä¸€ä¸ªæ¶ˆæ¯ã€‚
* åŒ…å¤´åŠ ä¸ŠåŒ…ä½“é•¿åº¦ã€‚åŒ…å¤´æ˜¯å®šé•¿çš„ 4 ä¸ªå­—èŠ‚ï¼Œè¯´æ˜äº†åŒ…ä½“çš„é•¿åº¦ã€‚æ¥æ”¶å¯¹ç­‰æ–¹å…ˆæ¥æ”¶åŒ…å¤´é•¿åº¦ï¼Œä¾æ®åŒ…å¤´é•¿åº¦æ¥æ¥æ”¶åŒ…ä½“ã€‚
* åœ¨æ•°æ®åŒ…ä¹‹é—´è®¾ç½®è¾¹ç•Œï¼Œå¦‚æ·»åŠ ç‰¹æ®Šç¬¦å· `\r\n` æ ‡è®°ã€‚FTP åè®®æ­£æ˜¯è¿™ä¹ˆåšçš„ã€‚ä½†é—®é¢˜åœ¨äºå¦‚æœæ•°æ®æ­£æ–‡ä¸­ä¹Ÿå«æœ‰ `\r\n`ï¼Œåˆ™ä¼šè¯¯åˆ¤ä¸ºæ¶ˆæ¯çš„è¾¹ç•Œã€‚
* ä½¿ç”¨æ›´åŠ å¤æ‚çš„åº”ç”¨å±‚åè®®ã€‚

#### TCP æµé‡æ§åˆ¶

##### æ¦‚æµé‡æ§åˆ¶å¿µ

æµé‡æ§åˆ¶ï¼ˆflow controlï¼‰å°±æ˜¯è®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚

##### æ–¹æ³•

åˆ©ç”¨å¯å˜çª—å£è¿›è¡Œæµé‡æ§åˆ¶

![1](https://gitee.com/huihut/interview/raw/master/images/åˆ©ç”¨å¯å˜çª—å£è¿›è¡Œæµé‡æ§åˆ¶ä¸¾ä¾‹.png)

#### TCP æ‹¥å¡æ§åˆ¶

##### æ‹¥å¡æ§åˆ¶æ¦‚å¿µ

æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚

##### æ‹¥å¡æ§åˆ¶æ–¹æ³•

* æ…¢å¼€å§‹( slow-start )
* æ‹¥å¡é¿å…( congestion avoidance )
* å¿«é‡ä¼ ( fast retransmit )
* å¿«æ¢å¤( fast recovery )

TCPçš„æ‹¥å¡æ§åˆ¶å›¾

![1](https://gitee.com/huihut/interview/raw/master/images/TCPæ‹¥å¡çª—å£cwndåœ¨æ‹¥å¡æ§åˆ¶æ—¶çš„å˜åŒ–æƒ…å†µ.png)
![2](https://gitee.com/huihut/interview/raw/master/images/å¿«é‡ä¼ ç¤ºæ„å›¾.png)
![3](https://gitee.com/huihut/interview/raw/master/images/TCPçš„æ‹¥å¡æ§åˆ¶æµç¨‹å›¾.png)

#### TCP ä¼ è¾“è¿æ¥ç®¡ç†

> å› ä¸º TCP ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ã€å››æ¬¡æŒ¥æ‰‹é‡Šæ”¾è¿æ¥å¾ˆé‡è¦ï¼Œæ‰€ä»¥é™„ä¸Šã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ 7 ç‰ˆï¼‰-è°¢å¸Œä»ã€‹ä¹¦ä¸­å¯¹æ­¤ç« çš„è¯¦ç»†æè¿°ï¼š<https://gitee.com/huihut/interview/raw/master/images/TCP-transport-connection-management.png>

##### TCP ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥

![UDP æŠ¥æ–‡](https://gitee.com/huihut/interview/raw/master/images/TCPä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥.png)

ã€TCP å»ºç«‹è¿æ¥å…¨è¿‡ç¨‹è§£é‡Šã€‘

1. å®¢æˆ·ç«¯å‘é€ SYN ç»™æœåŠ¡å™¨ï¼Œè¯´æ˜å®¢æˆ·ç«¯è¯·æ±‚å»ºç«‹è¿æ¥ï¼›
2. æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯å‘çš„ SYNï¼Œå¹¶å›å¤ SYN+ACK ç»™å®¢æˆ·ç«¯ï¼ˆåŒæ„å»ºç«‹è¿æ¥ï¼‰ï¼›
3. å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ SYN+ACK åï¼Œå›å¤ ACK ç»™æœåŠ¡ç«¯ï¼ˆè¡¨ç¤ºå®¢æˆ·ç«¯æ”¶åˆ°äº†æœåŠ¡ç«¯å‘çš„åŒæ„æŠ¥æ–‡ï¼‰ï¼›
4. æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ ACKï¼Œè¿æ¥å·²å»ºç«‹ï¼Œå¯ä»¥æ•°æ®ä¼ è¾“ã€‚

##### TCP ä¸ºä»€ä¹ˆè¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ

ã€ç­”æ¡ˆä¸€ã€‘å› ä¸ºä¿¡é“ä¸å¯é ï¼Œè€Œ TCP æƒ³åœ¨ä¸å¯é ä¿¡é“ä¸Šå»ºç«‹å¯é åœ°ä¼ è¾“ï¼Œé‚£ä¹ˆä¸‰æ¬¡é€šä¿¡æ˜¯ç†è®ºä¸Šçš„æœ€å°å€¼ã€‚ï¼ˆè€Œ UDP åˆ™ä¸éœ€å»ºç«‹å¯é ä¼ è¾“ï¼Œå› æ­¤ UDP ä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ã€‚ï¼‰

> [Google Groups . TCP å»ºç«‹è¿æ¥ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ{æŠ€æœ¯}{ç½‘ç»œé€šä¿¡}](https://groups.google.com/forum/#!msg/pongba/kF6O7-MFxM0/5S7zIJ4yqKUJ)

ã€ç­”æ¡ˆäºŒã€‘å› ä¸ºåŒæ–¹éƒ½éœ€è¦ç¡®è®¤å¯¹æ–¹æ”¶åˆ°äº†è‡ªå·±å‘é€çš„åºåˆ—å·ï¼Œç¡®è®¤è¿‡ç¨‹æœ€å°‘è¦è¿›è¡Œä¸‰æ¬¡é€šä¿¡ã€‚

> [çŸ¥ä¹ . TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ](https://www.zhihu.com/question/24853633/answer/115173386)

ã€ç­”æ¡ˆä¸‰ã€‘ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚

> [ã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ 7 ç‰ˆï¼‰-è°¢å¸Œä»ã€‹](https://gitee.com/huihut/interview/raw/master/images/TCP-transport-connection-management.png)

##### TCP å››æ¬¡æŒ¥æ‰‹é‡Šæ”¾è¿æ¥

![UDP æŠ¥æ–‡](https://gitee.com/huihut/interview/raw/master/images/TCPå››æ¬¡æŒ¥æ‰‹é‡Šæ”¾è¿æ¥.png)

ã€TCP é‡Šæ”¾è¿æ¥å…¨è¿‡ç¨‹è§£é‡Šã€‘

1. å®¢æˆ·ç«¯å‘é€ FIN ç»™æœåŠ¡å™¨ï¼Œè¯´æ˜å®¢æˆ·ç«¯ä¸å¿…å‘é€æ•°æ®ç»™æœåŠ¡å™¨äº†ï¼ˆè¯·æ±‚é‡Šæ”¾ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¿æ¥ï¼‰ï¼›
2. æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘çš„ FINï¼Œå¹¶å›å¤ ACK ç»™å®¢æˆ·ç«¯ï¼ˆåŒæ„é‡Šæ”¾ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¿æ¥ï¼‰ï¼›
3. å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯å›å¤çš„ ACKï¼Œæ­¤æ—¶ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¿æ¥å·²é‡Šæ”¾ï¼ˆä½†æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯çš„è¿æ¥è¿˜æœªé‡Šæ”¾ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯è¿˜å¯ä»¥æ¥æ”¶æ•°æ®ï¼‰ï¼›
4. æœåŠ¡ç«¯ç»§ç»­å‘é€ä¹‹å‰æ²¡å‘å®Œçš„æ•°æ®ç»™å®¢æˆ·ç«¯ï¼›
5. æœåŠ¡ç«¯å‘é€ FIN+ACK ç»™å®¢æˆ·ç«¯ï¼Œè¯´æ˜æœåŠ¡ç«¯å‘é€å®Œäº†æ•°æ®ï¼ˆè¯·æ±‚é‡Šæ”¾ä»æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå°±ç®—æ²¡æ”¶åˆ°å®¢æˆ·ç«¯çš„å›å¤ï¼Œè¿‡æ®µæ—¶é—´ä¹Ÿä¼šè‡ªåŠ¨é‡Šæ”¾ï¼‰ï¼›
6. å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ FIN+ACKï¼Œå¹¶å›å¤ ACK ç»™æœåŠ¡ç«¯ï¼ˆåŒæ„é‡Šæ”¾ä»æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯çš„è¿æ¥ï¼‰ï¼›
7. æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ ACK åï¼Œé‡Šæ”¾ä»æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯çš„è¿æ¥ã€‚

##### TCP ä¸ºä»€ä¹ˆè¦è¿›è¡Œå››æ¬¡æŒ¥æ‰‹ï¼Ÿ

ã€é—®é¢˜ä¸€ã€‘TCP ä¸ºä»€ä¹ˆè¦è¿›è¡Œå››æ¬¡æŒ¥æ‰‹ï¼Ÿ / ä¸ºä»€ä¹ˆ TCP å»ºç«‹è¿æ¥éœ€è¦ä¸‰æ¬¡ï¼Œè€Œé‡Šæ”¾è¿æ¥åˆ™éœ€è¦å››æ¬¡ï¼Ÿ

ã€ç­”æ¡ˆä¸€ã€‘å› ä¸º TCP æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œå®¢æˆ·ç«¯è¯·æ±‚å…³é—­è¿æ¥åï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯çš„è¿æ¥å…³é—­ï¼ˆä¸€äºŒæ¬¡æŒ¥æ‰‹ï¼‰ï¼ŒæœåŠ¡ç«¯ç»§ç»­ä¼ è¾“ä¹‹å‰æ²¡ä¼ å®Œçš„æ•°æ®ç»™å®¢æˆ·ç«¯ï¼ˆæ•°æ®ä¼ è¾“ï¼‰ï¼ŒæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯çš„è¿æ¥å…³é—­ï¼ˆä¸‰å››æ¬¡æŒ¥æ‰‹ï¼‰ã€‚æ‰€ä»¥ TCP é‡Šæ”¾è¿æ¥æ—¶æœåŠ¡å™¨çš„ ACK å’Œ FIN æ˜¯åˆ†å¼€å‘é€çš„ï¼ˆä¸­é—´éš”ç€æ•°æ®ä¼ è¾“ï¼‰ï¼Œè€Œ TCP å»ºç«‹è¿æ¥æ—¶æœåŠ¡å™¨çš„ ACK å’Œ SYN æ˜¯ä¸€èµ·å‘é€çš„ï¼ˆç¬¬äºŒæ¬¡æ¡æ‰‹ï¼‰ï¼Œæ‰€ä»¥ TCP å»ºç«‹è¿æ¥éœ€è¦ä¸‰æ¬¡ï¼Œè€Œé‡Šæ”¾è¿æ¥åˆ™éœ€è¦å››æ¬¡ã€‚

ã€é—®é¢˜äºŒã€‘ä¸ºä»€ä¹ˆ TCP è¿æ¥æ—¶å¯ä»¥ ACK å’Œ SYN ä¸€èµ·å‘é€ï¼Œè€Œé‡Šæ”¾æ—¶åˆ™ ACK å’Œ FIN åˆ†å¼€å‘é€å‘¢ï¼Ÿï¼ˆACK å’Œ FIN åˆ†å¼€æ˜¯æŒ‡ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼‰

ã€ç­”æ¡ˆäºŒã€‘å› ä¸ºå®¢æˆ·ç«¯è¯·æ±‚é‡Šæ”¾æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå› æ­¤æœåŠ¡ç«¯è¦å…ˆå“åº”å®¢æˆ·ç«¯ FIN è¯·æ±‚ï¼ˆæœåŠ¡ç«¯å‘é€ ACKï¼‰ï¼Œç„¶åæ•°æ®ä¼ è¾“ï¼Œä¼ è¾“å®Œæˆåï¼ŒæœåŠ¡ç«¯å†æå‡º FIN è¯·æ±‚ï¼ˆæœåŠ¡ç«¯å‘é€ FINï¼‰ï¼›è€Œè¿æ¥æ—¶åˆ™æ²¡æœ‰ä¸­é—´çš„æ•°æ®ä¼ è¾“ï¼Œå› æ­¤è¿æ¥æ—¶å¯ä»¥ ACK å’Œ SYN ä¸€èµ·å‘é€ã€‚

ã€é—®é¢˜ä¸‰ã€‘ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯é‡Šæ”¾æœ€åéœ€è¦ TIME-WAIT ç­‰å¾… 2MSL å‘¢ï¼Ÿ

ã€ç­”æ¡ˆä¸‰ã€‘

1. ä¸ºäº†ä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡ç«¯ã€‚è‹¥æœªæˆåŠŸåˆ°è¾¾ï¼Œåˆ™æœåŠ¡ç«¯è¶…æ—¶é‡ä¼  FIN+ACK æŠ¥æ–‡æ®µï¼Œå®¢æˆ·ç«¯å†é‡ä¼  ACKï¼Œå¹¶é‡æ–°è®¡æ—¶ã€‚
2. é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚TIME-WAIT æŒç»­ 2MSL å¯ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œè¿™æ ·å¯ä½¿ä¸‹æ¬¡è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§çš„è¿æ¥æŠ¥æ–‡æ®µã€‚

#### TCP æœ‰é™çŠ¶æ€æœº

TCP æœ‰é™çŠ¶æ€æœºå›¾ç‰‡

![TCP çš„æœ‰é™çŠ¶æ€æœº](https://gitee.com/huihut/interview/raw/master/images/TCPçš„æœ‰é™çŠ¶æ€æœº.png)

### åº”ç”¨å±‚

#### DNS

* DNSï¼ˆDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿï¼‰æ˜¯äº’è”ç½‘çš„ä¸€é¡¹æœåŠ¡ã€‚å®ƒä½œä¸ºå°†åŸŸåå’Œ IP åœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿äººæ›´æ–¹ä¾¿åœ°è®¿é—®äº’è”ç½‘ã€‚DNS ä½¿ç”¨ TCP å’Œ UDP ç«¯å£ 53ã€‚å½“å‰ï¼Œå¯¹äºæ¯ä¸€çº§åŸŸåé•¿åº¦çš„é™åˆ¶æ˜¯ 63 ä¸ªå­—ç¬¦ï¼ŒåŸŸåæ€»é•¿åº¦åˆ™ä¸èƒ½è¶…è¿‡ 253 ä¸ªå­—ç¬¦ã€‚

åŸŸåï¼š

* `åŸŸå ::= {<ä¸‰çº§åŸŸå>.<äºŒçº§åŸŸå>.<é¡¶çº§åŸŸå>}`ï¼Œå¦‚ï¼š`blog.huihut.com`

#### FTP

* FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ç”¨äºåœ¨ç½‘ç»œä¸Šè¿›è¡Œæ–‡ä»¶ä¼ è¾“çš„ä¸€å¥—æ ‡å‡†åè®®ï¼Œä½¿ç”¨å®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ï¼Œä½¿ç”¨ TCP æ•°æ®æŠ¥ï¼Œæä¾›äº¤äº’å¼è®¿é—®ï¼ŒåŒå‘ä¼ è¾“ã€‚
* TFTPï¼ˆTrivial File Transfer Protocolï¼Œç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰ä¸€ä¸ªå°ä¸”æ˜“å®ç°çš„æ–‡ä»¶ä¼ è¾“åè®®ï¼Œä¹Ÿä½¿ç”¨å®¢æˆ·-æœåŠ¡å™¨æ–¹å¼ï¼Œä½¿ç”¨UDPæ•°æ®æŠ¥ï¼Œåªæ”¯æŒæ–‡ä»¶ä¼ è¾“è€Œä¸æ”¯æŒäº¤äº’ï¼Œæ²¡æœ‰åˆ—ç›®å½•ï¼Œä¸èƒ½å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½é‰´å®š

#### TELNET

* TELNET åè®®æ˜¯ TCP/IP åè®®æ—ä¸­çš„ä¸€å‘˜ï¼Œæ˜¯ Internet è¿œç¨‹ç™»é™†æœåŠ¡çš„æ ‡å‡†åè®®å’Œä¸»è¦æ–¹å¼ã€‚å®ƒä¸ºç”¨æˆ·æä¾›äº†åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå®Œæˆè¿œç¨‹ä¸»æœºå·¥ä½œçš„èƒ½åŠ›ã€‚

* HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯ç”¨äºä» WWWï¼ˆWorld Wide Webï¼Œä¸‡ç»´ç½‘ï¼‰æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚

* SMTPï¼ˆSimple Mail Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç»„ç”¨äºç”±æºåœ°å€åˆ°ç›®çš„åœ°å€ä¼ é€é‚®ä»¶çš„è§„åˆ™ï¼Œç”±å®ƒæ¥æ§åˆ¶ä¿¡ä»¶çš„ä¸­è½¬æ–¹å¼ã€‚SMTP åè®®å±äº TCP/IP åè®®ç°‡ï¼Œå®ƒå¸®åŠ©æ¯å°è®¡ç®—æœºåœ¨å‘é€æˆ–ä¸­è½¬ä¿¡ä»¶æ—¶æ‰¾åˆ°ä¸‹ä¸€ä¸ªç›®çš„åœ°ã€‚
* Socket å»ºç«‹ç½‘ç»œé€šä¿¡è¿æ¥è‡³å°‘è¦ä¸€å¯¹ç«¯å£å·ï¼ˆSocketï¼‰ã€‚Socket æœ¬è´¨æ˜¯ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ï¼Œå¯¹ TCP/IP çš„å°è£…ï¼ŒTCP/IP ä¹Ÿè¦æä¾›å¯ä¾›ç¨‹åºå‘˜åšç½‘ç»œå¼€å‘æ‰€ç”¨çš„æ¥å£ï¼Œè¿™å°±æ˜¯ Socket ç¼–ç¨‹æ¥å£ã€‚

#### WWW

* WWWï¼ˆWorld Wide Webï¼Œç¯çƒä¿¡æ¯ç½‘ï¼Œä¸‡ç»´ç½‘ï¼‰æ˜¯ä¸€ä¸ªç”±è®¸å¤šäº’ç›¸é“¾æ¥çš„è¶…æ–‡æœ¬ç»„æˆçš„ç³»ç»Ÿï¼Œé€šè¿‡äº’è”ç½‘è®¿é—®

##### URL

* URLï¼ˆUniform Resource Locatorï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æ˜¯å› ç‰¹ç½‘ä¸Šæ ‡å‡†çš„èµ„æºçš„åœ°å€ï¼ˆAddressï¼‰

æ ‡å‡†æ ¼å¼ï¼š

* `åè®®ç±»å‹:[//æœåŠ¡å™¨åœ°å€[:ç«¯å£å·]][/èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„]æ–‡ä»¶å[?æŸ¥è¯¢][#ç‰‡æ®µID]`

å®Œæ•´æ ¼å¼ï¼š

* `åè®®ç±»å‹:[//[è®¿é—®èµ„æºéœ€è¦çš„å‡­è¯ä¿¡æ¯@]æœåŠ¡å™¨åœ°å€[:ç«¯å£å·]][/èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„]æ–‡ä»¶å[?æŸ¥è¯¢][#ç‰‡æ®µID]`

> å…¶ä¸­ã€è®¿é—®å‡­è¯ä¿¡æ¯@ï¼›:ç«¯å£å·ï¼›?æŸ¥è¯¢ï¼›#ç‰‡æ®µIDã€‘éƒ½å±äºé€‰å¡«é¡¹  
> å¦‚ï¼š`https://github.com/huihut/interview#cc`

##### HTTP

HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„åº”ç”¨å±‚åè®®ã€‚HTTP æ˜¯ä¸‡ç»´ç½‘çš„æ•°æ®é€šä¿¡çš„åŸºç¡€ã€‚

è¯·æ±‚æ–¹æ³•

æ–¹æ³• | æ„ä¹‰
--- | ---
OPTIONS | è¯·æ±‚ä¸€äº›é€‰é¡¹ä¿¡æ¯ï¼Œå…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½
GET | è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“
HEAD | ç±»ä¼¼äº get è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´
POST | å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹
PUT | ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹
DELETE | è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢
TRACE | å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­

çŠ¶æ€ç ï¼ˆStatus-Codeï¼‰

* 1xxï¼šè¡¨ç¤ºé€šçŸ¥ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ”¶åˆ°äº†æˆ–æ­£åœ¨è¿›è¡Œå¤„ç†
  * 100 Continueï¼šç»§ç»­ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚
  * 101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ° HTTP çš„æ–°ç‰ˆæœ¬åè®®
* 2xxï¼šè¡¨ç¤ºæˆåŠŸï¼Œå¦‚æ¥æ”¶æˆ–çŸ¥é“äº†
  * 200 OK: è¯·æ±‚æˆåŠŸ
* 3xxï¼šè¡¨ç¤ºé‡å®šå‘ï¼Œå¦‚è¦å®Œæˆè¯·æ±‚è¿˜å¿…é¡»é‡‡å–è¿›ä¸€æ­¥çš„è¡ŒåŠ¨
  * 301 Moved Permanently: æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–° URLï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„ URLï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–° URLã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„ URL ä»£æ›¿
* 4xxï¼šè¡¨ç¤ºå®¢æˆ·çš„å·®é”™ï¼Œå¦‚è¯·æ±‚ä¸­æœ‰é”™è¯¯çš„è¯­æ³•æˆ–ä¸èƒ½å®Œæˆ
  * 400 Bad Request: å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£
  * 401 Unauthorized: è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯
  * 403 Forbidden: æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚ï¼ˆæƒé™ä¸å¤Ÿï¼‰
  * 404 Not Found: æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½® â€œæ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€ çš„ä¸ªæ€§é¡µé¢
  * 408 Request Timeout: æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶
* 5xxï¼šè¡¨ç¤ºæœåŠ¡å™¨çš„å·®é”™ï¼Œå¦‚æœåŠ¡å™¨å¤±æ•ˆæ— æ³•å®Œæˆè¯·æ±‚
  * 500 Internal Server Error: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚
  * 503 Service Unavailable: ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„ Retry-After å¤´ä¿¡æ¯ä¸­
  * 504 Gateway Timeout: å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚

> æ›´å¤šçŠ¶æ€ç ï¼š[èœé¸Ÿæ•™ç¨‹ . HTTPçŠ¶æ€ç ](http://www.runoob.com/http/http-status-codes.html)

##### HTTPs

* HTTPå’ŒHTTPsåŒºåˆ«

    HTTP å’Œ HTTPS éƒ½æ˜¯ä¼ è¾“åè®®ã€‚å®ƒä»¬æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºå®‰å…¨æ€§å’ŒåŠ å¯†æœºåˆ¶ã€‚

    HTTP (Hyper Text Transfer Protocol) æ˜¯ä¸€ç§åŸºäºåº”ç”¨å±‚çš„åè®®ï¼Œå®ƒè§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æ•°æ®çš„ä¼ è¾“æ–¹å¼ï¼Œå®ƒé€šè¿‡æ˜æ–‡ä¼ è¾“æ•°æ®ï¼Œä¸æä¾›ä»»ä½•å½¢å¼çš„æ•°æ®åŠ å¯†ï¼Œå› æ­¤ä¿¡æ¯ä¼šè¢«é»‘å®¢æˆªå–å’Œçªƒå¬ã€‚è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´æ•°æ®è¢«ç¯¡æ”¹ï¼Œå› ä¸ºèº«ä»½éªŒè¯å’ŒåŠ å¯†æœºåˆ¶ç¼ºå¤±ï¼Œæ‰€ä»¥å®ƒæ— æ³•ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ã€‚HTTP åè®®é»˜è®¤ä½¿ç”¨ 80 ç«¯å£ã€‚

    HTTPS (Hyper Text Transfer Protocol Secure) æ˜¯å®‰å…¨ç‰ˆçš„ HTTPï¼Œå®ƒåœ¨ HTTP åè®®åŸºç¡€ä¸Šæ·»åŠ äº† SSL/TLS ä¼ è¾“åè®®ï¼Œå®ƒé€šè¿‡åŠ å¯†æ–¹å¼ä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ï¼Œä½¿å¾—é»‘å®¢éš¾ä»¥çªƒå¬ä½ ä¼ è¾“çš„æ•°æ®ã€‚HTTPS ä½¿ç”¨ SSL æˆ– TLS åŠ å¯†æ•°æ®ï¼Œè¿™æ„å‘³ç€å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“çš„æ•°æ®è¢«åŠ å¯†å¹¶ç¡®è®¤èº«ä»½ï¼Œé˜²æ­¢æ•°æ®åœ¨ç½‘ç»œä¸­è¢«ç¯¡æ”¹ã€‚HTTPS åè®®é»˜è®¤ä½¿ç”¨ 443 ç«¯å£ã€‚

    å…·ä½“æ¥è¯´ï¼ŒHTTPS é€šè¿‡ä½¿ç”¨ SSL/TLS åè®®æ¥ä¿æŠ¤ Web æ•°æ®ä¼ è¾“ã€‚SSL åè®®ä½¿ç”¨å…¬é’¥å’Œç§é’¥æ¥åŠ å¯†æ•°æ®ã€‚å…¬é’¥è¡¨ç¤ºåæ˜ äº†æœåŠ¡å™¨çš„èº«ä»½çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œç§é’¥åªæœ‰æœåŠ¡å™¨è‡ªå·±æ‹¥æœ‰ã€‚å½“ä¸€ä¸ªå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°ç”±æœåŠ¡å™¨å‘é€çš„å…¬é’¥å¹¶ä½¿ç”¨å…¬é’¥åŠ å¯†æ•°æ®ã€‚æ­¤åŠ å¯†è¿‡ç¨‹ä½¿ç”¨çš„å¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰å¯ä»¥è§£å¯†ï¼Œä¿éšœäº†æ•°æ®ä¼ è¾“çš„æœºå¯†æ€§å’Œå®Œæ•´æ€§ã€‚å› æ­¤ä½¿ç”¨ HTTPS çš„ç½‘ç«™å¯ä»¥ä¿è¯ç”¨æˆ·æäº¤çš„æ•°æ®ä¸ä¼šè¢«çªƒå–æˆ–è¢«ç¯¡æ”¹ï¼Œä»è€Œæé«˜äº†å®‰å…¨æ€§ã€‚

    ç»¼ä¸Šæ‰€è¿°ï¼ŒHTTPS æ¯” HTTP æ›´åŠ å®‰å…¨ï¼Œæ‰€ä»¥ç°åœ¨å¤§éƒ¨åˆ†ç½‘ç«™éƒ½ä½¿ç”¨ HTTPS åè®®æ¥ä¿æŠ¤å®¢æˆ·æ•°æ®çš„å®‰å…¨ã€‚

* SSL/TLSåè®®

##### å…¶ä»–åè®®

* SMTPï¼ˆSimple Main Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯åœ¨ Internet ä¼ è¾“ Email çš„æ ‡å‡†ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åŸºäºæ–‡æœ¬çš„åè®®ã€‚åœ¨å…¶ä¹‹ä¸ŠæŒ‡å®šäº†ä¸€æ¡æ¶ˆæ¯çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ¥æ”¶è€…ï¼ˆåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¢«ç¡®è®¤æ˜¯å­˜åœ¨çš„ï¼‰ï¼Œç„¶åæ¶ˆæ¯æ–‡æœ¬ä¼šè¢«ä¼ è¾“ã€‚å¯ä»¥å¾ˆç®€å•åœ°é€šè¿‡ Telnet ç¨‹åºæ¥æµ‹è¯•ä¸€ä¸ª SMTP æœåŠ¡å™¨ã€‚SMTP ä½¿ç”¨ TCP ç«¯å£ 25ã€‚
* DHCPï¼ˆDynamic Host Configuration Protocolï¼ŒåŠ¨æ€ä¸»æœºè®¾ç½®åè®®ï¼‰æ˜¯ä¸€ä¸ªå±€åŸŸç½‘çš„ç½‘ç»œåè®®ï¼Œä½¿ç”¨ UDP åè®®å·¥ä½œï¼Œä¸»è¦æœ‰ä¸¤ä¸ªç”¨é€”ï¼š
  * ç”¨äºå†…éƒ¨ç½‘ç»œæˆ–ç½‘ç»œæœåŠ¡ä¾›åº”å•†è‡ªåŠ¨åˆ†é… IP åœ°å€ç»™ç”¨æˆ·
  * ç”¨äºå†…éƒ¨ç½‘ç»œç®¡ç†å‘˜ä½œä¸ºå¯¹æ‰€æœ‰ç”µè„‘ä½œä¸­å¤®ç®¡ç†çš„æ‰‹æ®µ
* SNMPï¼ˆSimple Network Management Protocolï¼Œç®€å•ç½‘ç»œç®¡ç†åè®®ï¼‰æ„æˆäº†äº’è”ç½‘å·¥ç¨‹å·¥ä½œå°ç»„ï¼ˆIETFï¼ŒInternet Engineering Task Forceï¼‰å®šä¹‰çš„ Internet åè®®æ—çš„ä¸€éƒ¨åˆ†ã€‚è¯¥åè®®èƒ½å¤Ÿæ”¯æŒç½‘ç»œç®¡ç†ç³»ç»Ÿï¼Œç”¨ä»¥ç›‘æµ‹è¿æ¥åˆ°ç½‘ç»œä¸Šçš„è®¾å¤‡æ˜¯å¦æœ‰ä»»ä½•å¼•èµ·ç®¡ç†ä¸Šå…³æ³¨çš„æƒ…å†µã€‚

<a id="database"></a>

## ğŸ’¾ æ•°æ®åº“

> æœ¬èŠ‚éƒ¨åˆ†çŸ¥è¯†ç‚¹æ¥è‡ªã€Šæ•°æ®åº“ç³»ç»Ÿæ¦‚è®ºï¼ˆç¬¬ 5 ç‰ˆï¼‰ã€‹

### åŸºæœ¬æ¦‚å¿µ

* æ•°æ®ï¼ˆdataï¼‰ï¼šæè¿°äº‹ç‰©çš„ç¬¦å·è®°å½•ç§°ä¸ºæ•°æ®ã€‚
* æ•°æ®åº“ï¼ˆDataBaseï¼ŒDBï¼‰ï¼šæ˜¯é•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡çš„ã€å¯å…±äº«çš„å¤§é‡æ•°æ®çš„é›†åˆï¼Œå…·æœ‰æ°¸ä¹…å­˜å‚¨ã€æœ‰ç»„ç»‡ã€å¯å…±äº«ä¸‰ä¸ªåŸºæœ¬ç‰¹ç‚¹ã€‚
* æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDataBase Management Systemï¼ŒDBMSï¼‰ï¼šæ˜¯ä½äºç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„ä¸€å±‚æ•°æ®ç®¡ç†è½¯ä»¶ã€‚
* æ•°æ®åº“ç³»ç»Ÿï¼ˆDataBase Systemï¼ŒDBSï¼‰ï¼šæ˜¯æœ‰æ•°æ®åº“ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆåŠå…¶åº”ç”¨å¼€å‘å·¥å…·ï¼‰ã€åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ç®¡ç†å‘˜ï¼ˆDataBase Administrator DBAï¼‰ç»„æˆçš„å­˜å‚¨ã€ç®¡ç†ã€å¤„ç†å’Œç»´æŠ¤æ•°æ®çš„ç³»ç»Ÿã€‚
* å®ä½“ï¼ˆentityï¼‰ï¼šå®¢è§‚å­˜åœ¨å¹¶å¯ç›¸äº’åŒºåˆ«çš„äº‹ç‰©ç§°ä¸ºå®ä½“ã€‚
* å±æ€§ï¼ˆattributeï¼‰ï¼šå®ä½“æ‰€å…·æœ‰çš„æŸä¸€ç‰¹æ€§ç§°ä¸ºå±æ€§ã€‚
* ç ï¼ˆkeyï¼‰ï¼šå”¯ä¸€æ ‡è¯†å®ä½“çš„å±æ€§é›†ç§°ä¸ºç ã€‚
* å®ä½“å‹ï¼ˆentity typeï¼‰ï¼šç”¨å®ä½“ååŠå…¶å±æ€§åé›†åˆæ¥æŠ½è±¡å’Œåˆ»ç”»åŒç±»å®ä½“ï¼Œç§°ä¸ºå®ä½“å‹ã€‚
* å®ä½“é›†ï¼ˆentity setï¼‰ï¼šåŒä¸€å®ä½“å‹çš„é›†åˆç§°ä¸ºå®ä½“é›†ã€‚
* è”ç³»ï¼ˆrelationshipï¼‰ï¼šå®ä½“ä¹‹é—´çš„è”ç³»é€šå¸¸æ˜¯æŒ‡ä¸åŒå®ä½“é›†ä¹‹é—´çš„è”ç³»ã€‚
* æ¨¡å¼ï¼ˆschemaï¼‰ï¼šæ¨¡å¼ä¹Ÿç§°é€»è¾‘æ¨¡å¼ï¼Œæ˜¯æ•°æ®åº“å…¨ä½“æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œæ˜¯æ‰€æœ‰ç”¨æˆ·çš„å…¬å…±æ•°æ®è§†å›¾ã€‚
* å¤–æ¨¡å¼ï¼ˆexternal schemaï¼‰ï¼šå¤–æ¨¡å¼ä¹Ÿç§°å­æ¨¡å¼ï¼ˆsubschemaï¼‰æˆ–ç”¨æˆ·æ¨¡å¼ï¼Œå®ƒæ˜¯æ•°æ®åº“ç”¨æˆ·ï¼ˆåŒ…æ‹¬åº”ç”¨ç¨‹åºå‘˜å’Œæœ€ç»ˆç”¨æˆ·ï¼‰èƒ½å¤Ÿçœ‹è§å’Œä½¿ç”¨çš„å±€éƒ¨æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œæ˜¯æ•°æ®åº“ç”¨æˆ·çš„æ•°æ®è§†å›¾ï¼Œæ˜¯ä¸æŸä¸€åº”ç”¨æœ‰å…³çš„æ•°æ®çš„é€»è¾‘è¡¨ç¤ºã€‚
* å†…æ¨¡å¼ï¼ˆinternal schemaï¼‰ï¼šå†…æ¨¡å¼ä¹Ÿç§°ä¸ºå­˜å‚¨æ¨¡å¼ï¼ˆstorage schemaï¼‰ï¼Œä¸€ä¸ªæ•°æ®åº“åªæœ‰ä¸€ä¸ªå†…æ¨¡å¼ã€‚ä»–æ˜¯æ•°æ®ç‰©ç†ç»“æ„å’Œå­˜å‚¨æ–¹å¼çš„æè¿°ï¼Œæ˜¯æ•°æ®åº“åœ¨æ•°æ®åº“å†…éƒ¨çš„ç»„ç»‡æ–¹å¼ã€‚

### å¸¸ç”¨æ•°æ®æ¨¡å‹

* å±‚æ¬¡æ¨¡å‹ï¼ˆhierarchical modelï¼‰
* ç½‘çŠ¶æ¨¡å‹ï¼ˆnetwork modelï¼‰
* å…³ç³»æ¨¡å‹ï¼ˆrelational modelï¼‰
    * å…³ç³»ï¼ˆrelationï¼‰ï¼šä¸€ä¸ªå…³ç³»å¯¹åº”é€šå¸¸è¯´çš„ä¸€å¼ è¡¨
    * å…ƒç»„ï¼ˆtupleï¼‰ï¼šè¡¨ä¸­çš„ä¸€è¡Œå³ä¸ºä¸€ä¸ªå…ƒç»„
    * å±æ€§ï¼ˆattributeï¼‰ï¼šè¡¨ä¸­çš„ä¸€åˆ—å³ä¸ºä¸€ä¸ªå±æ€§
    * ç ï¼ˆkeyï¼‰ï¼šè¡¨ä¸­å¯ä»¥å”¯ä¸€ç¡®å®šä¸€ä¸ªå…ƒç»„çš„æŸä¸ªå±æ€§ç»„
    * åŸŸï¼ˆdomainï¼‰ï¼šä¸€ç»„å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„å€¼çš„é›†åˆ
    * åˆ†é‡ï¼šå…ƒç»„ä¸­çš„ä¸€ä¸ªå±æ€§å€¼
    * å…³ç³»æ¨¡å¼ï¼šå¯¹å…³ç³»çš„æè¿°ï¼Œä¸€èˆ¬è¡¨ç¤ºä¸º `å…³ç³»å(å±æ€§1, å±æ€§2, ..., å±æ€§n)`
* é¢å‘å¯¹è±¡æ•°æ®æ¨¡å‹ï¼ˆobject oriented data modelï¼‰
* å¯¹è±¡å…³ç³»æ•°æ®æ¨¡å‹ï¼ˆobject relational data modelï¼‰
* åŠç»“æ„åŒ–æ•°æ®æ¨¡å‹ï¼ˆsemistructure data modelï¼‰

### å¸¸ç”¨ SQL æ“ä½œ

<table>
  <tr>
    <th>å¯¹è±¡ç±»å‹</th>
    <th>å¯¹è±¡</th>
    <th>æ“ä½œç±»å‹</th>
  </tr>
  <tr>
    <td rowspan="4">æ•°æ®åº“æ¨¡å¼</td>
    <td>æ¨¡å¼</td>
    <td><code>CREATE SCHEMA</code></td>
  </tr>
  <tr>
    <td>åŸºæœ¬è¡¨</td>
    <td><code>CREATE SCHEMA</code>ï¼Œ<code>ALTER TABLE</code></td>
  </tr>
    <tr>
    <td>è§†å›¾</td>
    <td><code>CREATE VIEW</code></td>
  </tr>
    <tr>
    <td>ç´¢å¼•</td>
    <td><code>CREATE INDEX</code></td>
  </tr>
    <tr>
    <td rowspan="2">æ•°æ®</td>
    <td>åŸºæœ¬è¡¨å’Œè§†å›¾</td>
    <td><code>SELECT</code>ï¼Œ<code>INSERT</code>ï¼Œ<code>UPDATE</code>ï¼Œ<code>DELETE</code>ï¼Œ<code>REFERENCES</code>ï¼Œ<code>ALL PRIVILEGES</code></td>
  </tr>
    <tr>
    <td>å±æ€§åˆ—</td>
    <td><code>SELECT</code>ï¼Œ<code>INSERT</code>ï¼Œ<code>UPDATE</code>ï¼Œ<code>REFERENCES</code>ï¼Œ<code>ALL PRIVILEGES</code></td>
  </tr>
</table>

> SQL è¯­æ³•æ•™ç¨‹ï¼š[runoob . SQL æ•™ç¨‹](http://www.runoob.com/sql/sql-tutorial.html)

### å…³ç³»å‹æ•°æ®åº“

* åŸºæœ¬å…³ç³»æ“ä½œï¼šæŸ¥è¯¢ï¼ˆé€‰æ‹©ã€æŠ•å½±ã€è¿æ¥ï¼ˆç­‰å€¼è¿æ¥ã€è‡ªç„¶è¿æ¥ã€å¤–è¿æ¥ï¼ˆå·¦å¤–è¿æ¥ã€å³å¤–è¿æ¥ï¼‰ï¼‰ã€é™¤ã€å¹¶ã€å·®ã€äº¤ã€ç¬›å¡å°”ç§¯ç­‰ï¼‰ã€æ’å…¥ã€åˆ é™¤ã€ä¿®æ”¹
* å…³ç³»æ¨¡å‹ä¸­çš„ä¸‰ç±»å®Œæ•´æ€§çº¦æŸï¼šå®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§ã€ç”¨æˆ·å®šä¹‰çš„å®Œæ•´æ€§

#### ç´¢å¼•

* æ•°æ®åº“ç´¢å¼•ï¼šé¡ºåºç´¢å¼•ã€B+ æ ‘ç´¢å¼•ã€hash ç´¢å¼•
* [MySQL ç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†](http://blog.codinglabs.org/articles/theory-of-mysql-index.html)

### æ•°æ®åº“å®Œæ•´æ€§

* æ•°æ®åº“çš„å®Œæ•´æ€§æ˜¯æŒ‡æ•°æ®çš„æ­£ç¡®æ€§å’Œç›¸å®¹æ€§ã€‚
    * å®Œæ•´æ€§ï¼šä¸ºäº†é˜²æ­¢æ•°æ®åº“ä¸­å­˜åœ¨ä¸ç¬¦åˆè¯­ä¹‰ï¼ˆä¸æ­£ç¡®ï¼‰çš„æ•°æ®ã€‚
    * å®‰å…¨æ€§ï¼šä¸ºäº†ä¿æŠ¤æ•°æ®åº“é˜²æ­¢æ¶æ„ç ´åå’Œéæ³•å­˜å–ã€‚
* è§¦å‘å™¨ï¼šæ˜¯ç”¨æˆ·å®šä¹‰åœ¨å…³ç³»è¡¨ä¸­çš„ä¸€ç±»ç”±äº‹ä»¶é©±åŠ¨çš„ç‰¹æ®Šè¿‡ç¨‹ã€‚

### å…³ç³»æ•°æ®ç†è®º

* æ•°æ®ä¾èµ–æ˜¯ä¸€ä¸ªå…³ç³»å†…éƒ¨å±æ€§ä¸å±æ€§ä¹‹é—´çš„ä¸€ç§çº¦æŸå…³ç³»ï¼Œæ˜¯é€šè¿‡å±æ€§é—´å€¼çš„ç›¸ç­‰ä¸å¦ä½“ç°å‡ºæ¥çš„æ•°æ®é—´ç›¸å…³è”ç³»ã€‚
* æœ€é‡è¦çš„æ•°æ®ä¾èµ–ï¼šå‡½æ•°ä¾èµ–ã€å¤šå€¼ä¾èµ–ã€‚

#### èŒƒå¼

* ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ï¼šå±æ€§ï¼ˆå­—æ®µï¼‰æ˜¯æœ€å°å•ä½ä¸å¯å†åˆ†ã€‚
* ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ï¼šæ»¡è¶³ 1NFï¼Œæ¯ä¸ªéä¸»å±æ€§å®Œå…¨ä¾èµ–äºä¸»é”®ï¼ˆæ¶ˆé™¤ 1NF éä¸»å±æ€§å¯¹ç çš„éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼‰ã€‚
* ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ï¼šæ»¡è¶³ 2NFï¼Œä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–äºå…¶ä»–éä¸»å±æ€§ï¼ˆæ¶ˆé™¤ 2NF éä¸»å±æ€§å¯¹ç çš„ä¼ é€’å‡½æ•°ä¾èµ–ï¼‰ã€‚
* é²ä¾æ–¯-ç§‘å¾—èŒƒå¼ï¼ˆBCNFï¼‰ï¼šæ»¡è¶³ 3NFï¼Œä»»ä½•éä¸»å±æ€§ä¸èƒ½å¯¹ä¸»é”®å­é›†ä¾èµ–ï¼ˆæ¶ˆé™¤ 3NF ä¸»å±æ€§å¯¹ç çš„éƒ¨åˆ†å’Œä¼ é€’å‡½æ•°ä¾èµ–ï¼‰ã€‚
* ç¬¬å››èŒƒå¼ï¼ˆ4NFï¼‰ï¼šæ»¡è¶³ 3NFï¼Œå±æ€§ä¹‹é—´ä¸èƒ½æœ‰éå¹³å‡¡ä¸”éå‡½æ•°ä¾èµ–çš„å¤šå€¼ä¾èµ–ï¼ˆæ¶ˆé™¤ 3NF éå¹³å‡¡ä¸”éå‡½æ•°ä¾èµ–çš„å¤šå€¼ä¾èµ–ï¼‰ã€‚

### æ•°æ®åº“æ¢å¤

* äº‹åŠ¡ï¼šæ˜¯ç”¨æˆ·å®šä¹‰çš„ä¸€ä¸ªæ•°æ®åº“æ“ä½œåºåˆ—ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨åšï¼Œè¦ä¹ˆå…¨ä¸åšï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚
* äº‹ç‰©çš„ ACID ç‰¹æ€§ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒç»­æ€§ã€‚
* æ¢å¤çš„å®ç°æŠ€æœ¯ï¼šå»ºç«‹å†—ä½™æ•°æ® -> åˆ©ç”¨å†—ä½™æ•°æ®å®æ–½æ•°æ®åº“æ¢å¤ã€‚
* å»ºç«‹å†—ä½™æ•°æ®å¸¸ç”¨æŠ€æœ¯ï¼šæ•°æ®è½¬å‚¨ï¼ˆåŠ¨æ€æµ·é‡è½¬å‚¨ã€åŠ¨æ€å¢é‡è½¬å‚¨ã€é™æ€æµ·é‡è½¬å‚¨ã€é™æ€å¢é‡è½¬å‚¨ï¼‰ã€ç™»è®°æ—¥å¿—æ–‡ä»¶ã€‚

### å¹¶å‘æ§åˆ¶

* äº‹åŠ¡æ˜¯å¹¶å‘æ§åˆ¶çš„åŸºæœ¬å•ä½ã€‚
* å¹¶å‘æ“ä½œå¸¦æ¥çš„æ•°æ®ä¸ä¸€è‡´æ€§åŒ…æ‹¬ï¼šä¸¢å¤±ä¿®æ”¹ã€ä¸å¯é‡å¤è¯»ã€è¯» â€œè„â€ æ•°æ®ã€‚
* å¹¶å‘æ§åˆ¶ä¸»è¦æŠ€æœ¯ï¼šå°é”ã€æ—¶é—´æˆ³ã€ä¹è§‚æ§åˆ¶æ³•ã€å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ç­‰ã€‚
* åŸºæœ¬å°é”ç±»å‹ï¼šæ’ä»–é”ï¼ˆX é” / å†™é”ï¼‰ã€å…±äº«é”ï¼ˆS é” / è¯»é”ï¼‰ã€‚
* æ´»é”æ­»é”ï¼š
    * æ´»é”ï¼šäº‹åŠ¡æ°¸è¿œå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¯é€šè¿‡å…ˆæ¥å…ˆæœåŠ¡çš„ç­–ç•¥é¿å…ã€‚
    * æ­»é”ï¼šäº‹åŠ¡æ°¸è¿œä¸èƒ½ç»“æŸ
        * é¢„é˜²ï¼šä¸€æ¬¡å°é”æ³•ã€é¡ºåºå°é”æ³•ï¼›
        * è¯Šæ–­ï¼šè¶…æ—¶æ³•ã€ç­‰å¾…å›¾æ³•ï¼›
        * è§£é™¤ï¼šæ’¤é”€å¤„ç†æ­»é”ä»£ä»·æœ€å°çš„äº‹åŠ¡ï¼Œå¹¶é‡Šæ”¾æ­¤äº‹åŠ¡çš„æ‰€æœ‰çš„é”ï¼Œä½¿å…¶ä»–äº‹åŠ¡å¾—ä»¥ç»§ç»­è¿è¡Œä¸‹å»ã€‚
* å¯ä¸²è¡ŒåŒ–è°ƒåº¦ï¼šå¤šä¸ªäº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œæ˜¯æ­£ç¡®çš„ï¼Œå½“ä¸”ä»…å½“å…¶ç»“æœä¸æŒ‰æŸä¸€æ¬¡åºä¸²è¡Œåœ°æ‰§è¡Œè¿™äº›äº‹åŠ¡æ—¶çš„ç»“æœç›¸åŒã€‚å¯ä¸²è¡Œæ€§æ—¶å¹¶å‘äº‹åŠ¡æ­£ç¡®è°ƒåº¦çš„å‡†åˆ™ã€‚

<a id="usefultools"></a>

## ğŸ”§ å®ç”¨å·¥å…·

### å‘½ä»¤è¡Œ

### git

### vim

### docker

<a id="data-structure"></a>

## ã€½ï¸ æ•°æ®ç»“æ„

<a id="algorithm"></a>

## â“ç®—æ³•

### åŠ¨æ€è§„åˆ’

### æ»‘åŠ¨çª—å£

* [æ— é‡å¤æœ€é•¿å­ä¸²](https://leetcode.cn/problems/longest-substring-without-repeating-characters/)
* [æœ€å°è¦†ç›–å­ä¸²](https://leetcode.cn/problems/minimum-window-substring/)

<a id="design-pattern"></a>

## ğŸ“ è®¾è®¡æ¨¡å¼

> å„å¤§è®¾è®¡æ¨¡å¼ä¾‹å­å‚è€ƒï¼š[CSDNä¸“æ  . C++ è®¾è®¡æ¨¡å¼](https://blog.csdn.net/liang19890820/article/details/66974516) ç³»åˆ—åšæ–‡

[è®¾è®¡æ¨¡å¼å·¥ç¨‹ç›®å½•](DesignPattern)

### å•ä¾‹æ¨¡å¼

[å•ä¾‹æ¨¡å¼ä¾‹å­](DesignPattern/SingletonPattern)

### æŠ½è±¡å·¥å‚æ¨¡å¼

[æŠ½è±¡å·¥å‚æ¨¡å¼ä¾‹å­](DesignPattern/AbstractFactoryPattern)

### é€‚é…å™¨æ¨¡å¼

[é€‚é…å™¨æ¨¡å¼ä¾‹å­](DesignPattern/AdapterPattern)

### æ¡¥æ¥æ¨¡å¼

[æ¡¥æ¥æ¨¡å¼ä¾‹å­](DesignPattern/BridgePattern)

### è§‚å¯Ÿè€…æ¨¡å¼

[è§‚å¯Ÿè€…æ¨¡å¼ä¾‹å­](DesignPattern/ObserverPattern)

### è®¾è®¡æ¨¡å¼çš„å…­å¤§åŸåˆ™

* å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼ŒSingle Responsibility Principleï¼‰
* é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLSPï¼ŒLiskov Substitution Principleï¼‰
* ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼ŒDependence Inversion Principleï¼‰
* æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼ŒInterface Segregation Principleï¼‰
* è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLoDï¼ŒLaw of Demeterï¼‰
* å¼€æ”¾å°é—­åŸåˆ™ï¼ˆOCPï¼ŒOpen Close Principleï¼‰

<a id="link-loading-library"></a>

## âš™ï¸ é“¾æ¥è£…è½½åº“

> æœ¬èŠ‚éƒ¨åˆ†çŸ¥è¯†ç‚¹æ¥è‡ªã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»â€”â€”é“¾æ¥è£…è½½åº“ã€‹

### å†…å­˜ã€æ ˆã€å †

ä¸€èˆ¬åº”ç”¨ç¨‹åºå†…å­˜ç©ºé—´æœ‰å¦‚ä¸‹åŒºåŸŸï¼š

* æ ˆï¼šç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨åˆ†é…é‡Šæ”¾ï¼Œå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ã€å±€éƒ¨å˜é‡ç­‰çš„å€¼ï¼Œç”¨äºç»´æŠ¤å‡½æ•°è°ƒç”¨çš„ä¸Šä¸‹æ–‡
* å †ï¼šä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±æ“ä½œç³»ç»Ÿå›æ”¶ï¼Œç”¨æ¥å®¹çº³åº”ç”¨ç¨‹åºåŠ¨æ€åˆ†é…çš„å†…å­˜åŒºåŸŸ
* å¯æ‰§è¡Œæ–‡ä»¶æ˜ åƒï¼šå­˜å‚¨ç€å¯æ‰§è¡Œæ–‡ä»¶åœ¨å†…å­˜ä¸­çš„æ˜ åƒï¼Œç”±è£…è½½å™¨è£…è½½æ˜¯å°†å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å­˜è¯»å–æˆ–æ˜ å°„åˆ°è¿™é‡Œ
* ä¿ç•™åŒºï¼šä¿ç•™åŒºå¹¶ä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„å†…å­˜åŒºåŸŸï¼Œè€Œæ˜¯å¯¹å†…å­˜ä¸­å—åˆ°ä¿æŠ¤è€Œç¦æ­¢è®¿é—®çš„å†…å­˜åŒºåŸŸçš„æ€»ç§°ï¼Œå¦‚é€šå¸¸ C è¯­è¨€è®²æ— æ•ˆæŒ‡é’ˆèµ‹å€¼ä¸º 0ï¼ˆNULLï¼‰ï¼Œå› æ­¤ 0 åœ°å€æ­£å¸¸æƒ…å†µä¸‹ä¸å¯èƒ½æœ‰æ•ˆçš„è®¿é—®æ•°æ®

#### æ ˆ

æ ˆä¿å­˜äº†ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ‰€éœ€è¦çš„ç»´æŠ¤ä¿¡æ¯ï¼Œå¸¸è¢«ç§°ä¸ºå †æ ˆå¸§ï¼ˆStack Frameï¼‰æˆ–æ´»åŠ¨è®°å½•ï¼ˆActivate Recordï¼‰ï¼Œä¸€èˆ¬åŒ…å«ä»¥ä¸‹å‡ æ–¹é¢ï¼š

* å‡½æ•°çš„è¿”å›åœ°å€å’Œå‚æ•°
* ä¸´æ—¶å˜é‡ï¼šåŒ…æ‹¬å‡½æ•°çš„éé™æ€å±€éƒ¨å˜é‡ä»¥åŠç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„å…¶ä»–ä¸´æ—¶å˜é‡
* ä¿å­˜ä¸Šä¸‹æ–‡ï¼šåŒ…æ‹¬å‡½æ•°è°ƒç”¨å‰åéœ€è¦ä¿æŒä¸å˜çš„å¯„å­˜å™¨

#### å †

å †åˆ†é…ç®—æ³•ï¼š

* ç©ºé—²é“¾è¡¨ï¼ˆFree Listï¼‰
* ä½å›¾ï¼ˆBitmapï¼‰
* å¯¹è±¡æ± 

#### â€œæ®µé”™è¯¯ï¼ˆsegment faultï¼‰â€ æˆ– â€œéæ³•æ“ä½œï¼Œè¯¥å†…å­˜åœ°å€ä¸èƒ½ read/writeâ€

å…¸å‹çš„éæ³•æŒ‡é’ˆè§£å¼•ç”¨é€ æˆçš„é”™è¯¯ã€‚å½“æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªä¸å…è®¸è¯»å†™çš„å†…å­˜åœ°å€ï¼Œè€Œç¨‹åºå´è¯•å›¾åˆ©ç”¨æŒ‡é’ˆæ¥è¯»æˆ–å†™è¯¥åœ°å€æ—¶ï¼Œä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ã€‚

æ™®éåŸå› ï¼š

* å°†æŒ‡é’ˆåˆå§‹åŒ–ä¸º NULLï¼Œä¹‹åæ²¡æœ‰ç»™å®ƒä¸€ä¸ªåˆç†çš„å€¼å°±å¼€å§‹ä½¿ç”¨æŒ‡é’ˆ
* æ²¡ç”¨åˆå§‹åŒ–æ ˆä¸­çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆçš„å€¼ä¸€èˆ¬ä¼šæ˜¯éšæœºæ•°ï¼Œä¹‹åå°±ç›´æ¥å¼€å§‹ä½¿ç”¨æŒ‡é’ˆ

### ç¼–è¯‘é“¾æ¥

#### å„å¹³å°æ–‡ä»¶æ ¼å¼

å¹³å° | å¯æ‰§è¡Œæ–‡ä»¶ | ç›®æ ‡æ–‡ä»¶ | åŠ¨æ€åº“/å…±äº«å¯¹è±¡ | é™æ€åº“
---|---|---|---|---
Windows|exe|obj|dll|lib
Unix/Linux|ELFã€out|o|so|a
Mac|Mach-O|o|dylibã€tbdã€framework|aã€framework

#### ç¼–è¯‘é“¾æ¥è¿‡ç¨‹

1. é¢„ç¼–è¯‘ï¼ˆé¢„ç¼–è¯‘å™¨å¤„ç†å¦‚ `#include`ã€`#define` ç­‰é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œç”Ÿæˆ `.i` æˆ– `.ii` æ–‡ä»¶ï¼‰
2. ç¼–è¯‘ï¼ˆç¼–è¯‘å™¨è¿›è¡Œè¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æã€ä¸­é—´ä»£ç ç”Ÿæˆã€ç›®æ ‡ä»£ç ç”Ÿæˆã€ä¼˜åŒ–ï¼Œç”Ÿæˆ `.s` æ–‡ä»¶ï¼‰
3. æ±‡ç¼–ï¼ˆæ±‡ç¼–å™¨æŠŠæ±‡ç¼–ç ç¿»è¯‘æˆæœºå™¨ç ï¼Œç”Ÿæˆ `.o` æ–‡ä»¶ï¼‰
4. é“¾æ¥ï¼ˆè¿æ¥å™¨è¿›è¡Œåœ°å€å’Œç©ºé—´åˆ†é…ã€ç¬¦å·å†³è®®ã€é‡å®šä½ï¼Œç”Ÿæˆ `.out` æ–‡ä»¶ï¼‰

> ç°åœ¨ç‰ˆæœ¬ GCC æŠŠé¢„ç¼–è¯‘å’Œç¼–è¯‘åˆæˆä¸€æ­¥ï¼Œé¢„ç¼–è¯‘ç¼–è¯‘ç¨‹åº cc1ã€æ±‡ç¼–å™¨ asã€è¿æ¥å™¨ ld
> MSVC ç¼–è¯‘ç¯å¢ƒï¼Œç¼–è¯‘å™¨ clã€è¿æ¥å™¨ linkã€å¯æ‰§è¡Œæ–‡ä»¶æŸ¥çœ‹å™¨ dumpbin

#### ç›®æ ‡æ–‡ä»¶

ç¼–è¯‘å™¨ç¼–è¯‘æºä»£ç åç”Ÿæˆçš„æ–‡ä»¶å«åšç›®æ ‡æ–‡ä»¶ã€‚ç›®æ ‡æ–‡ä»¶ä»ç»“æ„ä¸Šè®²ï¼Œå®ƒæ˜¯å·²ç»ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼Œåªæ˜¯è¿˜æ²¡æœ‰ç»è¿‡é“¾æ¥çš„è¿‡ç¨‹ï¼Œå…¶ä¸­å¯èƒ½æœ‰äº›ç¬¦å·æˆ–æœ‰äº›åœ°å€è¿˜æ²¡æœ‰è¢«è°ƒæ•´ã€‚

> å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆWindows çš„ `.exe` å’Œ Linux çš„ `ELF`ï¼‰ã€åŠ¨æ€é“¾æ¥åº“ï¼ˆWindows çš„ `.dll` å’Œ Linux çš„ `.so`ï¼‰ã€é™æ€é“¾æ¥åº“ï¼ˆWindows çš„ `.lib` å’Œ Linux çš„ `.a`ï¼‰éƒ½æ˜¯æŒ‰ç…§å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼å­˜å‚¨ï¼ˆWindows æŒ‰ç…§ PE-COFFï¼ŒLinux æŒ‰ç…§ ELFï¼‰

##### ç›®æ ‡æ–‡ä»¶æ ¼å¼

* Windows çš„ PEï¼ˆPortable Executableï¼‰ï¼Œæˆ–ç§°ä¸º PE-COFFï¼Œ`.obj` æ ¼å¼
* Linux çš„ ELFï¼ˆExecutable Linkable Formatï¼‰ï¼Œ`.o` æ ¼å¼
* Intel/Microsoft çš„ OMFï¼ˆObject Module Formatï¼‰
* Unix çš„ `a.out` æ ¼å¼
* MS-DOS çš„ `.COM` æ ¼å¼

> PE å’Œ ELF éƒ½æ˜¯ COFFï¼ˆCommon File Formatï¼‰çš„å˜ç§

##### ç›®æ ‡æ–‡ä»¶å­˜å‚¨ç»“æ„

æ®µ | åŠŸèƒ½
--- | ---
File Header | æ–‡ä»¶å¤´ï¼Œæè¿°æ•´ä¸ªæ–‡ä»¶çš„æ–‡ä»¶å±æ€§ï¼ˆåŒ…æ‹¬æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€æ˜¯é™æ€é“¾æ¥æˆ–åŠ¨æ€è¿æ¥åŠå…¥å£åœ°å€ã€ç›®æ ‡ç¡¬ä»¶ã€ç›®æ ‡æ“ä½œç³»ç»Ÿç­‰ï¼‰
.text section | ä»£ç æ®µï¼Œæ‰§è¡Œè¯­å¥ç¼–è¯‘æˆçš„æœºå™¨ä»£ç 
.data section | æ•°æ®æ®µï¼Œå·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡
.bss section | BSS æ®µï¼ˆBlock Started by Symbolï¼‰ï¼Œæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ï¼ˆå› ä¸ºé»˜è®¤å€¼ä¸º 0ï¼Œæ‰€ä»¥åªæ˜¯åœ¨æ­¤é¢„ç•™ä½ç½®ï¼Œä¸å ç©ºé—´ï¼‰
.rodata section | åªè¯»æ•°æ®æ®µï¼Œå­˜æ”¾åªè¯»æ•°æ®ï¼Œä¸€èˆ¬æ˜¯ç¨‹åºé‡Œé¢çš„åªè¯»å˜é‡ï¼ˆå¦‚ const ä¿®é¥°çš„å˜é‡ï¼‰å’Œå­—ç¬¦ä¸²å¸¸é‡
.comment section | æ³¨é‡Šä¿¡æ¯æ®µï¼Œå­˜æ”¾ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯
.note.GNU-stack section | å †æ ˆæç¤ºæ®µ

> å…¶ä»–æ®µç•¥

#### é“¾æ¥çš„æ¥å£â€”â€”â€”â€”ç¬¦å·

åœ¨é“¾æ¥ä¸­ï¼Œç›®æ ‡æ–‡ä»¶ä¹‹é—´ç›¸äº’æ‹¼åˆå®é™…ä¸Šæ˜¯ç›®æ ‡æ–‡ä»¶ä¹‹é—´å¯¹åœ°å€çš„å¼•ç”¨ï¼Œå³å¯¹å‡½æ•°å’Œå˜é‡çš„åœ°å€çš„å¼•ç”¨ã€‚æˆ‘ä»¬å°†å‡½æ•°å’Œå˜é‡ç»Ÿç§°ä¸ºç¬¦å·ï¼ˆSymbolï¼‰ï¼Œå‡½æ•°åæˆ–å˜é‡åå°±æ˜¯ç¬¦å·åï¼ˆSymbol Nameï¼‰ã€‚

å¦‚ä¸‹ç¬¦å·è¡¨ï¼ˆSymbol Tableï¼‰ï¼š

Symbolï¼ˆç¬¦å·åï¼‰ | Symbol Value ï¼ˆåœ°å€ï¼‰
--- | ---
main| 0x100
Add | 0x123
... | ...

### Linux çš„å…±äº«åº“ï¼ˆShared Libraryï¼‰

Linux ä¸‹çš„å…±äº«åº“å°±æ˜¯æ™®é€šçš„ ELF å…±äº«å¯¹è±¡ã€‚

å…±äº«åº“ç‰ˆæœ¬æ›´æ–°åº”è¯¥ä¿è¯äºŒè¿›åˆ¶æ¥å£ ABIï¼ˆApplication Binary Interfaceï¼‰çš„å…¼å®¹

#### å‘½å

`libname.so.x.y.z`

* xï¼šä¸»ç‰ˆæœ¬å·ï¼Œä¸åŒä¸»ç‰ˆæœ¬å·çš„åº“ä¹‹é—´ä¸å…¼å®¹ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘
* yï¼šæ¬¡ç‰ˆæœ¬å·ï¼Œé«˜ç‰ˆæœ¬å·å‘åå…¼å®¹ä½ç‰ˆæœ¬å·
* zï¼šå‘å¸ƒç‰ˆæœ¬å·ï¼Œä¸å¯¹æ¥å£è¿›è¡Œæ›´æ”¹ï¼Œå®Œå…¨å…¼å®¹

#### è·¯å¾„

å¤§éƒ¨åˆ†åŒ…æ‹¬ Linux åœ¨å†…çš„å¼€æºç³»ç»Ÿéµå¾ª FHSï¼ˆFile Hierarchy Standardï¼‰çš„æ ‡å‡†ï¼Œè¿™æ ‡å‡†è§„å®šäº†ç³»ç»Ÿæ–‡ä»¶å¦‚ä½•å­˜æ”¾ï¼ŒåŒ…æ‹¬å„ä¸ªç›®å½•ç»“æ„ã€ç»„ç»‡å’Œä½œç”¨ã€‚

* `/lib`ï¼šå­˜æ”¾ç³»ç»Ÿæœ€å…³é”®å’Œæœ€åŸºç¡€çš„å…±äº«åº“ï¼Œå¦‚åŠ¨æ€é“¾æ¥å™¨ã€C è¯­è¨€è¿è¡Œåº“ã€æ•°å­¦åº“ç­‰
* `/usr/lib`ï¼šå­˜æ”¾éç³»ç»Ÿè¿è¡Œæ—¶æ‰€éœ€è¦çš„å…³é”®æ€§çš„åº“ï¼Œä¸»è¦æ˜¯å¼€å‘åº“
* `/usr/local/lib`ï¼šå­˜æ”¾è·Ÿæ“ä½œç³»ç»Ÿæœ¬èº«å¹¶ä¸ååˆ†ç›¸å…³çš„åº“ï¼Œä¸»è¦æ˜¯ä¸€äº›ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºçš„åº“

> åŠ¨æ€é“¾æ¥å™¨ä¼šåœ¨ `/lib`ã€`/usr/lib` å’Œç”± `/etc/ld.so.conf` é…ç½®æ–‡ä»¶æŒ‡å®šçš„ï¼Œç›®å½•ä¸­æŸ¥æ‰¾å…±äº«åº“

#### ç¯å¢ƒå˜é‡

* `LD_LIBRARY_PATH`ï¼šä¸´æ—¶æ”¹å˜æŸä¸ªåº”ç”¨ç¨‹åºçš„å…±äº«åº“æŸ¥æ‰¾è·¯å¾„ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–åº”ç”¨ç¨‹åº
* `LD_PRELOAD`ï¼šæŒ‡å®šé¢„å…ˆè£…è½½çš„ä¸€äº›å…±äº«åº“ç”šè‡³æ˜¯ç›®æ ‡æ–‡ä»¶
* `LD_DEBUG`ï¼šæ‰“å¼€åŠ¨æ€é“¾æ¥å™¨çš„è°ƒè¯•åŠŸèƒ½

#### so å…±äº«åº“çš„ç¼–å†™

ä½¿ç”¨ CLion ç¼–å†™å…±äº«åº“

åˆ›å»ºä¸€ä¸ªåä¸º MySharedLib çš„å…±äº«åº“

CMakeLists.txt

```cmake
cmake_minimum_required(VERSION 3.10)
project(MySharedLib)

set(CMAKE_CXX_STANDARD 11)

add_library(MySharedLib SHARED library.cpp library.h)
```

library.h

```cpp
#ifndef MYSHAREDLIB_LIBRARY_H
#define MYSHAREDLIB_LIBRARY_H

// æ‰“å° Hello World!
void hello();

// ä½¿ç”¨å¯å˜æ¨¡ç‰ˆå‚æ•°æ±‚å’Œ
template <typename T>
T sum(T t)
{
    return t;
}
template <typename T, typename ...Types>
T sum(T first, Types ... rest)
{
    return first + sum<T>(rest...);
}

#endif
```

library.cpp

```cpp
#include <iostream>
#include "library.h"

void hello() {
    std::cout << "Hello, World!" << std::endl;
}
```

#### so å…±äº«åº“çš„ä½¿ç”¨ï¼ˆè¢«å¯æ‰§è¡Œé¡¹ç›®è°ƒç”¨ï¼‰

ä½¿ç”¨ CLion è°ƒç”¨å…±äº«åº“

åˆ›å»ºä¸€ä¸ªåä¸º TestSharedLib çš„å¯æ‰§è¡Œé¡¹ç›®

CMakeLists.txt

```cmake
cmake_minimum_required(VERSION 3.10)
project(TestSharedLib)

# C++11 ç¼–è¯‘
set(CMAKE_CXX_STANDARD 11)

# å¤´æ–‡ä»¶è·¯å¾„
set(INC_DIR /home/xx/code/clion/MySharedLib)
# åº“æ–‡ä»¶è·¯å¾„
set(LIB_DIR /home/xx/code/clion/MySharedLib/cmake-build-debug)

include_directories(${INC_DIR})
link_directories(${LIB_DIR})
link_libraries(MySharedLib)

add_executable(TestSharedLib main.cpp)

# é“¾æ¥ MySharedLib åº“
target_link_libraries(TestSharedLib MySharedLib)
```

main.cpp

```cpp
#include <iostream>
#include "library.h"
using std::cout;
using std::endl;

int main() {

    hello();
    cout << "1 + 2 = " << sum(1,2) << endl;
    cout << "1 + 2 + 3 = " << sum(1,2,3) << endl;

    return 0;
}
```

æ‰§è¡Œç»“æœ

```text
Hello, World!
1 + 2 = 3
1 + 2 + 3 = 6
```

### Windows åº”ç”¨ç¨‹åºå…¥å£å‡½æ•°

* GUIï¼ˆGraphical User Interfaceï¼‰åº”ç”¨ï¼Œé“¾æ¥å™¨é€‰é¡¹ï¼š`/SUBSYSTEM:WINDOWS`
* CUIï¼ˆConsole User Interfaceï¼‰åº”ç”¨ï¼Œé“¾æ¥å™¨é€‰é¡¹ï¼š`/SUBSYSTEM:CONSOLE`

_tWinMain ä¸ _tmain å‡½æ•°å£°æ˜

```cpp
Int WINAPI _tWinMain(
    HINSTANCE hInstanceExe,
    HINSTANCE,
    PTSTR pszCmdLine,
    int nCmdShow);

int _tmain(
    int argc,
    TCHAR *argv[],
    TCHAR *envp[]);
```

åº”ç”¨ç¨‹åºç±»å‹|å…¥å£ç‚¹å‡½æ•°|åµŒå…¥å¯æ‰§è¡Œæ–‡ä»¶çš„å¯åŠ¨å‡½æ•°
---|---|---
å¤„ç†ANSIå­—ç¬¦ï¼ˆä¸²ï¼‰çš„GUIåº”ç”¨ç¨‹åº|_tWinMain(WinMain)|WinMainCRTSartup
å¤„ç†Unicodeå­—ç¬¦ï¼ˆä¸²ï¼‰çš„GUIåº”ç”¨ç¨‹åº|_tWinMain(wWinMain)|wWinMainCRTSartup
å¤„ç†ANSIå­—ç¬¦ï¼ˆä¸²ï¼‰çš„CUIåº”ç”¨ç¨‹åº|_tmain(Main)|mainCRTSartup
å¤„ç†Unicodeå­—ç¬¦ï¼ˆä¸²ï¼‰çš„CUIåº”ç”¨ç¨‹åº|_tmain(wMain)|wmainCRTSartup
åŠ¨æ€é“¾æ¥åº“ï¼ˆDynamic-Link Libraryï¼‰|DllMain|_DllMainCRTStartup

### Windows çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆDynamic-Link Libraryï¼‰

> éƒ¨åˆ†çŸ¥è¯†ç‚¹æ¥è‡ªã€ŠWindows æ ¸å¿ƒç¼–ç¨‹ï¼ˆç¬¬äº”ç‰ˆï¼‰ã€‹

#### ç”¨å¤„

* æ‰©å±•äº†åº”ç”¨ç¨‹åºçš„ç‰¹æ€§
* ç®€åŒ–äº†é¡¹ç›®ç®¡ç†
* æœ‰åŠ©äºèŠ‚çœå†…å­˜
* ä¿ƒè¿›äº†èµ„æºçš„å…±äº«
* ä¿ƒè¿›äº†æœ¬åœ°åŒ–
* æœ‰åŠ©äºè§£å†³å¹³å°é—´çš„å·®å¼‚
* å¯ä»¥ç”¨äºç‰¹æ®Šç›®çš„

#### æ³¨æ„

* åˆ›å»º DLLï¼Œäº‹å®ä¸Šæ˜¯åœ¨åˆ›å»ºå¯ä¾›ä¸€ä¸ªå¯æ‰§è¡Œæ¨¡å—è°ƒç”¨çš„å‡½æ•°
* å½“ä¸€ä¸ªæ¨¡å—æä¾›ä¸€ä¸ªå†…å­˜åˆ†é…å‡½æ•°ï¼ˆmallocã€newï¼‰çš„æ—¶å€™ï¼Œå®ƒå¿…é¡»åŒæ—¶æä¾›å¦ä¸€ä¸ªå†…å­˜é‡Šæ”¾å‡½æ•°ï¼ˆfreeã€deleteï¼‰
* åœ¨ä½¿ç”¨ C å’Œ C++ æ··ç¼–çš„æ—¶å€™ï¼Œè¦ä½¿ç”¨ extern "C" ä¿®é¥°ç¬¦
* ä¸€ä¸ª DLL å¯ä»¥å¯¼å‡ºå‡½æ•°ã€å˜é‡ï¼ˆé¿å…å¯¼å‡ºï¼‰ã€C++ ç±»ï¼ˆå¯¼å‡ºå¯¼å…¥éœ€è¦åŒç¼–è¯‘å™¨ï¼Œå¦åˆ™é¿å…å¯¼å‡ºï¼‰
* DLL æ¨¡å—ï¼šcpp æ–‡ä»¶ä¸­çš„ __declspec(dllexport) å†™åœ¨ include å¤´æ–‡ä»¶ä¹‹å‰
* è°ƒç”¨ DLL çš„å¯æ‰§è¡Œæ¨¡å—ï¼šcpp æ–‡ä»¶çš„ __declspec(dllimport) ä¹‹å‰ä¸åº”è¯¥å®šä¹‰ MYLIBAPI

#### åŠ è½½ Windows ç¨‹åºçš„æœç´¢é¡ºåº

1. åŒ…å«å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•
2. Windows çš„ç³»ç»Ÿç›®å½•ï¼Œå¯ä»¥é€šè¿‡ GetSystemDirectory å¾—åˆ°
3. 16 ä½çš„ç³»ç»Ÿç›®å½•ï¼Œå³ Windows ç›®å½•ä¸­çš„ System å­ç›®å½•
4. Windows ç›®å½•ï¼Œå¯ä»¥é€šè¿‡ GetWindowsDirectory å¾—åˆ°
5. è¿›ç¨‹çš„å½“å‰ç›®å½•
6. PATH ç¯å¢ƒå˜é‡ä¸­æ‰€åˆ—å‡ºçš„ç›®å½•

#### DLL å…¥å£å‡½æ•°

DllMain å‡½æ•°

```cpp
BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
{
    switch(fdwReason)
    {
    case DLL_PROCESS_ATTACH:
        // ç¬¬ä¸€æ¬¡å°†ä¸€ä¸ªDLLæ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´æ—¶è°ƒç”¨
        // The DLL is being mapped into the process' address space.
        break;
    case DLL_THREAD_ATTACH:
        // å½“è¿›ç¨‹åˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œç”¨äºå‘Šè¯‰DLLæ‰§è¡Œä¸çº¿ç¨‹ç›¸å…³çš„åˆå§‹åŒ–ï¼ˆéä¸»çº¿ç¨‹æ‰§è¡Œï¼‰
        // A thread is bing created.
        break;
    case DLL_THREAD_DETACH:
        // ç³»ç»Ÿè°ƒç”¨ ExitThread çº¿ç¨‹é€€å‡ºå‰ï¼Œå³å°†ç»ˆæ­¢çš„çº¿ç¨‹é€šè¿‡å‘Šè¯‰DLLæ‰§è¡Œä¸çº¿ç¨‹ç›¸å…³çš„æ¸…ç†
        // A thread is exiting cleanly.
        break;
    case DLL_PROCESS_DETACH:
        // å°†ä¸€ä¸ªDLLä»è¿›ç¨‹çš„åœ°å€ç©ºé—´æ—¶è°ƒç”¨
        // The DLL is being unmapped from the process' address space.
        break;
    }
    return (TRUE); // Used only for DLL_PROCESS_ATTACH
}
```

#### è½½å…¥å¸è½½åº“

LoadLibraryã€LoadLibraryExAã€LoadPackagedLibraryã€FreeLibraryã€FreeLibraryAndExitThread å‡½æ•°å£°æ˜

```cpp
// è½½å…¥åº“
HMODULE WINAPI LoadLibrary(
  _In_ LPCTSTR lpFileName
);
HMODULE LoadLibraryExA(
  LPCSTR lpLibFileName,
  HANDLE hFile,
  DWORD  dwFlags
);
// è‹¥è¦åœ¨é€šç”¨ Windows å¹³å°ï¼ˆUWPï¼‰åº”ç”¨ä¸­åŠ è½½ Win32 DLLï¼Œéœ€è¦è°ƒç”¨ LoadPackagedLibraryï¼Œè€Œä¸æ˜¯ LoadLibrary æˆ– LoadLibraryEx
HMODULE LoadPackagedLibrary(
  LPCWSTR lpwLibFileName,
  DWORD   Reserved
);

// å¸è½½åº“
BOOL WINAPI FreeLibrary(
  _In_ HMODULE hModule
);
// å¸è½½åº“å’Œé€€å‡ºçº¿ç¨‹
VOID WINAPI FreeLibraryAndExitThread(
  _In_ HMODULE hModule,
  _In_ DWORD   dwExitCode
);
```

#### æ˜¾ç¤ºåœ°é“¾æ¥åˆ°å¯¼å‡ºç¬¦å·

GetProcAddress å‡½æ•°å£°æ˜

```cpp
FARPROC GetProcAddress(
  HMODULE hInstDll,
  PCSTR pszSymbolName  // åªèƒ½æ¥å— ANSI å­—ç¬¦ä¸²ï¼Œä¸èƒ½æ˜¯ Unicode
);
```

#### DumpBin.exe æŸ¥çœ‹ DLL ä¿¡æ¯

åœ¨ `VS çš„å¼€å‘äººå‘˜å‘½ä»¤æç¤ºç¬¦` ä½¿ç”¨ `DumpBin.exe` å¯æŸ¥çœ‹ DLL åº“çš„å¯¼å‡ºæ®µï¼ˆå¯¼å‡ºçš„å˜é‡ã€å‡½æ•°ã€ç±»åçš„ç¬¦å·ï¼‰ã€ç›¸å¯¹è™šæ‹Ÿåœ°å€ï¼ˆRVAï¼Œrelative virtual addressï¼‰ã€‚å¦‚ï¼š

```text
DUMPBIN -exports D:\mydll.dll
```

#### LoadLibrary ä¸ FreeLibrary æµç¨‹å›¾

LoadLibrary ä¸ FreeLibrary æµç¨‹å›¾

##### LoadLibrary

![WindowsLoadLibrary](https://gitee.com/huihut/interview/raw/master/images/WindowsLoadLibrary.png)

##### FreeLibrary

![WindowsFreeLibrary](https://gitee.com/huihut/interview/raw/master/images/WindowsFreeLibrary.png)

#### DLL åº“çš„ç¼–å†™ï¼ˆå¯¼å‡ºä¸€ä¸ª DLL æ¨¡å—ï¼‰

DLL åº“çš„ç¼–å†™ï¼ˆå¯¼å‡ºä¸€ä¸ª DLL æ¨¡å—ï¼‰
DLL å¤´æ–‡ä»¶

```cpp
// MyLib.h

#ifdef MYLIBAPI

// MYLIBAPI åº”è¯¥åœ¨å…¨éƒ¨ DLL æºæ–‡ä»¶çš„ include "Mylib.h" ä¹‹å‰è¢«å®šä¹‰
// å…¨éƒ¨å‡½æ•°/å˜é‡æ­£åœ¨è¢«å¯¼å‡º

#else

// è¿™ä¸ªå¤´æ–‡ä»¶è¢«ä¸€ä¸ªexeæºä»£ç æ¨¡å—åŒ…å«ï¼Œæ„å‘³ç€å…¨éƒ¨å‡½æ•°/å˜é‡è¢«å¯¼å…¥
#define MYLIBAPI extern "C" __declspec(dllimport)

#endif

// è¿™é‡Œå®šä¹‰ä»»ä½•çš„æ•°æ®ç»“æ„å’Œç¬¦å·

// å®šä¹‰å¯¼å‡ºçš„å˜é‡ï¼ˆé¿å…å¯¼å‡ºå˜é‡ï¼‰
MYLIBAPI int g_nResult;

// å®šä¹‰å¯¼å‡ºå‡½æ•°åŸå‹
MYLIBAPI int Add(int nLeft, int nRight);
```

DLL æºæ–‡ä»¶

```cpp
// MyLibFile1.cpp

// åŒ…å«æ ‡å‡†Windowså’ŒCè¿è¡Œæ—¶å¤´æ–‡ä»¶
#include <windows.h>

// DLLæºç æ–‡ä»¶å¯¼å‡ºçš„å‡½æ•°å’Œå˜é‡
#define MYLIBAPI extern "C" __declspec(dllexport)

// åŒ…å«å¯¼å‡ºçš„æ•°æ®ç»“æ„ã€ç¬¦å·ã€å‡½æ•°ã€å˜é‡
#include "MyLib.h"

// å°†æ­¤DLLæºä»£ç æ–‡ä»¶çš„ä»£ç æ”¾åœ¨æ­¤å¤„
int g_nResult;

int Add(int nLeft, int nRight)
{
    g_nResult = nLeft + nRight;
    return g_nResult;
}
```

#### DLL åº“çš„ä½¿ç”¨ï¼ˆè¿è¡Œæ—¶åŠ¨æ€é“¾æ¥ DLLï¼‰

DLL åº“çš„ä½¿ç”¨ï¼ˆè¿è¡Œæ—¶åŠ¨æ€é“¾æ¥ DLLï¼‰

```cpp
// A simple program that uses LoadLibrary and 
// GetProcAddress to access myPuts from Myputs.dll. 
 
#include <windows.h> 
#include <stdio.h> 
 
typedef int (__cdecl *MYPROC)(LPWSTR); 
 
int main( void ) 
{ 
    HINSTANCE hinstLib; 
    MYPROC ProcAdd; 
    BOOL fFreeResult, fRunTimeLinkSuccess = FALSE; 
 
    // Get a handle to the DLL module.
 
    hinstLib = LoadLibrary(TEXT("MyPuts.dll")); 
 
    // If the handle is valid, try to get the function address.
 
    if (hinstLib != NULL) 
    { 
        ProcAdd = (MYPROC) GetProcAddress(hinstLib, "myPuts"); 
 
        // If the function address is valid, call the function.
 
        if (NULL != ProcAdd) 
        {
            fRunTimeLinkSuccess = TRUE;
            (ProcAdd) (L"Message sent to the DLL function\n"); 
        }
        // Free the DLL module.
 
        fFreeResult = FreeLibrary(hinstLib); 
    } 

    // If unable to call the DLL function, use an alternative.
    if (! fRunTimeLinkSuccess) 
        printf("Message printed from executable\n"); 

    return 0;
}
```

### è¿è¡Œåº“ï¼ˆRuntime Libraryï¼‰

#### å…¸å‹ç¨‹åºè¿è¡Œæ­¥éª¤

1. æ“ä½œç³»ç»Ÿåˆ›å»ºè¿›ç¨‹ï¼ŒæŠŠæ§åˆ¶æƒäº¤ç»™ç¨‹åºçš„å…¥å£ï¼ˆå¾€å¾€æ˜¯è¿è¡Œåº“ä¸­çš„æŸä¸ªå…¥å£å‡½æ•°ï¼‰
2. å…¥å£å‡½æ•°å¯¹è¿è¡Œåº“å’Œç¨‹åºè¿è¡Œç¯å¢ƒè¿›è¡Œåˆå§‹åŒ–ï¼ˆåŒ…æ‹¬å †ã€I/Oã€çº¿ç¨‹ã€å…¨å±€å˜é‡æ„é€ ç­‰ç­‰ï¼‰ã€‚
3. å…¥å£å‡½æ•°åˆå§‹åŒ–åï¼Œè°ƒç”¨ main å‡½æ•°ï¼Œæ­£å¼å¼€å§‹æ‰§è¡Œç¨‹åºä¸»ä½“éƒ¨åˆ†ã€‚
4. main å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œè¿”å›åˆ°å…¥å£å‡½æ•°è¿›è¡Œæ¸…ç†å·¥ä½œï¼ˆåŒ…æ‹¬å…¨å±€å˜é‡ææ„ã€å †é”€æ¯ã€å…³é—­I/Oç­‰ï¼‰ï¼Œç„¶åè¿›è¡Œç³»ç»Ÿè°ƒç”¨ç»“æŸè¿›ç¨‹ã€‚

> ä¸€ä¸ªç¨‹åºçš„ I/O æŒ‡ä»£ç¨‹åºä¸å¤–ç•Œçš„äº¤äº’ï¼ŒåŒ…æ‹¬æ–‡ä»¶ã€ç®¡ç¨‹ã€ç½‘ç»œã€å‘½ä»¤è¡Œã€ä¿¡å·ç­‰ã€‚æ›´å¹¿ä¹‰åœ°è®²ï¼ŒI/O æŒ‡ä»£æ“ä½œç³»ç»Ÿç†è§£ä¸º â€œæ–‡ä»¶â€ çš„äº‹ç‰©ã€‚

#### glibc å…¥å£

`_start -> __libc_start_main -> exit -> _exit`

å…¶ä¸­ `main(argc, argv, __environ)` å‡½æ•°åœ¨ `__libc_start_main` é‡Œæ‰§è¡Œã€‚

#### MSVC CRT å…¥å£

`int mainCRTStartup(void)`

æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š

1. åˆå§‹åŒ–å’Œ OS ç‰ˆæœ¬æœ‰å…³çš„å…¨å±€å˜é‡ã€‚
2. åˆå§‹åŒ–å †ã€‚
3. åˆå§‹åŒ– I/Oã€‚
4. è·å–å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚
5. åˆå§‹åŒ– C åº“çš„ä¸€äº›æ•°æ®ã€‚
6. è°ƒç”¨ main å¹¶è®°å½•è¿”å›å€¼ã€‚
7. æ£€æŸ¥é”™è¯¯å¹¶å°† main çš„è¿”å›å€¼è¿”å›ã€‚

#### C è¯­è¨€è¿è¡Œåº“ï¼ˆCRTï¼‰

å¤§è‡´åŒ…å«å¦‚ä¸‹åŠŸèƒ½ï¼š

* å¯åŠ¨ä¸é€€å‡ºï¼šåŒ…æ‹¬å…¥å£å‡½æ•°åŠå…¥å£å‡½æ•°æ‰€ä¾èµ–çš„å…¶ä»–å‡½æ•°ç­‰ã€‚
* æ ‡å‡†å‡½æ•°ï¼šæœ‰ C è¯­è¨€æ ‡å‡†è§„å®šçš„Cè¯­è¨€æ ‡å‡†åº“æ‰€æ‹¥æœ‰çš„å‡½æ•°å®ç°ã€‚
* I/Oï¼šI/O åŠŸèƒ½çš„å°è£…å’Œå®ç°ã€‚
* å †ï¼šå †çš„å°è£…å’Œå®ç°ã€‚
* è¯­è¨€å®ç°ï¼šè¯­è¨€ä¸­ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½çš„å®ç°ã€‚
* è°ƒè¯•ï¼šå®ç°è°ƒè¯•åŠŸèƒ½çš„ä»£ç ã€‚

#### Cè¯­è¨€æ ‡å‡†åº“ï¼ˆANSI Cï¼‰

åŒ…å«ï¼š

* æ ‡å‡†è¾“å…¥è¾“å‡ºï¼ˆstdio.hï¼‰
* æ–‡ä»¶æ“ä½œï¼ˆstdio.hï¼‰
* å­—ç¬¦æ“ä½œï¼ˆctype.hï¼‰
* å­—ç¬¦ä¸²æ“ä½œï¼ˆstring.hï¼‰
* æ•°å­¦å‡½æ•°ï¼ˆmath.hï¼‰
* èµ„æºç®¡ç†ï¼ˆstdlib.hï¼‰
* æ ¼å¼è½¬æ¢ï¼ˆstdlib.hï¼‰
* æ—¶é—´/æ—¥æœŸï¼ˆtime.hï¼‰
* æ–­è¨€ï¼ˆassert.hï¼‰
* å„ç§ç±»å‹ä¸Šçš„å¸¸æ•°ï¼ˆlimits.h & float.hï¼‰
* å˜é•¿å‚æ•°ï¼ˆstdarg.hï¼‰
* éå±€éƒ¨è·³è½¬ï¼ˆsetjmp.hï¼‰

<a id="books"></a>

## ğŸ“š ä¹¦ç±

### è¯­è¨€

* [C++ Standard Library](/books/C%2B%2B%20Standard%20Library.md)
* [C++å¹¶å‘ç¼–ç¨‹å®æˆ˜](/books/C%2B%2B%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98.md)
* [æ·±å…¥ç†è§£C++11](/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3C%2B%2B11.md)
* [Effective C++](/books/Effective%20C%2B%2B.md)
* [STLæºç å‰–æ](/STL/STL-master/0%20SIG%20STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.md)

### Linux

* Linuxç³»ç»Ÿç¼–ç¨‹
* APUE
* [Linuxå¤šçº¿ç¨‹æœåŠ¡ç«¯ç¼–ç¨‹](/book_notes/Linux%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%BC%96%E7%A8%8B.md)

### ç³»ç»Ÿ

* ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹
* ã€ŠWindows æ ¸å¿ƒç¼–ç¨‹ã€‹
* ã€ŠUnix ç¯å¢ƒé«˜çº§ç¼–ç¨‹ã€‹

### ç½‘ç»œ

* ã€ŠUnix ç½‘ç»œç¼–ç¨‹ã€‹
* ã€ŠTCP/IP è¯¦è§£ã€‹

### å…¶ä»–

* ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹

<a id="cc-project"></a>

## ğŸ”± C/C++ é¡¹ç›®

### muduoç½‘ç»œåº“

#### [çº¿ç¨‹å®‰å…¨çš„æ—¥å¿—ç³»ç»Ÿ](/project/log.cpp)

### XV6 æ“ä½œç³»ç»Ÿ

<a id="interview-questions-experience"></a>

## ğŸ“ é¢è¯•é¢˜ç›®ç»éªŒ

* [ç‰›å®¢ç½‘ . 2020ç§‹æ‹›é¢ç»å¤§æ±‡æ€»ï¼ï¼ˆå²—ä½åˆ’åˆ†ï¼‰](https://www.nowcoder.com/discuss/205497)
* [ç‰›å®¢ç½‘ . ã€å¤‡æˆ˜ç§‹æ‹›ã€‘2020å±Šç§‹æ‹›å¤‡æˆ˜æ”»ç•¥](https://www.nowcoder.com/discuss/197116)
* [ç‰›å®¢ç½‘ . 2019æ ¡æ‹›é¢ç»å¤§æ±‡æ€»ï¼ã€æ¯æ—¥æ›´æ–°ä¸­ã€‘](https://www.nowcoder.com/discuss/90907)
* [ç‰›å®¢ç½‘ . 2019æ ¡æ‹›æŠ€æœ¯ç±»å²—ä½é¢ç»æ±‡æ€»ã€æŠ€æœ¯ç±»ã€‘](https://www.nowcoder.com/discuss/146655)
* [ç‰›å®¢ç½‘ . 2018æ ¡æ‹›ç¬”è¯•çœŸé¢˜æ±‡æ€»](https://www.nowcoder.com/discuss/68802)
* [ç‰›å®¢ç½‘ . 2017ç§‹å­£æ ¡å›­æ‹›è˜ç¬”ç»é¢ç»ä¸“é¢˜æ±‡æ€»](https://www.nowcoder.com/discuss/12805)
* [ç‰›å®¢ç½‘ . å²ä¸Šæœ€å…¨2017æ˜¥æ‹›é¢ç»å¤§åˆé›†ï¼ï¼](https://www.nowcoder.com/discuss/25268)
* [ç‰›å®¢ç½‘ . é¢è¯•é¢˜å¹²è´§åœ¨æ­¤](https://www.nowcoder.com/discuss/57978)
* [çŸ¥ä¹ . äº’è”ç½‘æ±‚èŒè·¯ä¸Šï¼Œä½ è§è¿‡å“ªäº›å†™å¾—å¾ˆå¥½ã€å¾ˆç”¨å¿ƒçš„é¢ç»ï¼Ÿæœ€å¥½èƒ½åˆ†äº«è‡ªå·±çš„é¢ç»ã€å¿ƒè·¯å†ç¨‹ã€‚](https://www.zhihu.com/question/29693016)
* [çŸ¥ä¹ . äº’è”ç½‘å…¬å¸æœ€å¸¸è§çš„é¢è¯•ç®—æ³•é¢˜æœ‰å“ªäº›ï¼Ÿ](https://www.zhihu.com/question/24964987)
* [CSDN . å…¨é¢æ•´ç†çš„C++é¢è¯•é¢˜](http://blog.csdn.net/ljzcome/article/details/574158)
* [CSDN . ç™¾åº¦ç ”å‘ç±»é¢è¯•é¢˜ï¼ˆC++æ–¹å‘ï¼‰](http://blog.csdn.net/Xiongchao99/article/details/74524807?locationNum=6&fps=1)
* [CSDN . c++å¸¸è§é¢è¯•é¢˜30é“](http://blog.csdn.net/fakine/article/details/51321544)
* [CSDN . è…¾è®¯2016å®ä¹ ç”Ÿé¢è¯•ç»éªŒï¼ˆå·²ç»æ‹¿åˆ°offer)](http://blog.csdn.net/onever_say_love/article/details/51223886)
* [cnblogs . C++é¢è¯•é›†é”¦( é¢è¯•è¢«é—®åˆ°çš„é—®é¢˜ )](https://www.cnblogs.com/Y1Focus/p/6707121.html)
* [cnblogs . C/C++ ç¬”è¯•ã€é¢è¯•é¢˜ç›®å¤§æ±‡æ€»](https://www.cnblogs.com/fangyukuan/archive/2010/09/18/1829871.html)
* [cnblogs . å¸¸è§C++é¢è¯•é¢˜åŠåŸºæœ¬çŸ¥è¯†ç‚¹æ€»ç»“ï¼ˆä¸€ï¼‰](https://www.cnblogs.com/LUO77/p/5771237.html)
* [segmentfault . C++å¸¸è§é¢è¯•é—®é¢˜æ€»ç»“](https://segmentfault.com/a/1190000003745529)

<a id="recruitment-time-post"></a>

## ğŸ“† æ‹›è˜æ—¶é—´å²—ä½

* [ç‰›å®¢ç½‘ . åä¼æ ¡æ‹›æ—¥ç¨‹](https://www.nowcoder.com/school/schedule)

<a id="recommend"></a>

## ğŸ‘ å†…æ¨

* [Github . CyC2018/Job-Recommend](https://github.com/CyC2018/Job-Recommend)ï¼šğŸ” äº’è”ç½‘å†…æ¨ä¿¡æ¯ï¼ˆç¤¾æ‹›ã€æ ¡æ‹›ã€å®ä¹ ï¼‰
* [Github . amusi/AI-Job-Recommend](https://github.com/amusi/AI-Job-Recommend)ï¼šå›½å†…å…¬å¸äººå·¥æ™ºèƒ½æ–¹å‘ï¼ˆå«æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰å²—ä½çš„æ‹›è˜ä¿¡æ¯ï¼ˆå«å…¨èŒã€å®ä¹ å’Œæ ¡æ‹›ï¼‰
